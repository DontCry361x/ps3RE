/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall eosh(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
void __noreturn sub_8000002C();
__int64 __fastcall sub_8000007C(__int64 a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall power_down_80000140(char a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 main_80000270();
__int64 __fastcall sub_800002FC(__int64 result);
__int64 __fastcall sub_8000031C(__int64 a1, unsigned int a2);
__int64 __fastcall sub_80000368(__int64 a1, int *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall sub_8000042C(_QWORD *a1, _DWORD *a2, void *a3, void *a4, void *a5);
__int64 __fastcall sub_800004A0(_QWORD *a1, __int64 a2, void *a3, void *a4, void *a5);
__int64 __fastcall sub_8000056C(_QWORD *a1, __int64 a2, void *a3, void *a4, void *a5);
__int64 __fastcall sub_80000634(_QWORD *a1, __int64 a2, char *a3, void *a4, void *a5);
__int64 __fastcall sub_80000768(_QWORD, _QWORD, _QWORD); // weak
__int64 __fastcall sub_8000076C(_QWORD *a1, _BYTE *a2, __int64 a3, void *a4, void *a5);
__int64 __fastcall sub_80000834(_QWORD *a1, _QWORD *a2, __int64 a3, void *a4, void *a5);
__int64 __fastcall sub_800008DC(_QWORD *a1, __int64 a2, __int64 a3, void *a4, void *a5);
__int64 __fastcall sub_80000A0C(void **a1, void **a2, _QWORD *a3, _QWORD *a4, _DWORD *a5, void *a6);
__int64 __fastcall sub_80000AD0(char *a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sub_80000D88(int *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sub_80000E28(int *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sub_80000E84(int *a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sub_80001134(int *a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sub_8000127C(int a1, char **a2);
__int64 __fastcall sub_800012BC(void **a1, void **a2, _QWORD *a3, _QWORD *a4, _DWORD *a5, void *a6);
__int64 __fastcall sub_800013E8(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6);
int get_tb();
__int64 __fastcall get_be_clock(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, void *a6);
void __fastcall sc_0x100C0_create_repository_node(void *a1, void **a2, void **a3);
void __fastcall sc_0x100C1_get_repository_node_value(void *a1, void **a2, _QWORD *a3, __int64 a4, __int64 a5, void *a6, void *a7);
void __fastcall sc_0x100C3_remove_repository_node(void *a1, void **a2, __int64 a3, __int64 a4, __int64 a5, void *a6, void *a7);
void __fastcall sc_10033_unk(void *a1, void *a2, void **a3, void *a4, void *a5, void *a6, void *a7);
void __fastcall sc_10036_power_down(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sub_80001650(int a1, int a2);
__int64 __fastcall sub_8000173C(int a1, _DWORD *a2);
__int64 __fastcall sub_8000181C(int a1, unsigned __int8 a2, unsigned __int8 a3, int a4, _BYTE *a5);
__int64 __fastcall sub_80001958(int a1, unsigned __int8 a2, unsigned __int8 a3, int a4, char *a5);
__int64 __fastcall sub_80001A8C(int a1, char a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sub_80001C00(int a1, _BYTE *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sub_80001D38(__int64 a1);
__int64 __fastcall sub_80001D6C(__int64 a1);
__int64 __fastcall sub_80001D7C(__int64 a1, __int64 a2);
void *__fastcall sub_80001E38(__int64 a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sub_80001E80(_QWORD *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
_BYTE *__fastcall sub_80001EE0(_BYTE *result, char *_R4, unsigned __int64 a3);
__int64 __fastcall sub_8000249C(unsigned __int8 *a1, _BYTE *a2, __int64 a3);
unsigned __int64 *__fastcall sub_80002510(__int64 a1, unsigned __int64 a2);
_QWORD *__fastcall sub_80002540(_QWORD *result, __int64 a2, __int64 a3);
void sub_80002598();
__int64 __fastcall sub_800025DC(_QWORD *a1, unsigned __int64 a2);
unsigned __int64 __fastcall sub_80002760(unsigned __int64 result);
__int64 __fastcall malloc(unsigned __int64 a1);
_BYTE *__fastcall memset(_BYTE *a1, __int16 a2, unsigned __int64 a3);
void do_ctors();
void do_dtors();
int *memset_bss();
void sub_800047C0();
__int64 __fastcall getpid(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall fork(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall execv(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
void __fastcall __noreturn exit(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sub_800048E4(int a1, void *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall open(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall close(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall read(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall socket(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sc_0B_lseek(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall map_pages(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall unmap_pages(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall alarm(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 dbg_msg(_BYTE *a1, ...);
__int64 __fastcall sub_80004BD0(_BYTE *a1, __int64 a2);
__int64 __fastcall sub_80004BE4(__int64 a1, char *a2, __int64 a3, __int64 a4, void *a5);
unsigned __int64 __fastcall sub_80004C20(unsigned __int64 a1);
__int64 __fastcall sub_80004C54(__int64 result);
__int64 __fastcall sub_80004CD4(__int64 result);
__int64 __fastcall sub_80004D54(__int64 a1);
__int64 __fastcall sub_80004DA4(__int64 a1);
__int64 __fastcall sub_80004DF4(__int64 (__fastcall **a1)(__int64, _BYTE *, __int64), __int64 a2, _BYTE *a3, __int64 a4);
__int64 sub_80005988();
void __fastcall __noreturn sub_8000599C(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_800059BC(char *a1, unsigned __int64 a2, __int64 a3, _QWORD *a4, void *a5);
__int64 __fastcall sub_80005B94(__int64 result, unsigned __int8 a2, unsigned __int64 a3);
char *__fastcall sub_80005CE0(__int64 a1);
void __fastcall sub_80005D84(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
__int64 __fastcall sub_80005D94(__int64 a1, __int64 a2, __int64 a3, void *a4, void *a5);
__int64 __fastcall brk(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7);
void __fastcall sub_80005F30(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_80006064(unsigned __int16 *a1, __int64 a2, __int64 a3, void *a4, void *a5, void *a6);

//-------------------------------------------------------------------------
// Data declarations

char *off_C0000000 = "boot"; // weak
OPD64_s *off_C0000008 = &stru_C00003B0; // weak
int dword_C0000010 = 300; // weak
__int64 qword_C0000018 = 288511851128422400LL; // weak
__int64 qword_C00000C0 = 288794425616826368LL; // weak
__int64 qword_C0000168 = 288795525128519680LL; // weak
void *off_C0000210 = &unk_C00011C8; // weak
OPD64_s stru_C00008C0 = { &sub_80004BE4, (void *)0xC0008A58LL, 0LL }; // weak
int dword_C0000DD8; // weak
int dword_C0000DDC; // weak
char byte_C0000DE0; // weak
char byte_C0000DE1; // weak
int dword_C0000DE4; // weak
__int64 qword_C0000DE8; // weak
__int64 qword_C0000DF0; // weak
__int64 qword_C0000DF8; // weak
__int64 qword_C0000E00; // weak
__int64 qword_C0000E08; // weak
int dword_C0000E10; // weak
__int64 qword_C0000E18[]; // weak
__int64 qword_C0000E20; // weak
__int64 qword_C0000E28; // weak
__int64 qword_C0000E30; // weak
__int64 qword_C0000E38; // weak
__int64 qword_C0000E40; // weak
__int64 qword_C0000E48; // weak
__int64 qword_C0000E50; // weak
_UNKNOWN unk_C0000E58; // weak
__int64 qword_C0001068; // weak
_UNKNOWN unk_C0001160; // weak
__int64 qword_C0001168; // weak
__int64 qword_C0001170; // weak
int dword_C0001178; // weak
__int64 qword_C0001180; // weak
__int64 qword_C0001188; // weak
__int64 qword_C0001190; // weak
int dword_C0001198; // weak
__int64 qword_C00011A0; // weak
__int64 qword_C00011A8; // weak
__int64 qword_C00011B0; // weak
__int64 qword_C00011B8; // weak
__int64 qword_C00011C0; // weak
_UNKNOWN unk_C00011C8; // weak


//----- (0000000080000000) ----------------------------------------------------
__int64 __fastcall eosh(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 result; // r3

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  return (int)result;
}
// 8000000C: variable 'v7' is possibly undefined
// 80000010: variable 'result' is possibly undefined

//----- (000000008000002C) ----------------------------------------------------
void __noreturn sub_8000002C()
{
  __int64 v0; // r0
  __int64 v1; // [sp+0h] [-30h]

  *(&v1 - 14) = v0;
  sub_800047C0();
}
// 80000068: variable 'v0' is possibly undefined

//----- (000000008000007C) ----------------------------------------------------
__int64 __fastcall sub_8000007C(__int64 a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // r3
  void *v8; // r31
  void *v9; // r9
  void *v10; // r8
  void *v11; // r7
  void *v12; // r6
  void *v13; // r5
  void *v14; // r4
  char v16[16]; // [sp+70h] [-20h] BYREF

  if ( !dword_C0000DDC )
  {
    v16[0] = dword_C0000DDC;
    v7 = open("/dev/sc3", (void *)2, a3, a4, a5, a6, a7);
    v8 = (void *)v7;
    if ( v7 >= 0 )
    {
      if ( (unsigned __int8)sub_8000181C(v7, 2u, 0xCFu, 1, v16) )
      {
        close(v8, v14, v13, v12, v11, v10, v9);
      }
      else
      {
        close(v8, v14, v13, v12, v11, v10, v9);
        if ( (unsigned __int8)v16[0] != 255 )
          dword_C0000DD8 = v16[0] & 3;
        dword_C0000DDC = 1;
      }
    }
  }
  return dword_C0000DD8;
}
// 800000E8: variable 'v14' is possibly undefined
// 800000E8: variable 'v13' is possibly undefined
// 800000E8: variable 'v12' is possibly undefined
// 800000E8: variable 'v11' is possibly undefined
// 800000E8: variable 'v10' is possibly undefined
// 800000E8: variable 'v9' is possibly undefined
// C0000DD8: using guessed type int dword_C0000DD8;
// C0000DDC: using guessed type int dword_C0000DDC;

//----- (0000000080000140) ----------------------------------------------------
// r3 = 
__int64 __fastcall power_down_80000140(char a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  void *v8; // r9
  void *v9; // r8
  void *v10; // r7
  void *v11; // r6
  void *v12; // r5
  __int64 v13; // r4
  __int64 v14; // r3
  int v15; // r28
  __int64 result; // r3
  void *v17; // r9
  void *v18; // r8
  void *v19; // r7
  void *v20; // r6
  void *v21; // r5
  __int64 v22; // r4
  __int64 v23; // r3
  int v24; // r29
  void *v25; // r9
  void *v26; // r8
  void *v27; // r7
  void *v28; // r6
  void *v29; // r5
  __int64 v30; // r4
  __int64 v31; // r3
  void *v32; // r9
  void *v33; // r8
  void *v34; // r7
  void *v35; // r9
  void *v36; // r8
  void *v37; // r7
  void *v38; // r6
  void *v39; // r5
  void *v40; // r4
  int v41; // [sp+70h] [-30h] BYREF
  int v42[3]; // [sp+74h] [-2Ch] BYREF

  v14 = open("/dev/sc3", (void *)2, a3, a4, a5, a6, a7);
  v15 = v14;
  if ( (int)v14 >= 0 )
  {
    v41 = 0;
    v23 = sub_8000173C(v14, &v41);
    v24 = (unsigned __int8)v23;
    if ( (_BYTE)v23 )
    {
      v31 = sub_8000007C(v23, v22, v21, v20, v19, v18, v17);
      if ( (int)v31 > 0 )
        v31 = dbg_msg("pme_user::sc_rtc::get_rtc failed: ");
      if ( (int)sub_8000007C(v31, v30, v29, v28, v27, v26, v25) > 0 )
        dbg_msg("ret = 0x%0x2\n", v24);
      v41 = -1;
    }
    memset(v42, 255, 8uLL);
    BYTE2(v42[0]) = a1;
    v42[1] = v41;
    sub_80001958(v15, 1u, 4u, 8, (char *)v42);
    sub_80001650(v15, 820);
    while ( 1 )
    {
      sc_10036_power_down(0LL, 0LL, (void *)3, (void *)0x334, v34, v33, v32);
      alarm((void *)0x4C4B40, v40, v39, v38, v37, v36, v35);
    }
  }
  result = sub_8000007C(v14, v13, v12, v11, v10, v9, v8);
  if ( (int)result > 0 )
    result = dbg_msg("opening %s failed", "/dev/sc3");
  return result;
}
// 80000178: variable 'v13' is possibly undefined
// 80000178: variable 'v12' is possibly undefined
// 80000178: variable 'v11' is possibly undefined
// 80000178: variable 'v10' is possibly undefined
// 80000178: variable 'v9' is possibly undefined
// 80000178: variable 'v8' is possibly undefined
// 800001B4: variable 'v22' is possibly undefined
// 800001B4: variable 'v21' is possibly undefined
// 800001B4: variable 'v20' is possibly undefined
// 800001B4: variable 'v19' is possibly undefined
// 800001B4: variable 'v18' is possibly undefined
// 800001B4: variable 'v17' is possibly undefined
// 800001C8: variable 'v30' is possibly undefined
// 800001C8: variable 'v29' is possibly undefined
// 800001C8: variable 'v28' is possibly undefined
// 800001C8: variable 'v27' is possibly undefined
// 800001C8: variable 'v26' is possibly undefined
// 800001C8: variable 'v25' is possibly undefined
// 80000240: variable 'v34' is possibly undefined
// 80000240: variable 'v33' is possibly undefined
// 80000240: variable 'v32' is possibly undefined
// 8000024C: variable 'v40' is possibly undefined
// 8000024C: variable 'v39' is possibly undefined
// 8000024C: variable 'v38' is possibly undefined
// 8000024C: variable 'v37' is possibly undefined
// 8000024C: variable 'v36' is possibly undefined
// 8000024C: variable 'v35' is possibly undefined

//----- (0000000080000270) ----------------------------------------------------
__int64 main_80000270()
{
  __int64 v0; // r3
  int v1; // r30
  void *v2; // r9
  void *v3; // r8
  void *v4; // r7
  void *v5; // r6
  void *v6; // r5
  __int64 v7; // r4
  void *v8; // r9
  void *v9; // r8
  void *v10; // r7
  void *v11; // r6
  void *v12; // r5
  __int64 v13; // r4
  void *v14; // r9
  void *v15; // r8
  void *v16; // r7
  void *v17; // r6
  void *v18; // r5
  void *v19; // r4
  __int64 v20; // r3
  void *v21; // r9
  void *v22; // r8
  void *v23; // r7
  void *v24; // r6
  void *v25; // r5
  __int64 v26; // r4
  int v28[12]; // [sp+70h] [-40h] BYREF

  v0 = sub_800002FC((__int64)v28);
  v1 = 0;
  if ( (int)sub_8000007C(v0, v7, v6, v5, v4, v3, v2) > 0 )
    dbg_msg("pme_init running...\n");
  v20 = sub_80001134(v28, v13, v12, v11, v10, v9, v8);
  if ( (_DWORD)v20 )
  {
    v1 = -1;
    if ( (int)sub_8000007C(v20, (__int64)v19, v18, v17, v16, v15, v14) > 0 )
      dbg_msg("pme_init: configuration error\n");
    power_down_80000140(0, v26, v25, v24, v23, v22, v21);
  }
  sub_80000E28(v28, v19, v18, v17, v16, v15, v14);
  return v1;
}
// 80000294: variable 'v7' is possibly undefined
// 80000294: variable 'v6' is possibly undefined
// 80000294: variable 'v5' is possibly undefined
// 80000294: variable 'v4' is possibly undefined
// 80000294: variable 'v3' is possibly undefined
// 80000294: variable 'v2' is possibly undefined
// 800002AC: variable 'v13' is possibly undefined
// 800002AC: variable 'v12' is possibly undefined
// 800002AC: variable 'v11' is possibly undefined
// 800002AC: variable 'v10' is possibly undefined
// 800002AC: variable 'v9' is possibly undefined
// 800002AC: variable 'v8' is possibly undefined
// 800002B8: variable 'v19' is possibly undefined
// 800002B8: variable 'v18' is possibly undefined
// 800002B8: variable 'v17' is possibly undefined
// 800002B8: variable 'v16' is possibly undefined
// 800002B8: variable 'v15' is possibly undefined
// 800002B8: variable 'v14' is possibly undefined
// 800002D4: variable 'v26' is possibly undefined
// 800002D4: variable 'v25' is possibly undefined
// 800002D4: variable 'v24' is possibly undefined
// 800002D4: variable 'v23' is possibly undefined
// 800002D4: variable 'v22' is possibly undefined
// 800002D4: variable 'v21' is possibly undefined

//----- (00000000800002FC) ----------------------------------------------------
// r3 = *ctx,
// 
// struct ctx {
//   u32 unk_00;     // 0x00: 
//   u32 pad_0;      // 0x04: 
//   u64 unk_08;     // 0x08: 
//   u64 unk_10;     // 0x10: 
//   u64 unk_18;     // 0x18: 
//   u8 unk_20;      // 0x20: 
//   u8 pad_1[7];    // 0x21:
// }
__int64 __fastcall sub_800002FC(__int64 result)
{
  *(_QWORD *)(result + 24) = 0LL;
  *(_BYTE *)(result + 32) = 0;
  *(_DWORD *)result = 0;
  *(_QWORD *)(result + 8) = 0LL;
  *(_QWORD *)(result + 16) = 0LL;
  return result;
}

//----- (000000008000031C) ----------------------------------------------------
__int64 __fastcall sub_8000031C(__int64 a1, unsigned int a2)
{
  __int64 result; // r3
  unsigned int v3; // r9

  LODWORD(result) = 1;
  v3 = abs32(a2 ^ 0xA) - 1;
  if ( a2 > 0x20 || ((1LL << a2) & 0x100003A00LL) == 0 )
    LODWORD(result) = v3 >> 31;
  return (int)result;
}

//----- (0000000080000368) ----------------------------------------------------
__int64 __fastcall sub_80000368(__int64 a1, int *a2, void *a3, void *a4, void *a5, void *a6)
{
  __int64 v6; // r9
  void *v8; // r9
  void *v9; // r8
  void *v10; // r7
  void *v11; // r6
  void *v12; // r5
  __int64 v13; // r4
  __int64 v14; // r3
  bool v15; // cr61
  char v16; // r3
  __int64 v17; // r0
  __int64 v18; // r11
  unsigned __int64 v19; // r9
  void *v20; // r9
  void *v21; // r8
  void *v22; // r7
  void *v23; // r6
  void *v24; // r5
  __int64 v25; // r4
  __int64 v26; // r3
  bool v27; // cr61

  v6 = *(_QWORD *)(a1 + 24);
  if ( v6 )
  {
    v17 = v6 - 1;
    v18 = *(_QWORD *)(a1 + 8);
    v19 = (unsigned int)*a2;
    *(_QWORD *)(a1 + 24) = v17;
    v16 = 0;
    if ( (_DWORD)v19 != *(unsigned __int8 *)(v18 + v17) )
    {
      v26 = sub_8000007C(0LL, (__int64)a2, a3, a4, a5, a6, (void *)v19);
      if ( (int)v26 > 1 )
        v26 = dbg_msg("parser::unget_char: ");
      v27 = (int)sub_8000007C(v26, v25, v24, v23, v22, v21, v20) > 1;
      v16 = 9;
      if ( v27 )
      {
        dbg_msg("invalid parameter: \"%c\"\n", *a2);
        v16 = 9;
      }
    }
  }
  else
  {
    v14 = sub_8000007C(a1, (__int64)a2, a3, a4, a5, a6, 0LL);
    if ( (int)v14 > 1 )
      v14 = dbg_msg("parser::unget_char: ");
    v15 = (int)sub_8000007C(v14, v13, v12, v11, v10, v9, v8) > 1;
    v16 = 15;
    if ( v15 )
    {
      dbg_msg("already head of the buffer\n");
      v16 = 15;
    }
  }
  return v16 & 0xF;
}
// 8000039C: variable 'v13' is possibly undefined
// 8000039C: variable 'v12' is possibly undefined
// 8000039C: variable 'v11' is possibly undefined
// 8000039C: variable 'v10' is possibly undefined
// 8000039C: variable 'v9' is possibly undefined
// 8000039C: variable 'v8' is possibly undefined
// 800003F0: variable 'v25' is possibly undefined
// 800003F0: variable 'v24' is possibly undefined
// 800003F0: variable 'v23' is possibly undefined
// 800003F0: variable 'v22' is possibly undefined
// 800003F0: variable 'v21' is possibly undefined
// 800003F0: variable 'v20' is possibly undefined

//----- (000000008000042C) ----------------------------------------------------
__int64 __fastcall sub_8000042C(_QWORD *a1, _DWORD *a2, void *a3, void *a4, void *a5)
{
  unsigned __int8 *v5; // r9
  char v7; // r8
  int v8; // r0

  v5 = (unsigned __int8 *)a1[3];
  v7 = 0;
  if ( (unsigned __int64)v5 <= a1[2] )
  {
    v8 = v5[a1[1]];
    a1[3] = v5 + 1;
  }
  else
  {
    if ( (int)sub_8000007C((__int64)a1, (__int64)a2, a3, a4, a5, 0LL, v5) > 1 )
      dbg_msg("parser::get_char: EOF\n");
    v7 = 6;
    v8 = 0;
  }
  *a2 = v8;
  return v7 & 6;
}

//----- (00000000800004A0) ----------------------------------------------------
__int64 __fastcall sub_800004A0(_QWORD *a1, __int64 a2, void *a3, void *a4, void *a5)
{
  __int64 v5; // r30
  void *v6; // r9
  void *v7; // r8
  __int64 v8; // r4
  __int64 v9; // r3
  unsigned int v10; // r31
  void *v11; // r9
  void *v12; // r8
  void *v13; // r7
  void *v14; // r6
  void *v15; // r5
  __int64 v16; // r4
  __int64 v17; // r3
  int v19[4]; // [sp+70h] [-20h] BYREF

  v5 = (__int64)a1;
  v19[0] = 0;
  do
  {
    v9 = sub_8000042C(a1, v19, a3, a4, a5);
    v10 = v9;
    if ( (_DWORD)v9 )
    {
      if ( (int)sub_8000007C(v9, v8, a3, a4, a5, v7, v6) > 1 )
        dbg_msg("get_char returns %d\n", (int)v10);
      return v10;
    }
    a1 = (_QWORD *)v5;
  }
  while ( v19[0] <= 0x20u && ((1LL << SLOBYTE(v19[0])) & 0x100003A00LL) != 0 );
  v17 = sub_80000368(v5, v19, a3, a4, a5, v7);
  v10 = v17;
  if ( (_DWORD)v17 && (int)sub_8000007C(v17, v16, v15, v14, v13, v12, v11) > 1 )
    dbg_msg("unget_char failed: ret = %d\n", (int)v10);
  return v10;
}
// 800004C4: variable 'a3' is possibly undefined
// 800004C4: variable 'a4' is possibly undefined
// 800004C4: variable 'a5' is possibly undefined
// 800004D4: variable 'v8' is possibly undefined
// 800004D4: variable 'v7' is possibly undefined
// 800004D4: variable 'v6' is possibly undefined
// 80000538: variable 'v16' is possibly undefined
// 80000538: variable 'v15' is possibly undefined
// 80000538: variable 'v14' is possibly undefined
// 80000538: variable 'v13' is possibly undefined
// 80000538: variable 'v12' is possibly undefined
// 80000538: variable 'v11' is possibly undefined

//----- (000000008000056C) ----------------------------------------------------
__int64 __fastcall sub_8000056C(_QWORD *a1, __int64 a2, void *a3, void *a4, void *a5)
{
  void *v6; // r9
  void *v7; // r8
  void *v8; // r7
  void *v9; // r6
  void *v10; // r5
  __int64 v11; // r4
  __int64 v12; // r3
  unsigned int v13; // r30
  void *v14; // r9
  void *v15; // r8
  __int64 v16; // r4
  __int64 v17; // r3
  int v18; // r29
  int v20[4]; // [sp+70h] [-30h] BYREF

  v20[0] = 0;
  v12 = sub_8000042C(a1, v20, a3, a4, a5);
  v13 = v12;
  if ( (_DWORD)v12 )
  {
    if ( (int)sub_8000007C(v12, v11, v10, v9, v8, v7, v6) > 1 )
      dbg_msg("get_char returns %d\n", (int)v13);
  }
  else
  {
    while ( v20[0] != 10 )
    {
      v17 = sub_8000042C(a1, v20, v10, v9, v8);
      v18 = v17;
      if ( (_DWORD)v17 )
      {
        v13 = v17;
        if ( (int)sub_8000007C(v17, v16, v10, v9, v8, v15, v14) > 1 )
          dbg_msg("get_char returns %d\n", v18);
        return v13;
      }
    }
  }
  return v13;
}
// 800005A8: variable 'v11' is possibly undefined
// 800005A8: variable 'v10' is possibly undefined
// 800005A8: variable 'v9' is possibly undefined
// 800005A8: variable 'v8' is possibly undefined
// 800005A8: variable 'v7' is possibly undefined
// 800005A8: variable 'v6' is possibly undefined
// 800005C4: variable 'v16' is possibly undefined
// 800005C4: variable 'v15' is possibly undefined
// 800005C4: variable 'v14' is possibly undefined

//----- (0000000080000634) ----------------------------------------------------
__int64 __fastcall sub_80000634(_QWORD *a1, __int64 a2, char *a3, void *a4, void *a5)
{
  void *v8; // r9
  void *v9; // r8
  void *v10; // r7
  void *v11; // r6
  void *v12; // r5
  __int64 v13; // r4
  __int64 v14; // r3
  int v15; // r30
  char *v16; // r29
  void *v17; // r9
  void *v18; // r8
  void *v19; // r7
  void *v20; // r6
  void *v21; // r5
  __int64 v22; // r4
  unsigned int v23; // r31
  __int64 v24; // r4
  unsigned int v26[4]; // [sp+70h] [-40h] BYREF

  v26[0] = 0;
  v14 = sub_800004A0(a1, a2, a3, a4, a5);
  v15 = v14;
  v16 = 0LL;
  if ( (_DWORD)v14 )
  {
    if ( (int)sub_8000007C(v14, v13, v12, v11, v10, v9, v8) > 1 )
      dbg_msg("skip_whitespace returns %d\n", v15);
  }
  else
  {
    while ( 1 )
    {
      if ( v16 == a3 )
        return 22;
      v15 = sub_8000042C(a1, v26, v12, v11, v10);
      if ( v15 )
        break;
      v23 = v26[0];
      if ( v26[0] == 10 )
      {
        v15 = 23;
LABEL_14:
        v16[a2] = 0;
        return (unsigned int)v15;
      }
      if ( (unsigned __int8)sub_8000031C((__int64)a1, v26[0]) )
        goto LABEL_14;
      if ( v23 == 35 )
      {
        v15 = 23;
        sub_8000056C(a1, v24, v12, v11, v10);
        goto LABEL_14;
      }
      v16[a2] = v23;
      ++v16;
    }
    if ( (int)sub_8000007C((__int64)a1, v22, v21, v20, v19, v18, v17) > 1 )
      dbg_msg("get_char returns %d\n", v15);
  }
  return (unsigned int)v15;
}
// 80000680: variable 'v13' is possibly undefined
// 80000680: variable 'v12' is possibly undefined
// 80000680: variable 'v11' is possibly undefined
// 80000680: variable 'v10' is possibly undefined
// 80000680: variable 'v9' is possibly undefined
// 80000680: variable 'v8' is possibly undefined
// 800006AC: variable 'v22' is possibly undefined
// 800006AC: variable 'v21' is possibly undefined
// 800006AC: variable 'v20' is possibly undefined
// 800006AC: variable 'v19' is possibly undefined
// 800006AC: variable 'v18' is possibly undefined
// 800006AC: variable 'v17' is possibly undefined
// 800006E8: variable 'v24' is possibly undefined

//----- (000000008000076C) ----------------------------------------------------
__int64 __fastcall sub_8000076C(_QWORD *a1, _BYTE *a2, __int64 a3, void *a4, void *a5)
{
  void *v6; // r9
  void *v7; // r8
  void *v8; // r7
  void *v9; // r6
  __int64 v10; // r3
  int v11; // r31
  char v13[264]; // [sp+70h] [-120h] BYREF

  v10 = sub_80000634(a1, (__int64)v13, (char *)0x100, a4, a5);
  v11 = v10;
  if ( !(_DWORD)v10 || (_DWORD)v10 == 23 )
  {
    v11 = 0;
    if ( (unsigned int)sub_8000249C("sync", v13, 256LL) )
    {
      v11 = 22;
      if ( !(unsigned int)sub_8000249C("nosync", v13, 256LL) )
      {
        v11 = 0;
        *a2 = 0;
      }
    }
    else
    {
      *a2 = 1;
    }
  }
  else if ( (int)sub_8000007C(v10, (__int64)v13, (void *)0x100, v9, v8, v7, v6) > 1 )
  {
    dbg_msg("In check_sync: get_word failed: ret = %d\n", v11);
  }
  return (unsigned int)v11;
}
// 800007B4: variable 'v9' is possibly undefined
// 800007B4: variable 'v8' is possibly undefined
// 800007B4: variable 'v7' is possibly undefined
// 800007B4: variable 'v6' is possibly undefined

//----- (0000000080000834) ----------------------------------------------------
__int64 __fastcall sub_80000834(_QWORD *a1, _QWORD *a2, __int64 a3, void *a4, void *a5)
{
  void *v6; // r9
  void *v7; // r8
  void *v8; // r7
  void *v9; // r6
  __int64 v10; // r3
  int v11; // r31
  char v13[264]; // [sp+70h] [-120h] BYREF

  v10 = sub_80000634(a1, (__int64)v13, (char *)0x100, a4, a5);
  v11 = v10;
  if ( (_DWORD)v10 )
  {
    if ( (int)sub_8000007C(v10, (__int64)v13, (void *)0x100, v9, v8, v7, v6) > 1 )
      dbg_msg("In get_function: get_word failed: ret = %d\n", v11);
  }
  else
  {
    *a2 = 0LL;
    if ( (unsigned int)sub_8000249C((unsigned __int8 *)off_C0000000, v13, 256LL) )
      v11 = 6;
    else
      *a2 = off_C0000008;
  }
  return (unsigned int)v11;
}
// 80000874: variable 'v9' is possibly undefined
// 80000874: variable 'v8' is possibly undefined
// 80000874: variable 'v7' is possibly undefined
// 80000874: variable 'v6' is possibly undefined
// C0000000: using guessed type char *off_C0000000;
// C0000008: using guessed type OPD64_s *off_C0000008;

//----- (00000000800008DC) ----------------------------------------------------
__int64 __fastcall sub_800008DC(_QWORD *a1, __int64 a2, __int64 a3, void *a4, void *a5)
{
  void *v6; // r9
  void *v7; // r8
  void *v8; // r7
  void *v9; // r6
  void *v10; // r5
  __int64 v11; // r4
  __int64 v12; // r3
  unsigned int v13; // r31
  void *v14; // r9
  void *v15; // r8
  void *v16; // r7
  void *v17; // r6
  void *v18; // r5
  __int64 v19; // r4
  __int64 v20; // r3
  void *v21; // r9
  void *v22; // r8
  void *v23; // r7
  void *v24; // r6
  void *v25; // r5
  __int64 v26; // r4
  __int64 v27; // r3
  void *v28; // r9
  void *v29; // r8
  void *v30; // r7
  void *v31; // r6
  void *v32; // r5
  __int64 v33; // r4
  __int64 v34; // r3
  void *v35; // r9
  void *v36; // r8
  void *v37; // r7
  void *v38; // r6
  void *v39; // r5
  __int64 v40; // r4
  __int64 v41; // r3
  char v43[8]; // [sp+70h] [-130h] BYREF
  __int64 (__fastcall **v44)(char *, _QWORD); // [sp+78h] [-128h] BYREF
  char v45[264]; // [sp+80h] [-120h] BYREF

  v43[0] = 0;
  v12 = sub_80000834(a1, &v44, a3, a4, a5);
  v13 = v12;
  if ( (_DWORD)v12 == 23 )
    return 0;
  if ( (_DWORD)v12 )
  {
    v20 = sub_8000007C(v12, v11, v10, v9, v8, v7, v6);
    if ( (int)v20 > 1 )
      v20 = dbg_msg("In process_line: get_function failed: ");
  }
  else
  {
    v27 = sub_80000768(a1, v45, 256LL);
    v13 = v27;
    if ( (_DWORD)v27 )
    {
      v20 = sub_8000007C(v27, v26, v25, v24, v23, v22, v21);
      if ( (int)v20 > 1 )
        v20 = dbg_msg("In process_line: get_path failed: ");
    }
    else
    {
      v34 = sub_8000076C(a1, v43, (__int64)v25, v24, v23);
      v13 = v34;
      if ( (_DWORD)v34 )
      {
        v20 = sub_8000007C(v34, v33, v32, v31, v30, v29, v28);
        if ( (int)v20 > 1 )
          v20 = dbg_msg("In process_line: check_sync failed: ");
      }
      else
      {
        v41 = (*v44)(v45, (unsigned __int8)v43[0]);
        v13 = v41;
        if ( !(_DWORD)v41 )
          return v13;
        v20 = sub_8000007C(v41, v40, v39, v38, v37, v36, v35);
        if ( (int)v20 > 1 )
          v20 = dbg_msg("In process_line: execute command failed: ");
      }
    }
  }
  if ( (int)sub_8000007C(v20, v19, v18, v17, v16, v15, v14) > 1 )
    dbg_msg("ret = %d\n", (int)v13);
  return v13;
}
// 80000924: variable 'v11' is possibly undefined
// 80000924: variable 'v10' is possibly undefined
// 80000924: variable 'v9' is possibly undefined
// 80000924: variable 'v8' is possibly undefined
// 80000924: variable 'v7' is possibly undefined
// 80000924: variable 'v6' is possibly undefined
// 80000958: variable 'v26' is possibly undefined
// 80000958: variable 'v25' is possibly undefined
// 80000958: variable 'v24' is possibly undefined
// 80000958: variable 'v23' is possibly undefined
// 80000958: variable 'v22' is possibly undefined
// 80000958: variable 'v21' is possibly undefined
// 80000984: variable 'v33' is possibly undefined
// 80000984: variable 'v32' is possibly undefined
// 80000984: variable 'v31' is possibly undefined
// 80000984: variable 'v30' is possibly undefined
// 80000984: variable 'v29' is possibly undefined
// 80000984: variable 'v28' is possibly undefined
// 800009C0: variable 'v40' is possibly undefined
// 800009C0: variable 'v39' is possibly undefined
// 800009C0: variable 'v38' is possibly undefined
// 800009C0: variable 'v37' is possibly undefined
// 800009C0: variable 'v36' is possibly undefined
// 800009C0: variable 'v35' is possibly undefined
// 800009D4: variable 'v19' is possibly undefined
// 800009D4: variable 'v18' is possibly undefined
// 800009D4: variable 'v17' is possibly undefined
// 800009D4: variable 'v16' is possibly undefined
// 800009D4: variable 'v15' is possibly undefined
// 800009D4: variable 'v14' is possibly undefined
// 80000768: using guessed type __int64 __fastcall sub_80000768(_QWORD, _QWORD, _QWORD);

//----- (0000000080000A0C) ----------------------------------------------------
// r3 =
// r4 =
// r5 =
// r6 =
// r7 = 0xC0000010,
__int64 __fastcall sub_80000A0C(void **a1, void **a2, _QWORD *a3, _QWORD *a4, _DWORD *a5, void *a6)
{
  int v7; // r31
  void *v8; // r9
  void *v9; // r8
  void *v10; // r7
  void *v11; // r6
  void *v12; // r5
  __int64 v13; // r4
  char v14; // r3
  void *v15; // r9
  void *v16; // r8
  void *v17; // r7
  void *v18; // r6
  void *v19; // r5
  __int64 v20; // r4
  __int64 v21; // r3
  void *v22; // r9
  void *v23; // r8
  void *v24; // r7
  void *v25; // r6
  void *v26; // r5
  __int64 v27; // r4
  void *v28; // r9
  void *v29; // r8
  void *v30; // r7
  void *v31; // r6
  void *v32; // r5
  void *v33; // r4
  void *v34; // r9
  void *v35; // r8
  void *v36; // r7
  void *v37; // r6
  void *v38; // r5
  __int64 v39; // r4
  __int64 v40; // r3
  bool v41; // cr61

  v7 = sub_800012BC(a1, a2, a3, a4, a5, a6);
  v14 = 0;
  if ( v7 )
  {
    if ( v7 == 14 )
    {
      v21 = sub_8000007C(0LL, v13, v12, v11, v10, v9, v8);
      if ( (int)v21 > 0 )
        v21 = dbg_msg("timeout, system initialization failure ");
      if ( (int)sub_8000007C(v21, v20, v19, v18, v17, v16, v15) > 0 )
        dbg_msg("(0x%llx)\n", *a1);
      power_down_80000140(2, v27, v26, v25, v24, v23, v22);
      exit((void *)0xFFFFFFFFFFFFFFFFLL, v33, v32, v31, v30, v29, v28);
    }
    v40 = sub_8000007C(0LL, v13, v12, v11, v10, v9, v8);
    if ( (int)v40 > 0 )
      v40 = dbg_msg("process synchronization failure ");
    v41 = (int)sub_8000007C(v40, v39, v38, v37, v36, v35, v34) > 0;
    v14 = 15;
    if ( v41 )
    {
      dbg_msg("(0x%llx)\n", v7);
      v14 = 15;
    }
  }
  return v14 & 0xF;
}
// 80000A40: variable 'v13' is possibly undefined
// 80000A40: variable 'v12' is possibly undefined
// 80000A40: variable 'v11' is possibly undefined
// 80000A40: variable 'v10' is possibly undefined
// 80000A40: variable 'v9' is possibly undefined
// 80000A40: variable 'v8' is possibly undefined
// 80000A54: variable 'v20' is possibly undefined
// 80000A54: variable 'v19' is possibly undefined
// 80000A54: variable 'v18' is possibly undefined
// 80000A54: variable 'v17' is possibly undefined
// 80000A54: variable 'v16' is possibly undefined
// 80000A54: variable 'v15' is possibly undefined
// 80000A70: variable 'v27' is possibly undefined
// 80000A70: variable 'v26' is possibly undefined
// 80000A70: variable 'v25' is possibly undefined
// 80000A70: variable 'v24' is possibly undefined
// 80000A70: variable 'v23' is possibly undefined
// 80000A70: variable 'v22' is possibly undefined
// 80000A78: variable 'v33' is possibly undefined
// 80000A78: variable 'v32' is possibly undefined
// 80000A78: variable 'v31' is possibly undefined
// 80000A78: variable 'v30' is possibly undefined
// 80000A78: variable 'v29' is possibly undefined
// 80000A78: variable 'v28' is possibly undefined
// 80000A94: variable 'v39' is possibly undefined
// 80000A94: variable 'v38' is possibly undefined
// 80000A94: variable 'v37' is possibly undefined
// 80000A94: variable 'v36' is possibly undefined
// 80000A94: variable 'v35' is possibly undefined
// 80000A94: variable 'v34' is possibly undefined

//----- (0000000080000AD0) ----------------------------------------------------
// r3 = const char *str,
// r4 =
__int64 __fastcall sub_80000AD0(char *a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v8; // r25
  void *v9; // r8
  void *v10; // r7
  void *v11; // r6
  void *v12; // r5
  void *v13; // r4
  _BYTE *v14; // r3
  __int64 v15; // r3
  __int64 v16; // r26
  void *v17; // r9
  void *v18; // r8
  void *v19; // r7
  void *v20; // r6
  void *v21; // r9
  void *v22; // r8
  void *v23; // r7
  void *v24; // r6
  void *v25; // r5
  __int64 v26; // r4
  __int64 v27; // r3
  int v28; // r29
  unsigned int v29; // r31
  void *v30; // r9
  void *v31; // r8
  void *v32; // r7
  void *v33; // r6
  void *v34; // r5
  __int64 v35; // r4
  __int64 v36; // r3
  void *v37; // r9
  void *v38; // r8
  void *v39; // r7
  void *v40; // r6
  void *v41; // r5
  __int64 v42; // r4
  __int64 v43; // r3
  void *v44; // r9
  void *v45; // r8
  void *v46; // r7
  void *v47; // r6
  void *v48; // r5
  __int64 v49; // r4
  void *v50; // r9
  void *v51; // r8
  void *v52; // r7
  void *v53; // r6
  void *v54; // r5
  void *v55; // r4
  void *v56; // r9
  void *v57; // r8
  void *v58; // r7
  void *v59; // r6
  void *v60; // r5
  __int64 v61; // r4
  __int64 v62; // r3
  void *v63; // r8
  void *v64; // r7
  void *v65; // r6
  void *v66; // r9
  void *v67; // r8
  void *v68; // r7
  void *v69; // r6
  void *v70; // r5
  void *v71; // r4
  void *v72; // r9
  void *v73; // r8
  void *v74; // r7
  void *v75; // r6
  void *v76; // r5
  __int64 v77; // r4
  __int64 v78; // r3
  void *v79; // r3
  int v80; // r3
  void *v81; // r9
  void *v82; // r8
  void *v83; // r7
  void *v84; // r6
  void *v85; // r5
  __int64 v86; // r4
  __int64 v87; // r3
  void *v88; // r9
  void *v89; // r8
  void *v90; // r7
  void *v91; // r6
  void *v92; // r5
  __int64 v93; // r4
  __int64 v94; // r3
  void *v96; // [sp+70h] [-290h] BYREF
  __int64 v97; // [sp+78h] [-288h] BYREF
  __int64 v98; // [sp+80h] [-280h] BYREF
  void *v99; // [sp+88h] [-278h] BYREF
  __int64 v100; // [sp+90h] [-270h] BYREF
  char v101[16]; // [sp+98h] [-268h] BYREF
  __int64 v102[2]; // [sp+A8h] [-258h] BYREF
  char v103[528]; // [sp+B8h] [-248h] BYREF

  v8 = a2;
  v99 = 0LL;
  v98 = 0LL;
  v97 = 0LL;
  if ( (int)sub_8000007C((__int64)a1, a2, a3, a4, a5, a6, a7) > 1 )
    dbg_msg("booting %s...\n", a1);
  v14 = sub_80001EE0(v101, (char *)&v99, 8uLL);
  v102[0] = (__int64)v101;
  v101[8] = 0;
  v102[1] = 0LL;
  if ( !byte_C0000DE0 )
  {
    v100 = 512LL;
    sc_10033_unk((void *)1, v103, (void **)&v100, v11, v10, v9, &byte_C0000DE0);
    v16 = v15;
    v100 = 512LL;
    sc_10033_unk((void *)5, v103, (void **)&v100, v20, v19, v18, v17);
    if ( !v16 || !v14 )
      dword_C0000010 = 0;
    byte_C0000DE0 = 1;
  }
  v27 = fork(v14, v13, v12, v11, v10, v9, &byte_C0000DE0);
  v28 = v27;
  if ( (int)v27 <= 0 )
  {
    if ( !(_DWORD)v27 )
    {
      v62 = execv(a1, v102, v25, v24, v23, v22, v21);
      if ( (int)v62 < 0 )
      {
        if ( (int)sub_8000007C(v62, v61, v60, v59, v58, v57, v56) > 1 )
          dbg_msg("couldn't exec %s, skip it\n", a1);
        sub_800013E8((void *)2, v102, 0LL, v65, v64, v63);
        exit((void *)0xFFFFFFFFFFFFFFFFLL, v71, v70, v69, v68, v67, v66);
      }
      v78 = sub_8000007C(v62, v61, v60, v59, v58, v57, v56);
      if ( (int)v78 > 0 )
        v78 = dbg_msg("process execution failure\n");
      v79 = (void *)sub_8000007C(v78, v77, v76, v75, v74, v73, v72);
      if ( (int)v79 > 0 )
      {
        v80 = getpid(v79, v55, v54, v53, v52, v51, v50);
        dbg_msg("exiting... (pid: %d)\n", v80);
      }
LABEL_30:
      exit((void *)0xFFFFFFFFFFFFFFFFLL, v55, v54, v53, v52, v51, v50);
    }
    v87 = sub_8000007C(v27, v26, v25, v24, v23, v22, v21);
    if ( (int)v87 > 0 )
      v87 = dbg_msg("process execution failure ");
    v94 = sub_8000007C(v87, v86, v85, v84, v83, v82, v81);
    if ( (int)v94 > 0 )
      v94 = dbg_msg("(0x%llx, 0x%llx)\n", v28, dword_C0000DE4);
    v29 = 15;
    if ( (int)sub_8000007C(v94, v93, v92, v91, v90, v89, v88) > 1 )
      dbg_msg("fork failed: ret = %d, errno = %d\n", v28, dword_C0000DE4);
  }
  else
  {
    v29 = 0;
    if ( !v8 )
      return v29;
    v96 = (void *)(int)v27;
    v36 = sub_80000A0C(&v96, &v99, &v98, &v97, &dword_C0000010, v22);
    v29 = v36;
    if ( (_DWORD)v36 )
    {
      if ( (int)sub_8000007C(v36, v35, v34, v33, v32, v31, v30) > 1 )
        dbg_msg("get_child_status failed\n");
      return v29;
    }
    if ( v97 != 1 )
    {
      v43 = sub_8000007C(v36, v35, v34, v33, v32, v31, v30);
      if ( (int)v43 > 1 )
        v43 = dbg_msg("failed\n");
      if ( (int)sub_8000007C(v43, v42, v41, v40, v39, v38, v37) > 0 )
        dbg_msg("pme_init: initialization failure\n");
      power_down_80000140(1, v49, v48, v47, v46, v45, v44);
      goto LABEL_30;
    }
    if ( (int)sub_8000007C(v36, v35, v34, v33, v32, v31, v30) > 1 )
      dbg_msg("ready\n");
  }
  return v29;
}
// 80000B74: variable 'v11' is possibly undefined
// 80000B74: variable 'v10' is possibly undefined
// 80000B74: variable 'v9' is possibly undefined
// 80000B7C: variable 'v15' is possibly undefined
// 80000B8C: variable 'v20' is possibly undefined
// 80000B8C: variable 'v19' is possibly undefined
// 80000B8C: variable 'v18' is possibly undefined
// 80000B8C: variable 'v17' is possibly undefined
// 80000B9C: variable 'v14' is possibly undefined
// 80000BB4: variable 'v13' is possibly undefined
// 80000BB4: variable 'v12' is possibly undefined
// 80000BEC: variable 'v22' is possibly undefined
// 80000BFC: variable 'v35' is possibly undefined
// 80000BFC: variable 'v34' is possibly undefined
// 80000BFC: variable 'v33' is possibly undefined
// 80000BFC: variable 'v32' is possibly undefined
// 80000BFC: variable 'v31' is possibly undefined
// 80000BFC: variable 'v30' is possibly undefined
// 80000C30: variable 'v42' is possibly undefined
// 80000C30: variable 'v41' is possibly undefined
// 80000C30: variable 'v40' is possibly undefined
// 80000C30: variable 'v39' is possibly undefined
// 80000C30: variable 'v38' is possibly undefined
// 80000C30: variable 'v37' is possibly undefined
// 80000C48: variable 'v49' is possibly undefined
// 80000C48: variable 'v48' is possibly undefined
// 80000C48: variable 'v47' is possibly undefined
// 80000C48: variable 'v46' is possibly undefined
// 80000C48: variable 'v45' is possibly undefined
// 80000C48: variable 'v44' is possibly undefined
// 80000C7C: variable 'v25' is possibly undefined
// 80000C7C: variable 'v24' is possibly undefined
// 80000C7C: variable 'v23' is possibly undefined
// 80000C7C: variable 'v21' is possibly undefined
// 80000C88: variable 'v61' is possibly undefined
// 80000C88: variable 'v60' is possibly undefined
// 80000C88: variable 'v59' is possibly undefined
// 80000C88: variable 'v58' is possibly undefined
// 80000C88: variable 'v57' is possibly undefined
// 80000C88: variable 'v56' is possibly undefined
// 80000CAC: variable 'v65' is possibly undefined
// 80000CAC: variable 'v64' is possibly undefined
// 80000CAC: variable 'v63' is possibly undefined
// 80000CB4: variable 'v71' is possibly undefined
// 80000CB4: variable 'v70' is possibly undefined
// 80000CB4: variable 'v69' is possibly undefined
// 80000CB4: variable 'v68' is possibly undefined
// 80000CB4: variable 'v67' is possibly undefined
// 80000CB4: variable 'v66' is possibly undefined
// 80000CCC: variable 'v77' is possibly undefined
// 80000CCC: variable 'v76' is possibly undefined
// 80000CCC: variable 'v75' is possibly undefined
// 80000CCC: variable 'v74' is possibly undefined
// 80000CCC: variable 'v73' is possibly undefined
// 80000CCC: variable 'v72' is possibly undefined
// 80000CD8: variable 'v55' is possibly undefined
// 80000CD8: variable 'v54' is possibly undefined
// 80000CD8: variable 'v53' is possibly undefined
// 80000CD8: variable 'v52' is possibly undefined
// 80000CD8: variable 'v51' is possibly undefined
// 80000CD8: variable 'v50' is possibly undefined
// 80000CF8: variable 'v26' is possibly undefined
// 80000D0C: variable 'v86' is possibly undefined
// 80000D0C: variable 'v85' is possibly undefined
// 80000D0C: variable 'v84' is possibly undefined
// 80000D0C: variable 'v83' is possibly undefined
// 80000D0C: variable 'v82' is possibly undefined
// 80000D0C: variable 'v81' is possibly undefined
// 80000D30: variable 'v93' is possibly undefined
// 80000D30: variable 'v92' is possibly undefined
// 80000D30: variable 'v91' is possibly undefined
// 80000D30: variable 'v90' is possibly undefined
// 80000D30: variable 'v89' is possibly undefined
// 80000D30: variable 'v88' is possibly undefined
// C0000010: using guessed type int dword_C0000010;
// C0000DE0: using guessed type char byte_C0000DE0;
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (0000000080000D88) ----------------------------------------------------
__int64 __fastcall sub_80000D88(int *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  bool v8; // cr61
  char v9; // r3
  unsigned __int64 v10; // r3

  if ( *((_BYTE *)a1 + 32) )
  {
    v10 = *((_QWORD *)a1 + 1);
    if ( v10 )
    {
      sub_80002760(v10);
      *((_QWORD *)a1 + 1) = 0LL;
    }
    if ( *a1 )
    {
      close((void *)*a1, a2, a3, a4, a5, a6, a7);
      *a1 = 0;
    }
    v9 = 0;
    *((_BYTE *)a1 + 32) = 1;
  }
  else
  {
    v8 = (int)sub_8000007C((__int64)a1, (__int64)a2, a3, a4, a5, a6, a7) > 1;
    v9 = 13;
    if ( v8 )
    {
      dbg_msg("parser::finalize: not initialized\n");
      v9 = 13;
    }
  }
  return v9 & 0xD;
}
// 80000DF4: variable 'a2' is possibly undefined
// 80000DF4: variable 'a3' is possibly undefined
// 80000DF4: variable 'a4' is possibly undefined
// 80000DF4: variable 'a5' is possibly undefined
// 80000DF4: variable 'a6' is possibly undefined
// 80000DF4: variable 'a7' is possibly undefined

//----- (0000000080000E28) ----------------------------------------------------
__int64 __fastcall sub_80000E28(int *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  unsigned __int64 v8; // r3
  __int64 result; // r3

  v8 = *((_QWORD *)a1 + 1);
  if ( v8 )
    sub_80002760(v8);
  result = *a1;
  if ( *a1 )
    result = close((void *)result, a2, a3, a4, a5, a6, a7);
  return result;
}
// 80000E6C: variable 'a2' is possibly undefined
// 80000E6C: variable 'a3' is possibly undefined
// 80000E6C: variable 'a4' is possibly undefined
// 80000E6C: variable 'a5' is possibly undefined
// 80000E6C: variable 'a6' is possibly undefined
// 80000E6C: variable 'a7' is possibly undefined

//----- (0000000080000E84) ----------------------------------------------------
// r3 = *ctx,
// 
// struct ctx {
//   u32 fd;         // 0x00: "pme_init.conf"
//   u32 pad_0;      // 0x04: 
//   u64 buf;        // 0x08: 
//   u64 file_size;  // 0x10: 
//   u64 unk_18;     // 0x18: 
//   u8 init;        // 0x20: 
//   u8 pad_1[7];    // 0x21:
// }
__int64 __fastcall sub_80000E84(int *a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // r28
  bool v9; // cr61
  char v10; // r3
  void *v11; // r9
  void *v12; // r8
  void *v13; // r7
  void *v14; // r6
  void *v15; // r5
  __int64 v16; // r4
  __int64 v17; // r3
  bool v18; // cr61
  void *v19; // r9
  void *v20; // r8
  void *v21; // r7
  void *v22; // r6
  void *v23; // r5
  __int64 v24; // r4
  __int64 v25; // r3
  void *v26; // r9
  void *v27; // r8
  void *v28; // r7
  void *v29; // r6
  void *v30; // r9
  void *v31; // r8
  void *v32; // r7
  void *v33; // r6
  void *v34; // r5
  __int64 v35; // r4
  __int64 v36; // r3
  int v37; // r31
  __int64 v38; // r4
  void *v39; // r3
  void *v40; // r9
  void *v41; // r8
  void *v42; // r7
  void *v43; // r6
  void *v44; // r5
  __int64 v45; // r4
  __int64 v46; // r3
  void *v47; // r9
  void *v48; // r8
  void *v49; // r7
  void *v50; // r6
  void *v51; // r5
  void *v52; // r4
  bool v53; // cr61
  void *v54; // r9
  void *v55; // r8
  void *v56; // r7
  void *v57; // r6
  void *v58; // r5
  void *v59; // r4
  __int64 v60; // r3
  __int64 v61; // r31
  void *v62; // r9
  void *v63; // r8
  void *v64; // r7
  void *v65; // r6
  void *v66; // r5
  __int64 v67; // r4
  __int64 v68; // r3
  void *v69; // r9
  void *v70; // r8
  void *v71; // r7
  void *v72; // r6
  void *v73; // r5
  __int64 v74; // r4
  __int64 v75; // r3
  void *v76; // r9
  void *v77; // r8
  void *v78; // r7
  void *v79; // r6
  void *v80; // r5
  __int64 v81; // r4
  __int64 v82; // r3

  v7 = *((unsigned __int8 *)a1 + 32);
  if ( *((_BYTE *)a1 + 32) )
  {
    v9 = (int)sub_8000007C((__int64)a1, a2, a3, a4, a5, a6, a7) > 1;
    v10 = 12;
    if ( v9 )
    {
      dbg_msg("parser::initialized: already initialized\n");
      v10 = 12;
    }
    return v10 & 0xF;
  }
  v17 = open("pme_init.conf", 0LL, a3, a4, a5, a6, a7);
  *a1 = v17;
  if ( (int)v17 < 0 )
  {
    if ( dword_C0000DE4 == -3 )
    {
      v18 = (int)sub_8000007C(v17, v16, v15, v14, v13, v12, v11) > 1;
      v10 = 6;
      if ( v18 )
      {
        dbg_msg("no %s file\n", "pme_init.conf");
        v10 = 6;
      }
      return v10 & 0xF;
    }
    v25 = sub_8000007C(v17, v16, v15, v14, v13, v12, v11);
    if ( (int)v25 > 1 )
      v25 = dbg_msg("open failed: \n");
    if ( (int)sub_8000007C(v25, v24, v23, v22, v21, v20, v19) > 1 )
      dbg_msg("ret = %d, errno = %d\n", *a1, dword_C0000DE4);
LABEL_40:
    v10 = 15;
    return v10 & 0xF;
  }
  if ( (int)sub_8000007C(v17, v16, v15, v14, v13, v12, v11) > 1 )
    dbg_msg("open succeeded\n");
  v36 = sc_0B_lseek((void *)*a1, 0LL, (void *)2, v29, v28, v27, v26);
  v37 = v36;
  if ( (int)v36 < 0
    || (v39 = (void *)*a1,
        *((_QWORD *)a1 + 2) = v37,
        v36 = sc_0B_lseek(v39, 0LL, 0LL, v33, v32, v31, v30),
        v37 = v36,
        (int)v36 < 0) )
  {
    v46 = sub_8000007C(v36, v35, v34, v33, v32, v31, v30);
    if ( (int)v46 > 1 )
      v46 = dbg_msg("lseek failed: \n");
    if ( (int)sub_8000007C(v46, v45, v44, v43, v42, v41, v40) <= 1 )
      goto LABEL_40;
    v38 = v37;
    goto LABEL_18;
  }
  v52 = (void *)malloc(*((_QWORD *)a1 + 2));
  *((_QWORD *)a1 + 1) = v52;
  if ( v52 )
  {
    v60 = read((void *)*a1, v52, *((void **)a1 + 2), v50, v49, v48, v47);
    v61 = v60;
    if ( v60 >= 0 )
    {
      if ( *((_QWORD *)a1 + 2) == v60 )
      {
        v75 = close((void *)*a1, v59, v58, v57, v56, v55, v54);
        if ( (int)v75 >= 0 )
        {
          v10 = 0;
          *((_BYTE *)a1 + 32) = 1;
          *a1 = v7;
          *((_QWORD *)a1 + 3) = 0LL;
          return v10 & 0xF;
        }
        v82 = sub_8000007C(v75, v74, v73, v72, v71, v70, v69);
        if ( (int)v82 > 1 )
          v82 = dbg_msg("close failed: \n");
        if ( (int)sub_8000007C(v82, v81, v80, v79, v78, v77, v76) > 1 )
          dbg_msg("errno = %d\n", dword_C0000DE4);
      }
      else if ( (int)sub_8000007C(v60, (__int64)v59, v58, v57, v56, v55, v54) > 1 )
      {
        dbg_msg("read returns %d, not %d\n", v61, *((_QWORD *)a1 + 2));
      }
      goto LABEL_40;
    }
    v68 = sub_8000007C(v60, (__int64)v59, v58, v57, v56, v55, v54);
    if ( (int)v68 > 1 )
      v68 = dbg_msg("read failed: ");
    if ( (int)sub_8000007C(v68, v67, v66, v65, v64, v63, v62) <= 1 )
      goto LABEL_40;
    v38 = v61;
LABEL_18:
    dbg_msg("ret = %d, errno = %d\n", v38, dword_C0000DE4);
    goto LABEL_40;
  }
  v53 = (int)sub_8000007C(0LL, 0LL, v51, v50, v49, v48, v47) > 1;
  v10 = 1;
  if ( v53 )
  {
    dbg_msg("malloc failed\n");
    v10 = 1;
  }
  return v10 & 0xF;
}
// 80000EFC: variable 'v16' is possibly undefined
// 80000EFC: variable 'v15' is possibly undefined
// 80000EFC: variable 'v14' is possibly undefined
// 80000EFC: variable 'v13' is possibly undefined
// 80000EFC: variable 'v12' is possibly undefined
// 80000EFC: variable 'v11' is possibly undefined
// 80000F34: variable 'v24' is possibly undefined
// 80000F34: variable 'v23' is possibly undefined
// 80000F34: variable 'v22' is possibly undefined
// 80000F34: variable 'v21' is possibly undefined
// 80000F34: variable 'v20' is possibly undefined
// 80000F34: variable 'v19' is possibly undefined
// 80000F7C: variable 'v29' is possibly undefined
// 80000F7C: variable 'v28' is possibly undefined
// 80000F7C: variable 'v27' is possibly undefined
// 80000F7C: variable 'v26' is possibly undefined
// 80000F98: variable 'v45' is possibly undefined
// 80000F98: variable 'v44' is possibly undefined
// 80000F98: variable 'v43' is possibly undefined
// 80000F98: variable 'v42' is possibly undefined
// 80000F98: variable 'v41' is possibly undefined
// 80000F98: variable 'v40' is possibly undefined
// 80000FD8: variable 'v33' is possibly undefined
// 80000FD8: variable 'v32' is possibly undefined
// 80000FD8: variable 'v31' is possibly undefined
// 80000FD8: variable 'v30' is possibly undefined
// 80000FE8: variable 'v35' is possibly undefined
// 80000FE8: variable 'v34' is possibly undefined
// 80001010: variable 'v51' is possibly undefined
// 80001010: variable 'v50' is possibly undefined
// 80001010: variable 'v49' is possibly undefined
// 80001010: variable 'v48' is possibly undefined
// 80001010: variable 'v47' is possibly undefined
// 8000104C: variable 'v59' is possibly undefined
// 8000104C: variable 'v58' is possibly undefined
// 8000104C: variable 'v57' is possibly undefined
// 8000104C: variable 'v56' is possibly undefined
// 8000104C: variable 'v55' is possibly undefined
// 8000104C: variable 'v54' is possibly undefined
// 80001060: variable 'v67' is possibly undefined
// 80001060: variable 'v66' is possibly undefined
// 80001060: variable 'v65' is possibly undefined
// 80001060: variable 'v64' is possibly undefined
// 80001060: variable 'v63' is possibly undefined
// 80001060: variable 'v62' is possibly undefined
// 800010B8: variable 'v74' is possibly undefined
// 800010B8: variable 'v73' is possibly undefined
// 800010B8: variable 'v72' is possibly undefined
// 800010B8: variable 'v71' is possibly undefined
// 800010B8: variable 'v70' is possibly undefined
// 800010B8: variable 'v69' is possibly undefined
// 800010CC: variable 'v81' is possibly undefined
// 800010CC: variable 'v80' is possibly undefined
// 800010CC: variable 'v79' is possibly undefined
// 800010CC: variable 'v78' is possibly undefined
// 800010CC: variable 'v77' is possibly undefined
// 800010CC: variable 'v76' is possibly undefined
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (0000000080001134) ----------------------------------------------------
// r3 = *ctx,
// 
// struct ctx {
//   u32 unk_00;     // 0x00: 
//   u32 pad_0;      // 0x04: 
//   u64 unk_08;     // 0x08: 
//   u64 unk_10;     // 0x10: 
//   u64 unk_18;     // 0x18: 
//   u8 unk_20;      // 0x20: 
//   u8 pad_1[7];    // 0x21:
// }
__int64 __fastcall sub_80001134(int *a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  void *v8; // r9
  void *v9; // r8
  void *v10; // r7
  void *v11; // r6
  void *v12; // r5
  void *v13; // r4
  __int64 v14; // r3
  int v15; // r30
  __int64 v16; // r4
  void *v17; // r9
  void *v18; // r8
  __int64 v19; // r3
  int v20; // r29
  int v21; // r31
  void *v22; // r9
  void *v23; // r8
  void *v24; // r7
  void *v25; // r6
  void *v26; // r5
  __int64 v27; // r4
  __int64 v28; // r3
  void *v29; // r9
  void *v30; // r8
  void *v31; // r7
  void *v32; // r6
  void *v33; // r5
  void *v34; // r4
  void *v35; // r9
  void *v36; // r8
  void *v37; // r7
  void *v38; // r6
  void *v39; // r5
  __int64 v40; // r4
  __int64 v41; // r3
  void *v42; // r9
  void *v43; // r8
  void *v44; // r7
  void *v45; // r6
  void *v46; // r5
  __int64 v47; // r4
  __int64 v48; // r3

  v14 = sub_80000E84(a1, a2, a3, a4, a5, a6, a7);
  v15 = v14;
  if ( (_DWORD)v14 == 6 )
  {
    v15 = 0;
    if ( (int)sub_8000007C(v14, (__int64)v13, v12, v11, v10, v9, v8) > 1 )
      dbg_msg("configuration skipped\n");
  }
  else if ( (_DWORD)v14 )
  {
    if ( (int)sub_8000007C(v14, (__int64)v13, v12, v11, v10, v9, v8) > 1 )
    {
      v16 = v15;
      v15 = 15;
      dbg_msg("parser::initialize failed: ret = %d\n", v16);
    }
    else
    {
      v15 = 15;
    }
  }
  else
  {
    do
    {
      v19 = sub_800008DC(a1, (__int64)v13, (__int64)v12, v11, v10);
      v20 = v19;
      v21 = v19;
    }
    while ( !(_DWORD)v19 );
    if ( (_DWORD)v19 == 6 )
    {
      v28 = sub_8000007C(v19, (__int64)v13, v12, v11, v10, v18, v17);
      if ( (int)v28 > 1 )
        v28 = dbg_msg("process_line returns ");
      if ( (int)sub_8000007C(v28, v27, v26, v25, v24, v23, v22) > 1 )
        dbg_msg("%d\n", 6LL);
      v48 = sub_80000D88(a1, v34, v33, v32, v31, v30, v29);
      if ( (_DWORD)v48 && (int)sub_8000007C(v48, v47, v46, v45, v44, v43, v42) > 1 )
        dbg_msg("parser::finalize failed\n");
    }
    else
    {
      v41 = sub_80000D88(a1, v13, v12, v11, v10, v18, v17);
      if ( (_DWORD)v41 && (int)sub_8000007C(v41, v40, v39, v38, v37, v36, v35) > 1 )
      {
        v15 = v20;
        dbg_msg("parser::finalize failed\n");
      }
      else
      {
        v15 = v21;
      }
    }
  }
  return (unsigned int)v15;
}
// 80001164: variable 'v13' is possibly undefined
// 80001164: variable 'v12' is possibly undefined
// 80001164: variable 'v11' is possibly undefined
// 80001164: variable 'v10' is possibly undefined
// 80001164: variable 'v9' is possibly undefined
// 80001164: variable 'v8' is possibly undefined
// 800011D0: variable 'v18' is possibly undefined
// 800011D0: variable 'v17' is possibly undefined
// 800011E4: variable 'v27' is possibly undefined
// 800011E4: variable 'v26' is possibly undefined
// 800011E4: variable 'v25' is possibly undefined
// 800011E4: variable 'v24' is possibly undefined
// 800011E4: variable 'v23' is possibly undefined
// 800011E4: variable 'v22' is possibly undefined
// 80001210: variable 'v40' is possibly undefined
// 80001210: variable 'v39' is possibly undefined
// 80001210: variable 'v38' is possibly undefined
// 80001210: variable 'v37' is possibly undefined
// 80001210: variable 'v36' is possibly undefined
// 80001210: variable 'v35' is possibly undefined
// 80001230: variable 'v34' is possibly undefined
// 80001230: variable 'v33' is possibly undefined
// 80001230: variable 'v32' is possibly undefined
// 80001230: variable 'v31' is possibly undefined
// 80001230: variable 'v30' is possibly undefined
// 80001230: variable 'v29' is possibly undefined
// 8000123C: variable 'v47' is possibly undefined
// 8000123C: variable 'v46' is possibly undefined
// 8000123C: variable 'v45' is possibly undefined
// 8000123C: variable 'v44' is possibly undefined
// 8000123C: variable 'v43' is possibly undefined
// 8000123C: variable 'v42' is possibly undefined

//----- (000000008000127C) ----------------------------------------------------
__int64 __fastcall sub_8000127C(int a1, char **a2)
{
  __int64 v3; // [sp+70h] [-10h] BYREF

  v3 = 0LL;
  if ( a1 > 1 )
    sub_80001EE0(&v3, *a2, 8uLL);
  return v3;
}

//----- (00000000800012BC) ----------------------------------------------------
// r3 =
// r4 =
// r5 =
// r6 =
// r7 = 0xC0000010,
__int64 __fastcall sub_800012BC(void **a1, void **a2, _QWORD *a3, _QWORD *a4, _DWORD *a5, void *a6)
{
  __int64 v11; // r3
  void *v12; // r10
  __int64 v13; // r11
  unsigned __int64 v14; // r31
  unsigned __int64 v15; // r28
  __int64 v16; // r29
  void *v17; // r9
  void *v18; // r8
  __int64 v19; // r7
  __int64 v20; // r6
  void *v21; // r9
  void *v22; // r8
  void *v23; // r7
  void *v24; // r6
  void *v25; // r5
  void *v26; // r4
  __int64 v27; // r3
  char v28; // r3
  void *v29; // r9
  __int64 v31[2]; // [sp+70h] [-60h] BYREF
  void *v32[4]; // [sp+80h] [-50h] BYREF

  v11 = get_be_clock((__int64)a1, (__int64)a2, (__int64)a3, (__int64)a4, (__int64)a5, a6);
  v12 = *a2;
  v13 = (unsigned int)*a5;
  v14 = v11;
  v32[2] = *a1;
  v32[3] = v12;
  v32[1] = (void *)0x73735F696E697400LL;
  v15 = 1000000 * v13;
  v32[0] = (void *)1936916480;
  v16 = get_tb();
  while ( 1 )
  {
    sc_0x100C1_get_repository_node_value((void *)1, v32, v31, v20, v19, v18, v17);
    if ( !v27 )
      break;
    if ( *a5 && 1000000 * (get_tb() - v16) / v14 >= v15 )
    {
      v28 = 14;
      return v28 & 0xE;
    }
    alarm((void *)0x2710, v26, v25, v24, v23, v22, v21);
  }
  v29 = (void *)v31[1];
  *a3 = v31[0];
  *a4 = v29;
  sc_0x100C3_remove_repository_node((void *)1, v32, (__int64)v25, (__int64)v24, (__int64)v23, v22, v29);
  v28 = 0;
  return v28 & 0xE;
}
// 80001350: variable 'v20' is possibly undefined
// 80001350: variable 'v19' is possibly undefined
// 80001350: variable 'v18' is possibly undefined
// 80001350: variable 'v17' is possibly undefined
// 80001358: variable 'v27' is possibly undefined
// 80001394: variable 'v26' is possibly undefined
// 80001394: variable 'v25' is possibly undefined
// 80001394: variable 'v24' is possibly undefined
// 80001394: variable 'v23' is possibly undefined
// 80001394: variable 'v22' is possibly undefined
// 80001394: variable 'v21' is possibly undefined

//----- (00000000800013E8) ----------------------------------------------------
__int64 __fastcall sub_800013E8(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6)
{
  int v7; // r28
  int v8; // r29
  void *v9; // r9
  __int64 v10; // r0
  __int64 v11; // r3
  void *v13[2]; // [sp+70h] [-60h] BYREF
  void *v14[5]; // [sp+80h] [-50h] BYREF

  v7 = (int)a1;
  v14[0] = (void *)1936916480;
  v14[1] = (void *)0x73735F696E697400LL;
  v8 = (int)a3;
  v14[2] = (void *)(int)getpid(a1, a2, a3, a4, a5, a6, (void *)0x73730000);
  v9 = (void *)sub_8000127C(v7, (char **)a2);
  v13[0] = 0LL;
  if ( v8 )
    v10 = 1LL;
  else
    v10 = 2LL;
  v13[1] = (void *)v10;
  v14[3] = v9;
  sc_0x100C0_create_repository_node((void *)1, v14, v13);
  return (((v11 >> 63) - ((v11 >> 63) ^ v11)) >> 63) & 0xF;
}
// 80001480: variable 'v11' is possibly undefined

//----- (00000000800014AC) ----------------------------------------------------
int get_tb()
{
  int result; // r3

  do
    __asm { mftb      r3 }
  while ( !result );
  return result;
}

//----- (00000000800014BC) ----------------------------------------------------
__int64 __fastcall get_be_clock(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, void *a6)
{
  __int64 v6; // r3
  bool v7; // cr62
  __int64 result; // r3
  __int64 v9[2]; // [sp+70h] [-30h] BYREF
  void *v10[4]; // [sp+80h] [-20h] BYREF

  v10[0] = (void *)1650786304;
  v10[2] = (void *)0x636C6F636B000000LL;
  v9[1] = 0LL;
  v10[1] = 0LL;
  v10[3] = 0LL;
  v9[0] = 0LL;
  sc_0x100C1_get_repository_node_value((void *)1, v10, v9, a4, a5, a6, (void *)0x62650000);
  v7 = v6 == 0;
  result = 0LL;
  if ( v7 )
    result = v9[0];
  return result;
}
// 80001508: variable 'v6' is possibly undefined

//----- (0000000080001528) ----------------------------------------------------
void __fastcall sc_0x100C0_create_repository_node(void *a1, void **a2, void **a3)
{
  int v3; // lr

  linux_syscall(v3, a1, *a2, a2[1], a2[2], a2[3], *a3, a3[1]);
}
// 8000155C: variable 'v3' is possibly undefined

//----- (0000000080001570) ----------------------------------------------------
void __fastcall sc_0x100C1_get_repository_node_value(void *a1, void **a2, _QWORD *a3, __int64 a4, __int64 a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 v9; // r5
  __int64 v10; // r4
  __int64 v11; // r3

  linux_syscall(v7, a1, *a2, a2[1], a2[2], a2[3], a6, a7);
  if ( !v11 )
  {
    a3[1] = v9;
    *a3 = v10;
  }
}
// 8000159C: variable 'v7' is possibly undefined
// 800015A4: variable 'v11' is possibly undefined
// 800015A8: variable 'v9' is possibly undefined
// 800015AC: variable 'v10' is possibly undefined

//----- (00000000800015C0) ----------------------------------------------------
void __fastcall sc_0x100C3_remove_repository_node(void *a1, void **a2, __int64 a3, __int64 a4, __int64 a5, void *a6, void *a7)
{
  int v7; // lr

  linux_syscall(v7, a1, *a2, a2[1], a2[2], a2[3], a6, a7);
}
// 800015E4: variable 'v7' is possibly undefined

//----- (00000000800015F4) ----------------------------------------------------
// r3 = arg_1, 1 or 5
// r4 =
// r5 = u64 *str_len,
void __fastcall sc_10033_unk(void *a1, void *a2, void **a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  void *v9; // r4
  __int64 v10; // r3

  linux_syscall(v7, a1, a2, *a3, a4, a5, a6, a7);
  if ( !v10 )
    *a3 = v9;
}
// 80001610: variable 'v7' is possibly undefined
// 80001618: variable 'v10' is possibly undefined
// 8000161C: variable 'v9' is possibly undefined

//----- (0000000080001630) ----------------------------------------------------
void __fastcall sc_10036_power_down(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
}
// 80001640: variable 'v7' is possibly undefined

//----- (0000000080001650) ----------------------------------------------------
// r3 = fd,
// r4 = arg_2, 0x334
__int64 __fastcall sub_80001650(int a1, int a2)
{
  unsigned __int8 *v4; // r3
  unsigned __int8 *v5; // r31
  int v6; // r29
  void *v7; // r9
  void *v8; // r8
  void *v9; // r7
  void *v10; // r6
  unsigned __int64 v11; // r3

  v4 = (unsigned __int8 *)malloc(8uLL);
  v5 = v4;
  v6 = 255;
  if ( v4 )
  {
    memset(v4, 0, 8uLL);
    *v5 = 18;
    v5[3] = 0;
    *((_DWORD *)v5 + 1) = a2;
    v5[1] = 0;
    v5[2] = 0;
    if ( sub_80001A8C(a1, 19, v5, (void *)8, (void *)8, 0LL, (void *)0x12) < 0 )
    {
      v11 = (unsigned __int64)v5;
LABEL_7:
      sub_80002760(v11);
      return v6;
    }
    if ( sub_80001C00(a1, v5, (void *)8, v10, v9, v8, v7) >= 0 )
    {
      v11 = (unsigned __int64)v5;
      v6 = *v5;
      goto LABEL_7;
    }
    v6 = 255;
    sub_80002760((unsigned __int64)v5);
  }
  return v6;
}
// 800016F0: variable 'v10' is possibly undefined
// 800016F0: variable 'v9' is possibly undefined
// 800016F0: variable 'v8' is possibly undefined
// 800016F0: variable 'v7' is possibly undefined

//----- (000000008000173C) ----------------------------------------------------
// r3 = fd,
__int64 __fastcall sub_8000173C(int a1, _DWORD *a2)
{
  _BYTE *v4; // r3
  _BYTE *v5; // r31
  int v6; // r29
  void *v7; // r9
  void *v8; // r9
  void *v9; // r8
  void *v10; // r7
  void *v11; // r6
  unsigned __int64 v12; // r3

  v4 = (_BYTE *)malloc(8uLL);
  v5 = v4;
  v6 = 255;
  if ( v4 )
  {
    memset(v4, 0, 8uLL);
    *v5 = 51;
    if ( sub_80001A8C(a1, 19, v5, (void *)8, (void *)1, 0LL, v7) < 0 )
    {
      v12 = (unsigned __int64)v5;
LABEL_7:
      sub_80002760(v12);
      return v6;
    }
    if ( sub_80001C00(a1, v5, (void *)8, v11, v10, v9, v8) >= 0 )
    {
      v12 = (unsigned __int64)v5;
      v6 = (unsigned __int8)*v5;
      *a2 = *((_DWORD *)v5 + 1);
      goto LABEL_7;
    }
    v6 = 255;
    sub_80002760((unsigned __int64)v5);
  }
  return v6;
}
// 800017A8: variable 'v7' is possibly undefined
// 800017C8: variable 'v11' is possibly undefined
// 800017C8: variable 'v10' is possibly undefined
// 800017C8: variable 'v9' is possibly undefined
// 800017C8: variable 'v8' is possibly undefined

//----- (000000008000181C) ----------------------------------------------------
// r3 = fd, "/dev/sc3"
// r4 = arg_2, 2
// r5 = arg_3, 0xCF
// r6 = pl_size, 1
// r7 = *buf,
__int64 __fastcall sub_8000181C(int a1, unsigned __int8 a2, unsigned __int8 a3, int a4, _BYTE *a5)
{
  unsigned __int8 v5; // r29
  unsigned __int64 v10; // r27
  char *v11; // r3
  int v12; // r4
  char *v13; // r31
  void *v14; // r9
  void *v15; // r9
  void *v16; // r8
  void *v17; // r7
  void *v18; // r6
  int v19; // r29

  v5 = a4;
  v10 = 256LL;
  if ( a4 )
    v10 = (unsigned __int8)a4;
  v11 = (char *)malloc(v10 + 4);
  v12 = 255;
  v13 = v11;
  if ( v11 )
  {
    memset(v11, 0, v10 + 4);
    *v13 = 32;
    v13[1] = a2;
    v13[2] = a3;
    v13[3] = v5;
    if ( sub_80001A8C(a1, 20, v13, (void *)(v10 + 4), (void *)4, 0LL, v14) >= 0
      && sub_80001C00(a1, v13, (void *)(v10 + 4), v18, v17, v16, v15) >= 0 )
    {
      if ( !*v13 )
        sub_80001EE0(a5, v13 + 4, v10);
      v19 = (unsigned __int8)*v13;
      sub_80002760((unsigned __int64)v13);
      v12 = v19;
    }
    else
    {
      sub_80002760((unsigned __int64)v13);
      v12 = 255;
    }
  }
  return v12;
}
// 800018C4: variable 'v14' is possibly undefined
// 800018DC: variable 'v18' is possibly undefined
// 800018DC: variable 'v17' is possibly undefined
// 800018DC: variable 'v16' is possibly undefined
// 800018DC: variable 'v15' is possibly undefined

//----- (0000000080001958) ----------------------------------------------------
// r3 = fd, 
// r4 = u8 arg_2, 1
// r5 = u8 arg_3, 4
// r6 = u8 arg_4, 8
// r7 = arg_5,
__int64 __fastcall sub_80001958(int a1, unsigned __int8 a2, unsigned __int8 a3, int a4, char *a5)
{
  unsigned __int8 v5; // r29
  unsigned __int64 v9; // r28
  unsigned __int8 *v11; // r3
  unsigned __int8 *v12; // r31
  int v13; // r0
  void *v14; // r9
  void *v15; // r9
  void *v16; // r8
  void *v17; // r7
  void *v18; // r6
  unsigned __int64 v19; // r3
  bool v20; // cr60
  int v21; // r29

  v5 = a4;
  v9 = 256LL;
  if ( a4 )
    v9 = (unsigned __int8)a4;
  v11 = (unsigned __int8 *)malloc(v9 + 4);
  v12 = v11;
  v13 = 255;
  if ( v11 )
  {
    memset(v11, 0, v9 + 4);
    *v12 = 16;
    v12[1] = a2;
    v12[2] = a3;
    v12[3] = v5;
    sub_80001EE0(v12 + 4, a5, v9);
    if ( sub_80001A8C(a1, 20, v12, (void *)(v9 + 4), (void *)(v9 + 4), 0LL, v14) >= 0 )
    {
      v20 = sub_80001C00(a1, v12, (void *)(v9 + 4), v18, v17, v16, v15) < 0;
      v19 = (unsigned __int64)v12;
      if ( !v20 )
      {
        v21 = *v12;
        sub_80002760((unsigned __int64)v12);
        return v21;
      }
    }
    else
    {
      v19 = (unsigned __int64)v12;
    }
    sub_80002760(v19);
    v13 = 255;
  }
  return v13;
}
// 80001A0C: variable 'v14' is possibly undefined
// 80001A2C: variable 'v18' is possibly undefined
// 80001A2C: variable 'v17' is possibly undefined
// 80001A2C: variable 'v16' is possibly undefined
// 80001A2C: variable 'v15' is possibly undefined

//----- (0000000080001A8C) ----------------------------------------------------
__int64 __fastcall sub_80001A8C(int a1, char a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  __int16 v11; // r29
  _BYTE *v12; // r31
  int v13; // r0
  unsigned int v14; // r3
  unsigned int v15; // r3
  void *v16; // r9
  void *v17; // r8
  void *v18; // r7
  void *v19; // r6
  __int64 v20; // r29
  void *v21; // r9
  void *v22; // r8
  void *v23; // r7
  void *v24; // r6
  void *v25; // r5
  int v26; // r3
  __int64 v27; // r4
  unsigned int v28; // r3
  __int64 v30; // [sp+70h] [-70h] BYREF
  _BYTE *v31; // [sp+78h] [-68h]
  __int64 v32[2]; // [sp+80h] [-60h] BYREF
  int v33; // [sp+90h] [-50h]

  v11 = (__int16)a6;
  sub_80001E80(&v30, (void *)1, a3, a4, a5, a6, a7);
  v12 = v31;
  memset(v31, 0, 0x1000uLL);
  v12[1] = 1;
  *v12 = a2;
  *((_WORD *)v12 + 1) = v11;
  *((_WORD *)v12 + 3) = sub_80001D38((__int64)v12);
  sub_80001EE0(v12 + 16, (char *)a3, (unsigned __int64)a5);
  v32[1] = (__int64)(v12 + 16);
  v33 = (int)a5;
  *((_WORD *)v12 + 6) = (_WORD)a5;
  v13 = (unsigned __int8)byte_C0000DE1;
  *((_WORD *)v12 + 7) = (_WORD)a5;
  v32[0] = (__int64)v12;
  if ( v13 )
  {
    dbg_msg("syscon write data:\n");
    v14 = sub_80001D6C((__int64)v32);
    sub_80001D7C((__int64)v12, v14);
  }
  v15 = sub_80001D6C((__int64)v32);
  v20 = socket((void *)a1, v12, (void *)v15, v19, v18, v17, v16);
  v26 = sub_80001D6C((__int64)v32);
  v27 = v20;
  if ( v20 != v26 )
  {
    v20 = -1LL;
    dbg_msg("command write failed. (%d, %d)\n", v27, dword_C0000DE4);
    if ( !byte_C0000DE1 )
    {
      v28 = sub_80001D6C((__int64)v32);
      sub_80001D7C((__int64)v12, v28);
    }
  }
  sub_80001E38((__int64)&v30, v27, v25, v24, v23, v22, v21);
  return v20;
}
// 80001B70: variable 'v19' is possibly undefined
// 80001B70: variable 'v18' is possibly undefined
// 80001B70: variable 'v17' is possibly undefined
// 80001B70: variable 'v16' is possibly undefined
// 80001BCC: variable 'v27' is possibly undefined
// 80001BCC: variable 'v25' is possibly undefined
// 80001BCC: variable 'v24' is possibly undefined
// 80001BCC: variable 'v23' is possibly undefined
// 80001BCC: variable 'v22' is possibly undefined
// 80001BCC: variable 'v21' is possibly undefined
// C0000DE1: using guessed type char byte_C0000DE1;
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (0000000080001C00) ----------------------------------------------------
__int64 __fastcall sub_80001C00(int a1, _BYTE *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  unsigned __int64 v9; // r28
  unsigned __int16 *v10; // r31
  void *v11; // r9
  void *v12; // r8
  void *v13; // r7
  void *v14; // r6
  __int64 v15; // r30
  void *v16; // r9
  void *v17; // r8
  void *v18; // r7
  void *v19; // r6
  void *v20; // r5
  __int64 v21; // r4
  void *v22; // r9
  void *v23; // r8
  void *v24; // r7
  void *v25; // r6
  __int64 v27; // [sp+70h] [-40h] BYREF
  unsigned __int16 *v28; // [sp+78h] [-38h]

  v9 = (unsigned __int64)a3;
  sub_80001E80(&v27, (void *)1, a3, a4, a5, a6, a7);
  v10 = v28;
  memset(v28, 0, 0x1000uLL);
  v15 = read((void *)a1, v10, (void *)0x10, v14, v13, v12, v11);
  if ( v15 > 0 )
  {
    if ( byte_C0000DE1 )
    {
      dbg_msg("syscon read data:\n", v15);
      sub_80001D7C((__int64)v10, v15);
    }
    if ( v9 > v10[6] )
      v9 = v10[6];
    memset(v10, 0, 0x1000uLL);
    v15 = read((void *)a1, v10, (void *)v9, v25, v24, v23, v22);
    if ( v15 > 0 )
      sub_80001EE0(a2, (char *)v10, v9);
    else
      dbg_msg("read failed body. (%d, %d)\n", v15, dword_C0000DE4);
  }
  else
  {
    dbg_msg("read failed header. (%d, %d)\n", v15, dword_C0000DE4);
  }
  sub_80001E38((__int64)&v27, v21, v20, v19, v18, v17, v16);
  return v15;
}
// 80001C5C: variable 'v14' is possibly undefined
// 80001C5C: variable 'v13' is possibly undefined
// 80001C5C: variable 'v12' is possibly undefined
// 80001C5C: variable 'v11' is possibly undefined
// 80001CCC: variable 'v25' is possibly undefined
// 80001CCC: variable 'v24' is possibly undefined
// 80001CCC: variable 'v23' is possibly undefined
// 80001CCC: variable 'v22' is possibly undefined
// 80001D0C: variable 'v21' is possibly undefined
// 80001D0C: variable 'v20' is possibly undefined
// 80001D0C: variable 'v19' is possibly undefined
// 80001D0C: variable 'v18' is possibly undefined
// 80001D0C: variable 'v17' is possibly undefined
// 80001D0C: variable 'v16' is possibly undefined
// C0000DE1: using guessed type char byte_C0000DE1;
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (0000000080001D38) ----------------------------------------------------
__int64 __fastcall sub_80001D38(__int64 a1)
{
  __int64 v2; // r11
  __int64 v3; // ctr
  __int64 v4; // r9
  __int64 v5; // r0
  __int16 v6; // r3

  v2 = 0LL;
  v3 = 6LL;
  v4 = 0LL;
  do
  {
    v5 = *(unsigned __int8 *)(v4 + a1);
    ++v4;
    v6 = v2 + v5;
    v2 += v5;
    --v3;
  }
  while ( v3 );
  return (unsigned __int16)(v6 + 0x8000);
}

//----- (0000000080001D6C) ----------------------------------------------------
__int64 __fastcall sub_80001D6C(__int64 a1)
{
  return (unsigned int)(*(_DWORD *)(a1 + 16) + 16);
}

//----- (0000000080001D7C) ----------------------------------------------------
__int64 __fastcall sub_80001D7C(__int64 a1, __int64 a2)
{
  __int64 v4; // r31
  __int64 v5; // r29
  __int64 v6; // r4

  v4 = 0LL;
  v5 = 0LL;
  while ( 1 )
  {
    v6 = v4;
    if ( v4 >= a2 )
      break;
    v5 = v4 % 32;
    if ( v4 == 32 * (v4 / 32) )
    {
      dbg_msg("%04x: %08x ", v4, *(unsigned int *)(v4 + a1));
    }
    else if ( v4 % 32 == 28 )
    {
      dbg_msg("%08x\n", *(unsigned int *)(v4 + a1));
    }
    else
    {
      dbg_msg("%08x ", *(unsigned int *)(v4 + a1));
    }
    v4 += 4LL;
  }
  if ( v5 <= 27 )
    dbg_msg("\n", v4);
  return dbg_msg("\n", v6);
}
// 80001E34: variable 'v6' is possibly undefined

//----- (0000000080001E38) ----------------------------------------------------
void *__fastcall sub_80001E38(__int64 a1, __int64 a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  void *result; // r3

  result = *(void **)(a1 + 8);
  if ( result )
  {
    result = (void *)unmap_pages(result, *(void **)a1, a3, a4, a5, a6, a7);
    *(_QWORD *)(a1 + 8) = 0LL;
  }
  return result;
}

//----- (0000000080001E80) ----------------------------------------------------
__int64 __fastcall sub_80001E80(_QWORD *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  _QWORD *v8; // r3
  __int64 result; // r3

  v8 = a1 + 1;
  *v8 = 0LL;
  *a1 = a2;
  result = map_pages(v8, a2, a3, a4, a5, a6, a7);
  if ( (_DWORD)result )
    result = dbg_msg("map_pages failed: this = %p, area_pages = %d\n", a1, *a1);
  return result;
}

//----- (0000000080001EE0) ----------------------------------------------------
_BYTE *__fastcall sub_80001EE0(_BYTE *result, char *_R4, unsigned __int64 a3)
{
  _BYTE *v3; // r11
  unsigned __int64 v4; // ctr
  unsigned __int64 v5; // r7
  unsigned __int64 v6; // ctr
  char v7; // r0
  __int64 v8; // ctr
  char *v9; // r4
  _BYTE *v10; // r11
  __int64 v12; // r0
  __int64 v13; // r9
  __int64 v14; // r12
  __int64 v15; // r10
  __int64 v16; // r8
  unsigned __int64 v17; // r7
  __int64 v19; // r9
  __int64 v20; // r12
  __int64 v21; // r10
  __int64 v22; // r8
  unsigned __int64 v23; // r7
  unsigned __int64 v24; // ctr
  unsigned __int64 i; // ctr
  __int64 v26; // ctr
  char v27; // r6
  __int64 v29; // r0
  unsigned __int64 v30; // r7
  __int64 v31; // r0
  __int64 v32; // r9
  __int64 v33; // r6
  __int64 v34; // r10
  __int64 v35; // r8
  unsigned __int64 v36; // r0
  __int64 v37; // r9
  __int64 v38; // r6
  __int64 v39; // r10
  __int64 v40; // r8
  __int64 v41; // r7
  unsigned __int64 v43; // ctr
  unsigned __int64 v44; // r7
  unsigned __int64 v46; // r12
  unsigned __int64 v47; // ctr
  unsigned __int64 v48; // r10
  unsigned __int64 v49; // r12
  unsigned __int64 v51; // ctr
  unsigned __int64 v52; // r12
  unsigned __int64 v54; // r10
  unsigned __int64 v55; // ctr
  unsigned __int64 v56; // r6
  unsigned __int64 v57; // r8
  __int64 v59; // r12
  unsigned __int64 v60; // ctr
  unsigned __int64 v61; // r12
  unsigned __int64 v63; // r6
  unsigned __int64 v64; // ctr
  unsigned __int64 v65; // r12
  unsigned __int64 v66; // r8
  bool v68; // cr61
  __int64 v70; // r8
  unsigned __int64 v71; // r6
  bool v72; // cr61
  __int64 v74; // r8
  __int64 v75; // r12
  __int64 v76; // r0

  v3 = result;
  if ( a3 <= 7 )
  {
    if ( !a3 )
      return result;
    goto LABEL_3;
  }
  __asm { dcbt      0, r4 }
  if ( ((unsigned __int16)_R4 & 0xFFFu) >= (unsigned __int64)((unsigned __int16)result & 0xFFF) )
  {
    _R10 = (_DWORD)_R4 + 128;
    __asm { dcbt      0, r10 }
    if ( ((unsigned __int8)_R4 & 7) != 0 )
    {
      v26 = 8LL - ((unsigned __int8)_R4 & 7);
      do
      {
        v27 = *_R4;
        --a3;
        ++_R4;
        *v3++ = v27;
        --v26;
      }
      while ( v26 );
    }
    if ( a3 )
    {
      v29 = (unsigned __int8)v3 & 3;
      switch ( v29 )
      {
        case 1LL:
          if ( a3 > 0xF )
          {
            v51 = a3 >> 4;
            do
            {
              v52 = *(_QWORD *)_R4;
              _R8 = (_DWORD)_R4 + 128;
              a3 -= 16LL;
              v54 = *((_QWORD *)_R4 + 1);
              _R4 += 16;
              __asm { dcbt      0, r8 }
              v3[15] = v54;
              *v3 = HIBYTE(v52);
              *(_DWORD *)(v3 + 7) = (v54 >> 40) | ((_DWORD)v52 << 24);
              *(_WORD *)(v3 + 1) = HIDWORD(v52) >> 8;
              *(_DWORD *)(v3 + 3) = v52 >> 8;
              *(_DWORD *)(v3 + 11) = v54 >> 8;
              v3 += 16;
              --v51;
            }
            while ( v51 );
          }
          goto LABEL_6;
        case 2LL:
          if ( a3 > 0xF )
          {
            v60 = a3 >> 4;
            do
            {
              v61 = *(_QWORD *)_R4;
              _R8 = (_DWORD)_R4 + 128;
              a3 -= 16LL;
              v63 = *((_QWORD *)_R4 + 1);
              _R4 += 16;
              __asm { dcbt      0, r8 }
              *((_WORD *)v3 + 7) = v63;
              *(_WORD *)v3 = HIWORD(v61);
              *(_DWORD *)(v3 + 6) = HIWORD(v63) | ((_DWORD)v61 << 16);
              *(_DWORD *)(v3 + 2) = v61 >> 16;
              *(_DWORD *)(v3 + 10) = v63 >> 16;
              v3 += 16;
              --v60;
            }
            while ( v60 );
          }
          goto LABEL_6;
        case 3LL:
          if ( a3 > 0xF )
          {
            v43 = a3 >> 4;
            do
            {
              v44 = *(_QWORD *)_R4;
              _R8 = (_DWORD)_R4 + 128;
              a3 -= 16LL;
              v46 = *((_QWORD *)_R4 + 1);
              _R4 += 16;
              __asm { dcbt      0, r8 }
              v3[15] = v46;
              *v3 = HIBYTE(v44);
              *(_DWORD *)(v3 + 5) = HIBYTE(v46) | ((_DWORD)v44 << 8);
              *(_DWORD *)(v3 + 1) = v44 >> 24;
              *(_DWORD *)(v3 + 9) = v46 >> 24;
              *(_WORD *)(v3 + 13) = (unsigned int)v46 >> 8;
              v3 += 16;
              --v43;
            }
            while ( v43 );
          }
          goto LABEL_6;
      }
      if ( ((unsigned __int8)v3 & 7) != 0 )
      {
        v72 = a3 > 0x17;
        while ( v72 )
        {
          _R6 = (_DWORD)_R4 + 256;
          a3 -= 24LL;
          v74 = *((_QWORD *)_R4 + 1);
          v75 = *((_QWORD *)_R4 + 2);
          v76 = HIDWORD(*(_QWORD *)_R4);
          __asm { dcbt      0, r6 }
          *((_DWORD *)v3 + 1) = *(_QWORD *)_R4;
          *(_DWORD *)v3 = v76;
          v72 = a3 > 0x17;
          *((_QWORD *)v3 + 1) = v74;
          _R4 += 24;
          *((_QWORD *)v3 + 2) = v75;
          v3 += 24;
        }
LABEL_6:
        if ( a3 )
        {
          v6 = a3;
          do
          {
            v7 = *_R4++;
            *v3++ = v7;
            --v6;
          }
          while ( v6 );
        }
        return result;
      }
      if ( a3 > 0x100 )
      {
        do
        {
          a3 -= 48LL;
          v30 = *(_QWORD *)_R4;
          v31 = *((_QWORD *)_R4 + 1);
          v32 = *((_QWORD *)_R4 + 2);
          v33 = *((_QWORD *)_R4 + 3);
          v34 = *((_QWORD *)_R4 + 4);
          v35 = *((_QWORD *)_R4 + 5);
          _R4 += 48;
          *(_QWORD *)v3 = v30;
          *((_QWORD *)v3 + 1) = v31;
          *((_QWORD *)v3 + 2) = v32;
          *((_QWORD *)v3 + 3) = v33;
          *((_QWORD *)v3 + 4) = v34;
          *((_QWORD *)v3 + 5) = v35;
          v3 += 48;
          if ( a3 <= 0x2F )
            break;
          v36 = *(_QWORD *)_R4;
          a3 -= 48LL;
          v37 = *((_QWORD *)_R4 + 1);
          v38 = *((_QWORD *)_R4 + 2);
          v39 = *((_QWORD *)_R4 + 3);
          v40 = *((_QWORD *)_R4 + 4);
          v41 = *((_QWORD *)_R4 + 5);
          _R4 += 48;
          *(_QWORD *)v3 = v36;
          *((_QWORD *)v3 + 1) = v37;
          _R12 = (_DWORD)_R4 + 256;
          *((_QWORD *)v3 + 2) = v38;
          *((_QWORD *)v3 + 3) = v39;
          *((_QWORD *)v3 + 4) = v40;
          *((_QWORD *)v3 + 5) = v41;
          v3 += 48;
          __asm { dcbt      0, r12 }
        }
        while ( a3 > 0x2F );
      }
LABEL_3:
      if ( a3 > 0xF )
      {
        v4 = a3 >> 3;
        do
        {
          v5 = *(_QWORD *)_R4;
          a3 -= 8LL;
          _R4 += 8;
          *(_QWORD *)v3 = v5;
          v3 += 8;
          --v4;
        }
        while ( v4 );
      }
      goto LABEL_6;
    }
  }
  else
  {
    v9 = &_R4[a3];
    v10 = &result[a3];
    _R10 = (_DWORD)v9 - 128;
    __asm { dcbt      0, r10 }
    if ( ((unsigned __int8)v9 & 7) != 0 )
    {
      v8 = (unsigned __int8)v9 & 7;
      do
      {
        --v9;
        --a3;
        *--v10 = *v9;
        --v8;
      }
      while ( v8 );
    }
    if ( a3 )
    {
      v12 = (unsigned __int8)v10 & 3;
      switch ( v12 )
      {
        case 1LL:
          if ( a3 > 0xF )
          {
            v55 = a3 >> 4;
            do
            {
              v9 -= 16;
              v10 -= 16;
              a3 -= 16LL;
              v56 = *(_QWORD *)v9;
              v57 = *((_QWORD *)v9 + 1);
              _R10 = (_DWORD)v9 - 128;
              v59 = *(_QWORD *)v9 << 24;
              v10[15] = v57;
              __asm { dcbt      0, r10 }
              *v10 = HIBYTE(v56);
              *(_DWORD *)(v10 + 7) = (v57 >> 40) | v59;
              *(_DWORD *)(v10 + 11) = v57 >> 8;
              *(_DWORD *)(v10 + 3) = v56 >> 8;
              *(_WORD *)(v10 + 1) = HIDWORD(v56) >> 8;
              --v55;
            }
            while ( v55 );
          }
          break;
        case 2LL:
          if ( a3 > 0xF )
          {
            v64 = a3 >> 4;
            do
            {
              v9 -= 16;
              v10 -= 16;
              a3 -= 16LL;
              v65 = *((_QWORD *)v9 + 1);
              v66 = *(_QWORD *)v9;
              _R10 = (_DWORD)v9 - 128;
              *((_WORD *)v10 + 7) = v65;
              __asm { dcbt      0, r10 }
              *(_WORD *)v10 = HIWORD(v66);
              *(_DWORD *)(v10 + 6) = HIWORD(v65) | ((_DWORD)v66 << 16);
              *(_DWORD *)(v10 + 10) = v65 >> 16;
              *(_DWORD *)(v10 + 2) = v66 >> 16;
              --v64;
            }
            while ( v64 );
          }
          break;
        case 3LL:
          if ( a3 > 0xF )
          {
            v47 = a3 >> 4;
            do
            {
              v9 -= 16;
              v10 -= 16;
              a3 -= 16LL;
              v48 = *((_QWORD *)v9 + 1);
              v49 = *(_QWORD *)v9;
              _R8 = (_DWORD)v9 - 128;
              v10[15] = v48;
              __asm { dcbt      0, r8 }
              *v10 = HIBYTE(v49);
              *(_DWORD *)(v10 + 5) = HIBYTE(v48) | ((_DWORD)v49 << 8);
              *(_WORD *)(v10 + 13) = (unsigned int)v48 >> 8;
              *(_DWORD *)(v10 + 9) = v48 >> 24;
              *(_DWORD *)(v10 + 1) = v49 >> 24;
              --v47;
            }
            while ( v47 );
          }
          break;
        default:
          if ( ((unsigned __int8)v10 & 7) != 0 )
          {
            v68 = a3 > 0x17;
            while ( v68 )
            {
              v9 -= 24;
              a3 -= 24LL;
              v10 -= 24;
              v68 = a3 > 0x17;
              _R12 = (_DWORD)v9 - 256;
              v70 = *((_QWORD *)v9 + 1);
              v71 = *(_QWORD *)v9;
              __asm { dcbt      0, r12 }
              *((_QWORD *)v10 + 2) = *((_QWORD *)v9 + 2);
              *((_DWORD *)v10 + 2) = HIDWORD(v70);
              *(_DWORD *)v10 = HIDWORD(v71);
              *((_DWORD *)v10 + 3) = v70;
              *((_DWORD *)v10 + 1) = v71;
            }
          }
          else
          {
            while ( a3 > 0x2F )
            {
              v9 -= 48;
              a3 -= 48LL;
              v10 -= 48;
              v13 = *((_QWORD *)v9 + 4);
              v14 = *((_QWORD *)v9 + 3);
              v15 = *((_QWORD *)v9 + 2);
              v16 = *((_QWORD *)v9 + 1);
              v17 = *(_QWORD *)v9;
              *((_QWORD *)v10 + 5) = *((_QWORD *)v9 + 5);
              *((_QWORD *)v10 + 4) = v13;
              *((_QWORD *)v10 + 3) = v14;
              *((_QWORD *)v10 + 2) = v15;
              *((_QWORD *)v10 + 1) = v16;
              *(_QWORD *)v10 = v17;
              if ( a3 <= 0x2F )
                break;
              v9 -= 48;
              v10 -= 48;
              a3 -= 48LL;
              _R6 = (_DWORD)v9 - 256;
              v19 = *((_QWORD *)v9 + 4);
              v20 = *((_QWORD *)v9 + 3);
              v21 = *((_QWORD *)v9 + 2);
              v22 = *((_QWORD *)v9 + 1);
              v23 = *(_QWORD *)v9;
              *((_QWORD *)v10 + 5) = *((_QWORD *)v9 + 5);
              *((_QWORD *)v10 + 4) = v19;
              *((_QWORD *)v10 + 3) = v20;
              *((_QWORD *)v10 + 2) = v21;
              *((_QWORD *)v10 + 1) = v22;
              *(_QWORD *)v10 = v23;
              __asm { dcbt      0, r6 }
            }
            if ( a3 > 7 )
            {
              v24 = a3 >> 3;
              do
              {
                v9 -= 8;
                a3 -= 8LL;
                v10 -= 8;
                *(_QWORD *)v10 = *(_QWORD *)v9;
                --v24;
              }
              while ( v24 );
            }
          }
          break;
      }
      for ( i = a3; i; --i )
        *--v10 = *--v9;
    }
  }
  return result;
}

//----- (000000008000249C) ----------------------------------------------------
__int64 __fastcall sub_8000249C(unsigned __int8 *a1, _BYTE *a2, __int64 a3)
{
  __int64 v3; // ctr
  int v4; // r11
  int v5; // r9
  __int64 result; // r3

  v3 = a3;
  if ( !a3 )
  {
LABEL_7:
    LODWORD(result) = 0;
    return (int)result;
  }
  v4 = (unsigned __int8)*a2;
  v5 = *a1;
  if ( v5 == v4 )
  {
    while ( *a2 )
    {
      if ( !--v3 )
        break;
      v4 = (unsigned __int8)*++a2;
      v5 = *++a1;
      if ( v5 != v4 )
        goto LABEL_9;
    }
    goto LABEL_7;
  }
LABEL_9:
  LODWORD(result) = -1;
  if ( (unsigned __int8)v5 < (unsigned int)(unsigned __int8)v4 )
    return (int)result;
  return 1LL;
}

//----- (0000000080002510) ----------------------------------------------------
unsigned __int64 *__fastcall sub_80002510(__int64 a1, unsigned __int64 a2)
{
  unsigned __int64 *result; // r3

  result = (unsigned __int64 *)(a1 + 872);
  do
  {
    if ( *result <= a2 && *result + result[1] > a2 )
      break;
    result = (unsigned __int64 *)result[2];
  }
  while ( result );
  return result;
}

//----- (0000000080002540) ----------------------------------------------------
_QWORD *__fastcall sub_80002540(_QWORD *result, __int64 a2, __int64 a3)
{
  __int64 v4; // r5
  __int64 v5; // r0
  __int64 v6; // r9
  __int64 v7; // r11

  v4 = 0LL;
  v5 = 0LL;
  if ( (a2 & 7) != 0 )
  {
    v4 = (8 - (a2 & 7)) & 7;
    v5 = v4;
  }
  v6 = a2 + v5;
  v7 = a3 - v4;
  result[2] = v7;
  *(_QWORD *)(v6 + 8) = v7 | 1;
  result[5] = a2 + v5;
  *(_QWORD *)(v6 + v7 + 8) = 72LL;
  result[6] = qword_C0000E08;
  return result;
}
// C0000E08: using guessed type __int64 qword_C0000E08;

//----- (0000000080002598) ----------------------------------------------------
void sub_80002598()
{
  if ( !qword_C0000DF0 )
  {
    qword_C0000DE8 = 1482184792LL;
    qword_C0000DF8 = 4096LL;
    qword_C0000E00 = 0xFFFFFFFFLL;
    qword_C0000E08 = 0x200000LL;
    dword_C0000E10 = qword_C0000DF0;
    qword_C0000DF0 = 4096LL;
  }
}
// C0000DE8: using guessed type __int64 qword_C0000DE8;
// C0000DF0: using guessed type __int64 qword_C0000DF0;
// C0000DF8: using guessed type __int64 qword_C0000DF8;
// C0000E00: using guessed type __int64 qword_C0000E00;
// C0000E08: using guessed type __int64 qword_C0000E08;
// C0000E10: using guessed type int dword_C0000E10;

//----- (00000000800025DC) ----------------------------------------------------
__int64 __fastcall sub_800025DC(_QWORD *a1, unsigned __int64 a2)
{
  unsigned __int64 v3; // r4
  unsigned __int64 v4; // r9
  __int64 result; // r3
  int v6; // r29
  unsigned __int64 v7; // r28
  unsigned __int64 *v8; // r27
  void *v9; // r8
  void *v10; // r7
  void *v11; // r6
  void *v12; // r5
  void *v13; // r4
  void *v14; // r8
  void *v15; // r7
  void *v16; // r6
  void *v17; // r5
  void *v18; // r4
  __int64 v19; // r3
  unsigned __int64 v20; // r30
  __int64 v21; // r29
  void *v22; // r8
  void *v23; // r7
  void *v24; // r6
  void *v25; // r5
  void *v26; // r4
  unsigned __int64 v27; // r3
  unsigned __int64 v28; // r30
  __int64 v29; // r4
  __int64 v30; // r5

  if ( a2 > 0xFFFFFFFFFFFFFF7FLL || !a1[5] )
    return 0LL;
  v3 = a2 + 72;
  v4 = a1[2];
  if ( v3 >= v4 )
    goto LABEL_4;
  v6 = qword_C0000DF8;
  v7 = qword_C0000DF8 * ((qword_C0000DF8 + v4 - v3 - 1) / qword_C0000DF8 - 1);
  v8 = sub_80002510((__int64)a1, a1[5]);
  if ( v7 > 0x7FFFFFFFFFFFFFFELL )
    LODWORD(v7) = -v6;
  v19 = sub_800048E4(0, v13, v12, v11, v10, v9);
  v20 = *v8 + v8[1];
  if ( v20 == v19
    && (v21 = sub_800048E4(-(int)v7, v18, v17, v16, v15, v14), v27 = sub_800048E4(0, v26, v25, v24, v23, v22), v21 != -1)
    && v20 > v27
    && (v28 = v20 - v27) != 0 )
  {
    v29 = a1[5];
    v8[1] -= v28;
    v30 = a1[2] - v28;
    a1[106] -= v28;
    sub_80002540(a1, v29, v30);
    LODWORD(result) = v28 != 0;
  }
  else
  {
LABEL_4:
    LODWORD(result) = 0;
    a1[6] = -1LL;
  }
  return (int)result;
}
// 800026E0: variable 'v13' is possibly undefined
// 800026E0: variable 'v12' is possibly undefined
// 800026E0: variable 'v11' is possibly undefined
// 800026E0: variable 'v10' is possibly undefined
// 800026E0: variable 'v9' is possibly undefined
// 80002700: variable 'v18' is possibly undefined
// 80002700: variable 'v17' is possibly undefined
// 80002700: variable 'v16' is possibly undefined
// 80002700: variable 'v15' is possibly undefined
// 80002700: variable 'v14' is possibly undefined
// 8000270C: variable 'v26' is possibly undefined
// 8000270C: variable 'v25' is possibly undefined
// 8000270C: variable 'v24' is possibly undefined
// 8000270C: variable 'v23' is possibly undefined
// 8000270C: variable 'v22' is possibly undefined
// C0000DF8: using guessed type __int64 qword_C0000DF8;

//----- (0000000080002760) ----------------------------------------------------
unsigned __int64 __fastcall sub_80002760(unsigned __int64 result)
{
  __int64 v1; // r7
  unsigned __int64 v2; // r5
  unsigned __int64 v3; // r9
  unsigned __int64 v4; // r12
  unsigned __int64 v5; // r4
  __int64 v6; // r9
  __int64 v7; // r11
  unsigned __int64 v8; // r9
  __int64 v9; // t0
  int v10; // r9
  char *v11; // r11
  unsigned __int64 v12; // r10
  unsigned __int64 v13; // r0
  _QWORD *v14; // r10
  unsigned __int64 v15; // r6
  unsigned __int64 v16; // r9
  __int64 v17; // r8
  __int64 v18; // r9
  unsigned __int64 v19; // r0
  unsigned __int64 v20; // r9
  unsigned __int64 v21; // r9
  unsigned __int64 v22; // r11
  unsigned __int64 v23; // r10
  unsigned __int64 v24; // r9
  __int64 *v25; // r11
  __int64 v26; // r9
  int v27; // r6
  int v28; // r10
  _QWORD *v29; // r10
  unsigned __int64 v30; // r7
  unsigned __int64 v31; // r9
  __int64 v32; // r8
  __int64 v33; // r9
  unsigned __int64 v34; // r0
  unsigned __int64 v35; // r9
  unsigned __int64 v36; // r9
  unsigned __int64 v37; // r8
  unsigned __int64 v38; // r11
  __int64 v39; // r0
  _QWORD *v40; // r8
  _QWORD *v41; // r9
  unsigned __int64 v42; // r11
  char v43; // r0
  unsigned __int64 v44; // r10
  __int64 v45; // r9
  __int64 *v46; // r8
  __int64 v47; // r9
  __int64 v48; // r9
  unsigned __int64 v49; // r10
  __int64 v50; // r10
  int v51; // r9
  __int64 v52; // r0
  int v53; // r9
  __int64 v54; // r11
  __int64 v55; // r9
  __int64 v56; // r9
  __int64 v57; // r0
  unsigned __int64 v58; // r9
  _QWORD *v59; // r8
  _QWORD *v60; // r9

  if ( !result )
    return result;
  v1 = result - 16;
  v2 = result - 16;
  if ( qword_C0000E30 > result - 16 )
    goto LABEL_15;
  v3 = *(_QWORD *)(v1 + 8);
  if ( ((v3 >> 1) & 1) == 0 )
    goto LABEL_15;
  v4 = *(_QWORD *)(v1 + 8) & 0xFFFFFFFCLL;
  v5 = v1 + v4;
  if ( (v3 & 1) != 0 )
    goto LABEL_5;
  result = *(_QWORD *)(result - 16);
  v2 = v1 - result;
  if ( qword_C0000E30 > v1 - result )
    goto LABEL_15;
  v4 += result;
  if ( qword_C0000E38 == v2 )
  {
    v47 = *(_QWORD *)(v5 + 8);
    if ( (v47 & 3) == 3 )
    {
      qword_C0000E20 = v4;
      *(_QWORD *)(v5 + 8) = (unsigned int)v47 & 0xFFFFFFFE;
      *(_QWORD *)(v2 + v4) = v4;
      *(_QWORD *)(v2 + 8) = v4 | 1;
      return result;
    }
    goto LABEL_81;
  }
  result >>= 3;
  if ( result <= 0x1F )
  {
    v22 = *(_QWORD *)(v2 + 16);
    v23 = *(_QWORD *)(v2 + 24);
    if ( v22 == v23 )
    {
      v1 = v2;
      dword_C0000E18 &= __ROL4__(-2, result);
    }
    else
    {
      result = (unsigned __int64)&unk_C0000E58 + ((16 * result) & 0x7FFFFFFF0LL);
      if ( v22 != result && qword_C0000E30 > v22 || v23 != result && qword_C0000E30 > v23 )
        goto LABEL_15;
      v1 = v2;
      *(_QWORD *)(v23 + 16) = v22;
      *(_QWORD *)(v22 + 24) = v23;
    }
    goto LABEL_5;
  }
  v29 = *(_QWORD **)(v2 + 24);
  v30 = *(_QWORD *)(v2 + 48);
  if ( (_QWORD *)v2 != v29 )
  {
    v31 = *(_QWORD *)(v2 + 16);
    if ( qword_C0000E30 > v31 )
      goto LABEL_15;
    v29[2] = v31;
    *(_QWORD *)(v31 + 24) = v29;
    goto LABEL_51;
  }
  v29 = *(_QWORD **)(v2 + 40);
  v40 = (_QWORD *)(v2 + 40);
  if ( !v29 )
  {
    v29 = *(_QWORD **)(v2 + 32);
    v40 = (_QWORD *)(v2 + 32);
    if ( !v29 )
      goto LABEL_51;
  }
  while ( 1 )
  {
    v41 = v29 + 5;
    if ( v29[5] )
      goto LABEL_76;
    if ( !v29[4] )
      break;
    v41 = v29 + 4;
LABEL_76:
    v40 = v41;
    v29 = (_QWORD *)*v41;
  }
  if ( qword_C0000E30 > (unsigned __int64)v40 )
    goto LABEL_15;
  *v40 = 0LL;
LABEL_51:
  if ( !v30 )
    goto LABEL_81;
  v32 = *(unsigned int *)(v2 + 56);
  v33 = (8 * v32) & 0x7FFFFFFF8LL;
  if ( *(__int64 *)((char *)&qword_C0001068 + v33) != v2 )
  {
    if ( qword_C0000E30 > v30 )
      goto LABEL_15;
    if ( *(_QWORD *)(v30 + 32) == v2 )
      *(_QWORD *)(v30 + 32) = v29;
    else
      *(_QWORD *)(v30 + 40) = v29;
    if ( v29 )
    {
LABEL_57:
      v34 = qword_C0000E30;
      if ( qword_C0000E30 > (unsigned __int64)v29 )
        goto LABEL_15;
      v35 = *(_QWORD *)(v2 + 32);
      v29[6] = v30;
      if ( v35 )
      {
        if ( v34 > v35 )
          goto LABEL_15;
        *(_QWORD *)(v35 + 48) = v29;
        v29[4] = v35;
      }
      v36 = *(_QWORD *)(v2 + 40);
      if ( v36 )
      {
        if ( qword_C0000E30 > v36 )
          goto LABEL_15;
        v1 = v2;
        *(_QWORD *)(v36 + 48) = v29;
        v29[5] = v36;
        goto LABEL_5;
      }
    }
LABEL_81:
    v1 = v2;
    goto LABEL_5;
  }
  *(__int64 *)((char *)&qword_C0001068 + v33) = (__int64)v29;
  if ( v29 )
    goto LABEL_57;
  v1 = v2;
  dword_C0000E1C &= __ROL4__(-2, v32);
LABEL_5:
  if ( v5 <= v2 )
    goto LABEL_15;
  v6 = *(_QWORD *)(v5 + 8);
  if ( (v6 & 1) == 0 )
    goto LABEL_15;
  v7 = *(_QWORD *)(v5 + 8) & 2LL;
  if ( (v6 & 2) != 0 )
  {
    *(_QWORD *)(v5 + 8) &= 0xFFFFFFFEuLL;
    *(_QWORD *)(v2 + v4) = v4;
    *(_QWORD *)(v1 + 8) = v4 | 1;
LABEL_9:
    v8 = v4 >> 3;
    if ( v4 >> 3 > 0x1F )
    {
      v24 = v4 >> 8;
      if ( v4 >> 8 )
      {
        if ( v24 <= 0xFFFF )
        {
          v50 = __ROL4__(v24 - 256, 16) & 8LL;
          v51 = (_DWORD)v24 << v50;
          v52 = __ROL4__(v51 - 4096, 16) & 4LL;
          v53 = v51 << v52;
          v54 = __ROL4__(v53 - 0x4000, 16) & 2LL;
          v55 = (unsigned int)(v53 << v54);
          LODWORD(v55) = (unsigned int)v55 >> 15;
          v56 = v55 - (v50 + v52 + v54);
          LOBYTE(v52) = v56 + 21;
          v56 += 14LL;
          LODWORD(v56) = 2 * v56;
          v26 = v56 + ((v4 >> v52) & 1);
          v27 = 1 << v26;
          v25 = (__int64 *)((char *)&qword_C0001068 + ((8 * v26) & 0x7FFFFFFF8LL));
        }
        else
        {
          v25 = (__int64 *)&unk_C0001160;
          LODWORD(v26) = 31;
          v27 = 0x80000000;
        }
      }
      else
      {
        v25 = &qword_C0001068;
        LODWORD(v26) = 0;
        v27 = 1;
      }
      *(_DWORD *)(v1 + 56) = v26;
      v28 = dword_C0000E1C;
      *(_QWORD *)(v1 + 32) = 0LL;
      *(_QWORD *)(v1 + 40) = 0LL;
      if ( (v28 & v27) != 0 )
      {
        v42 = *v25;
        v43 = 0;
        if ( (_DWORD)v26 != 31 )
          v43 = 57 - ((unsigned int)v26 >> 1);
        v44 = v4 << v43;
        while ( (*(_QWORD *)(v42 + 8) & 0xFFFFFFFCLL) != v4 )
        {
          v45 = 8 * (v44 >> 63) + 32;
          v46 = (__int64 *)(v42 + v45);
          if ( !*(_QWORD *)(v42 + v45) )
          {
            if ( qword_C0000E30 > (unsigned __int64)v46 )
              goto LABEL_15;
            *v46 = v1;
            *(_QWORD *)(v1 + 48) = v42;
            *(_QWORD *)(v1 + 16) = v1;
            *(_QWORD *)(v1 + 24) = v1;
            return result;
          }
          v44 *= 2LL;
          v42 = *(_QWORD *)(v42 + v45);
        }
        v58 = *(_QWORD *)(v42 + 16);
        if ( qword_C0000E30 > v42 || qword_C0000E30 > v58 )
          goto LABEL_15;
        *(_QWORD *)(v58 + 24) = v1;
        *(_QWORD *)(v42 + 16) = v1;
        *(_QWORD *)(v1 + 48) = 0LL;
        *(_QWORD *)(v1 + 24) = v42;
        *(_QWORD *)(v1 + 16) = v58;
      }
      else
      {
        *v25 = v1;
        dword_C0000E1C = v28 | v27;
        *(_QWORD *)(v1 + 48) = v25;
        *(_QWORD *)(v1 + 16) = v1;
        *(_QWORD *)(v1 + 24) = v1;
      }
    }
    else
    {
      v9 = __ROL8__(v8, 4);
      v10 = 1 << v8;
      v11 = (char *)&unk_C0000E58 + (v9 & 0x7FFFFFFF0LL);
      if ( (dword_C0000E18 & v10) != 0 )
      {
        v12 = *((_QWORD *)v11 + 2);
        if ( qword_C0000E30 > v12 )
          goto LABEL_15;
      }
      else
      {
        v12 = (unsigned __int64)v11;
        dword_C0000E18 |= v10;
      }
      *((_QWORD *)v11 + 2) = v1;
      *(_QWORD *)(v12 + 24) = v1;
      *(_QWORD *)(v1 + 16) = v12;
      *(_QWORD *)(v1 + 24) = v11;
    }
    return result;
  }
LABEL_16:
  if ( qword_C0000E40 == v5 )
  {
    v48 = qword_C0000E38;
    v49 = v4 + qword_C0000E28;
    qword_C0000E28 = v49;
    qword_C0000E40 = v1;
    *(_QWORD *)(v1 + 8) = v49 | 1;
    if ( v48 == v1 )
    {
      qword_C0000E20 = v7;
      qword_C0000E38 = v7;
    }
    if ( qword_C0000E48 < v49 )
      result = sub_800025DC(&dword_C0000E18, 0LL);
    return result;
  }
  if ( qword_C0000E38 == v5 )
  {
    qword_C0000E38 = v1;
    v57 = v4 + qword_C0000E20;
    qword_C0000E20 = v57;
    *(_QWORD *)(v1 + 8) = v57 | 1;
    *(_QWORD *)(v2 + v57) = v57;
    return result;
  }
  result = (unsigned int)v6 & 0xFFFFFFFC;
  v13 = result >> 3;
  if ( result >> 3 <= 0x1F )
  {
    v37 = *(_QWORD *)(v5 + 24);
    v38 = *(_QWORD *)(v5 + 16);
    if ( v38 == v37 )
    {
      dword_C0000E18 &= __ROL4__(-2, v13);
    }
    else
    {
      if ( (_UNKNOWN *)v38 != (_UNKNOWN *)((char *)&unk_C0000E58 + ((16 * v13) & 0x1FFFFFFF0LL)) && qword_C0000E30 > v38
        || (_UNKNOWN *)v37 != (_UNKNOWN *)((char *)&unk_C0000E58 + ((16 * v13) & 0x1FFFFFFF0LL)) && qword_C0000E30 > v37 )
      {
        goto LABEL_15;
      }
      *(_QWORD *)(v37 + 16) = v38;
      *(_QWORD *)(v38 + 24) = v37;
    }
    goto LABEL_72;
  }
  v14 = *(_QWORD **)(v5 + 24);
  v15 = *(_QWORD *)(v5 + 48);
  if ( (_QWORD *)v5 != v14 )
  {
    v16 = *(_QWORD *)(v5 + 16);
    if ( qword_C0000E30 <= v16 )
    {
      v14[2] = v16;
      *(_QWORD *)(v16 + 24) = v14;
      goto LABEL_22;
    }
    goto LABEL_15;
  }
  v14 = *(_QWORD **)(v5 + 40);
  v59 = (_QWORD *)(v5 + 40);
  if ( v14 || (v14 = *(_QWORD **)(v5 + 32), v59 = (_QWORD *)(v5 + 32), v14) )
  {
    while ( 1 )
    {
      v60 = v14 + 5;
      if ( !v14[5] )
      {
        if ( !v14[4] )
        {
          if ( qword_C0000E30 <= (unsigned __int64)v59 )
          {
            *v59 = 0LL;
            break;
          }
LABEL_15:
          result = sub_80005988();
          goto LABEL_16;
        }
        v60 = v14 + 4;
      }
      v59 = v60;
      v14 = (_QWORD *)*v60;
    }
  }
LABEL_22:
  if ( !v15 )
    goto LABEL_72;
  v17 = *(unsigned int *)(v5 + 56);
  v18 = (8 * v17) & 0x7FFFFFFF8LL;
  if ( *(__int64 *)((char *)&qword_C0001068 + v18) == v5 )
  {
    *(__int64 *)((char *)&qword_C0001068 + v18) = (__int64)v14;
    if ( !v14 )
    {
      dword_C0000E1C &= __ROL4__(-2, v17);
      goto LABEL_72;
    }
  }
  else
  {
    if ( qword_C0000E30 > v15 )
      goto LABEL_15;
    if ( *(_QWORD *)(v15 + 32) == v5 )
      *(_QWORD *)(v15 + 32) = v14;
    else
      *(_QWORD *)(v15 + 40) = v14;
    if ( !v14 )
      goto LABEL_72;
  }
  v19 = qword_C0000E30;
  if ( qword_C0000E30 > (unsigned __int64)v14 )
    goto LABEL_15;
  v20 = *(_QWORD *)(v5 + 32);
  v14[6] = v15;
  if ( v20 )
  {
    if ( v19 > v20 )
      goto LABEL_15;
    *(_QWORD *)(v20 + 48) = v14;
    v14[4] = v20;
  }
  v21 = *(_QWORD *)(v5 + 40);
  if ( v21 )
  {
    if ( qword_C0000E30 > v21 )
      goto LABEL_15;
    *(_QWORD *)(v21 + 48) = v14;
    v14[5] = v21;
  }
LABEL_72:
  v4 += result;
  v39 = qword_C0000E38;
  *(_QWORD *)(v2 + v4) = v4;
  *(_QWORD *)(v1 + 8) = v4 | 1;
  if ( v39 != v1 )
    goto LABEL_9;
  qword_C0000E20 = v4;
  return result;
}
// 8000282C: variable 'v1' is possibly undefined
// 8000286C: variable 'v5' is possibly undefined
// 8000287C: variable 'v6' is possibly undefined
// 80002B58: variable 'v4' is possibly undefined
// 80002B68: variable 'v2' is possibly undefined
// 80002E84: variable 'v7' is possibly undefined
// C0000E18: using guessed type int dword_C0000E18;
// C0000E1C: using guessed type int dword_C0000E1C;
// C0000E20: using guessed type __int64 qword_C0000E20;
// C0000E28: using guessed type __int64 qword_C0000E28;
// C0000E30: using guessed type __int64 qword_C0000E30;
// C0000E38: using guessed type __int64 qword_C0000E38;
// C0000E40: using guessed type __int64 qword_C0000E40;
// C0000E48: using guessed type __int64 qword_C0000E48;
// C0001068: using guessed type __int64 qword_C0001068;

//----- (0000000080002EC0) ----------------------------------------------------
// r3 = size,
__int64 __fastcall malloc(unsigned __int64 a1)
{
  unsigned __int64 v1; // r31
  __int64 v2; // r9
  unsigned __int64 v3; // r10
  int v4; // r6
  int v5; // r11
  __int64 v6; // r9
  __int64 v7; // r0
  __int64 v8; // r9
  __int64 v9; // r0
  __int64 v10; // r11
  __int64 v11; // r10
  __int64 v12; // r0
  __int64 v13; // r11
  unsigned __int64 v14; // r9
  char *v15; // r11
  __int64 v16; // r3
  unsigned __int64 v17; // r10
  int v18; // r0
  __int64 v19; // r9
  __int64 v20; // r11
  __int64 v21; // r9
  __int64 result; // r3
  __int64 v23; // r0
  __int64 v24; // r9
  unsigned __int64 v25; // r0
  unsigned __int64 v26; // r7
  unsigned int v27; // r3
  __int64 v28; // r9
  unsigned __int64 v29; // r10
  unsigned __int64 v30; // r5
  char v31; // r9
  _QWORD *v32; // r11
  unsigned __int64 v33; // r8
  _QWORD *v34; // r6
  unsigned __int64 v35; // r0
  int v36; // r7
  char *v37; // r9
  __int64 v38; // r8
  unsigned __int64 v39; // r10
  unsigned __int64 v40; // r10
  __int64 v41; // r3
  __int64 v42; // r10
  __int64 v43; // r0
  __int64 v44; // r9
  void *v45; // r8
  void *v46; // r7
  void *v47; // r6
  void *v48; // r5
  void *v49; // r4
  unsigned __int64 *v50; // r26
  unsigned __int64 v51; // r27
  unsigned __int64 v52; // r3
  __int64 v53; // r3
  _QWORD *v54; // r11
  unsigned __int64 v55; // r4
  unsigned __int64 v56; // r9
  unsigned int v57; // r10
  __int64 v58; // r9
  unsigned __int64 v59; // r0
  unsigned __int64 v60; // r9
  unsigned __int64 v61; // r9
  unsigned int v62; // r9
  __int64 v63; // r11
  unsigned int v64; // r9
  __int64 v65; // r0
  unsigned int v66; // r9
  __int64 v67; // r10
  unsigned int v68; // r9
  __int64 v69; // r11
  __int64 v70; // r0
  unsigned __int64 v71; // r7
  unsigned __int64 v72; // r11
  unsigned __int64 v73; // r9
  unsigned __int64 v74; // r8
  unsigned __int64 v75; // r6
  __int64 v76; // r4
  _QWORD *v77; // r11
  unsigned __int64 v78; // r5
  unsigned __int64 v79; // r9
  unsigned int v80; // r10
  __int64 v81; // r9
  unsigned __int64 v82; // r0
  unsigned __int64 v83; // r9
  unsigned __int64 v84; // r9
  unsigned int v85; // r10
  int v86; // r9
  unsigned int v87; // r0
  unsigned int v88; // r9
  unsigned __int64 v89; // r0
  unsigned int v90; // r9
  __int64 v91; // r11
  unsigned int v92; // r9
  __int64 v93; // r0
  unsigned int v94; // r9
  __int64 v95; // r10
  unsigned int v96; // r9
  __int64 v97; // r11
  __int64 v98; // r0
  __int64 v99; // r7
  __int64 v100; // r10
  int v101; // r8
  char *v102; // r9
  int v103; // r0
  char *v104; // r8
  unsigned __int64 v105; // r29
  void *v106; // r8
  void *v107; // r7
  void *v108; // r6
  void *v109; // r5
  void *v110; // r4
  unsigned __int64 v111; // r3
  unsigned __int64 v112; // r28
  unsigned __int64 v113; // r0
  __int64 *v114; // r11
  __int64 v115; // r10
  __int64 *v116; // r10
  __int64 v117; // r9
  __int64 v118; // r24
  unsigned __int64 *v119; // r3
  __int64 v120; // r10
  unsigned __int64 v121; // r25
  unsigned __int64 v122; // r29
  __int64 v123; // r26
  __int64 v124; // r9
  _QWORD *v125; // r11
  unsigned __int64 v126; // r29
  unsigned __int64 v127; // r10
  char *v128; // r9
  char *v129; // r11
  int v130; // r0
  __int64 v131; // r11
  char *v132; // r9
  char *v133; // r10
  int v134; // r0
  char *v135; // r9
  char *v136; // r11
  __int64 v137; // r3
  unsigned __int64 v138; // r29
  unsigned __int64 v139; // r3
  _QWORD *v140; // r0
  _QWORD *v141; // r10
  _QWORD *v142; // r9
  _QWORD *v143; // r8
  _QWORD *v144; // r9
  __int64 v145; // r3
  unsigned __int64 v146; // r0
  unsigned int v147; // r8
  __int64 v148; // r9
  int v149; // r11
  unsigned int v150; // r10
  int v151; // r9
  unsigned int v152; // r0
  unsigned int v153; // r9
  int v154; // r9
  __int64 v155; // r0
  int v156; // r10
  __int64 v157; // r9
  unsigned __int64 v158; // r10
  char v159; // r0
  unsigned __int64 v160; // r11
  __int64 v161; // r9
  __int64 *v162; // r8
  __int64 v163; // r0
  unsigned __int64 v164; // r0
  unsigned __int64 v165; // r4
  __int64 v166; // r0
  __int64 v167; // r6
  __int64 v168; // r0
  unsigned __int64 v169; // r5
  __int64 v170; // r3
  __int64 v171; // r9
  unsigned __int64 v172; // r0
  unsigned __int64 v173; // r11
  unsigned __int64 v174; // r10
  int v175; // r0
  char *v176; // r9
  char *v177; // r10
  __int64 v178; // r4
  unsigned __int64 v179; // r0
  unsigned int v180; // r10
  __int64 v181; // r9
  int v182; // r11
  unsigned int v183; // r10
  int v184; // r9
  unsigned int v185; // r0
  unsigned int v186; // r9
  int v187; // r9
  __int64 v188; // r0
  int v189; // r8
  __int64 v190; // r9
  __int64 v191; // r11
  __int64 v192; // ctr
  __int64 v193; // t0
  char *v194; // r9
  unsigned __int64 v195; // r9
  unsigned __int64 v196; // r11
  char v197; // r0
  unsigned __int64 v198; // r10
  __int64 v199; // r9
  __int64 *v200; // r8
  unsigned __int64 v201; // r0
  unsigned int v202; // r8
  __int64 v203; // r9
  int v204; // r11
  unsigned int v205; // r10
  int v206; // r9
  unsigned int v207; // r0
  unsigned int v208; // r9
  int v209; // r9
  __int64 v210; // r0
  int v211; // r10
  __int64 v212; // r9
  __int64 v213; // r0
  unsigned __int64 v214; // r9
  _QWORD *v215; // r11
  unsigned __int64 v216; // r8
  unsigned __int64 v217; // r9
  unsigned int v218; // r10
  __int64 v219; // r9
  unsigned __int64 v220; // r0
  unsigned __int64 v221; // r9
  unsigned __int64 v222; // r9
  unsigned __int64 v223; // r10
  char v224; // r0
  unsigned __int64 i; // r11
  __int64 v226; // r9
  __int64 *v227; // r8
  unsigned __int64 v228; // r9
  _QWORD *v229; // r7
  _QWORD *v230; // r9
  __int64 v231; // r9

  if ( a1 > 0xF0 )
  {
    if ( a1 > 0xFFFFFFFFFFFFFF7FLL )
    {
      v1 = -1LL;
      goto LABEL_13;
    }
    v1 = (a1 + 15) & 0xFFFFFFF8;
    if ( !LODWORD(qword_C0000E18[0]) )
      goto LABEL_13;
    v25 = v1 >> 8;
    v26 = -(__int64)v1;
    v27 = 0;
    v28 = 0LL;
    if ( v1 >> 8 )
    {
      v27 = 31;
      v28 = 31LL;
      if ( v25 <= 0xFFFF )
      {
        v85 = ((unsigned int)(v25 - 256) >> 16) & 8;
        v86 = (_DWORD)v25 << v85;
        v87 = ((unsigned int)(((_DWORD)v25 << v85) - 4096) >> 16) & 4;
        v88 = ((unsigned int)(v86 << v87 << (((unsigned int)((v86 << v87) - 0x4000) >> 16) & 2)) >> 15)
            - (v85
             + v87
             + (((unsigned int)((v86 << v87) - 0x4000) >> 16) & 2));
        v27 = 2 * (v88 + 14) + ((v1 >> ((unsigned __int8)v88 + 21)) & 1);
        v28 = v27;
      }
    }
    v29 = 0LL;
    v30 = qword_C0000E18[v28 + 74];
    if ( v30 )
    {
      v31 = 0;
      if ( v27 != 31 )
        v31 = 57 - (v27 >> 1);
      v32 = (_QWORD *)v30;
      v33 = v1 << v31;
      v30 = 0LL;
      v34 = 0LL;
      while ( 1 )
      {
        v35 = (v32[1] & 0xFFFFFFFCLL) - v1;
        if ( v26 > v35 )
        {
          if ( !v35 )
          {
            v26 = 0LL;
            v29 = (unsigned __int64)v32;
            goto LABEL_53;
          }
          v26 = (v32[1] & 0xFFFFFFFCLL) - v1;
          v30 = (unsigned __int64)v32;
        }
        v29 = v32[5];
        v32 = (_QWORD *)v32[(v33 >> 63) + 4];
        if ( v29 )
        {
          if ( (_QWORD *)v29 == v32 )
            goto LABEL_32;
        }
        else
        {
          v29 = (unsigned __int64)v34;
        }
        if ( !v32 )
        {
          if ( v30 | v29 )
            goto LABEL_52;
          break;
        }
        v34 = (_QWORD *)v29;
LABEL_32:
        v33 *= 2LL;
      }
    }
    v89 = LODWORD(qword_C0000E18[0]) & ((unsigned int)(2 << v27) | (unsigned __int64)-(__int64)(unsigned int)(2 << v27));
    if ( (_DWORD)v89 )
    {
      v90 = (v89 & -(int)v89) - 1;
      v91 = __ROR4__(v90, 12) & 0x10LL;
      v92 = v90 >> v91;
      v93 = __ROR4__(v92, 5) & 8LL;
      v94 = v92 >> v93;
      v95 = __ROR4__(v94, 2) & 4LL;
      v96 = v94 >> v95;
      v97 = v91 + v93 + v95;
      v98 = __ROR4__(v96, 1) & 2LL;
      v29 = *(__int64 *)((char *)&qword_C0000E18[74]
                       + ((8
                         * (v97
                          + v98
                          + (((unsigned __int64)(v96 >> v98) >> 1) & 1)
                          + (v96 >> v98 >> (((v96 >> v98) & 2LL) != 0)))) & 0x7FFFFFFF8LL));
    }
LABEL_52:
    v32 = (_QWORD *)v30;
    if ( v29 )
    {
LABEL_53:
      v30 = (unsigned __int64)v32;
      do
      {
        while ( 1 )
        {
          if ( (*(_QWORD *)(v29 + 8) & 0xFFFFFFFCLL) - v1 < v26 )
          {
            v26 = (*(_QWORD *)(v29 + 8) & 0xFFFFFFFCLL) - v1;
            v30 = v29;
          }
          if ( !*(_QWORD *)(v29 + 32) )
            break;
          v29 = *(_QWORD *)(v29 + 32);
        }
        v29 = *(_QWORD *)(v29 + 40);
      }
      while ( v29 );
    }
    if ( !v30 || qword_C0000E20 - v1 <= v26 )
    {
LABEL_13:
      v6 = qword_C0000E20;
      if ( v1 > qword_C0000E20 )
        goto LABEL_14;
LABEL_39:
      v40 = v6 - v1;
      v41 = qword_C0000E38;
      if ( v6 - v1 > 0x1F )
      {
        qword_C0000E20 = v6 - v1;
        qword_C0000E38 += v1;
        v44 = qword_C0000E38;
        *(_QWORD *)(qword_C0000E38 + 8) = v40 | 1;
        *(_QWORD *)(v41 + 8) = v1 | 3;
        result = v41 + 16;
        *(_QWORD *)(v44 + v40) = v40;
      }
      else
      {
        v42 = qword_C0000E38 + v6;
        qword_C0000E20 = 0LL;
        *(_QWORD *)(qword_C0000E38 + 8) = v6 | 3;
        v43 = *(_QWORD *)(v41 + v6 + 8);
        result = v41 + 16;
        qword_C0000E38 = 0LL;
        *(_QWORD *)(v42 + 8) = v43 | 1;
      }
      return result;
    }
    if ( qword_C0000E30 > v30 )
      goto LABEL_197;
    v53 = v30 + v1;
    if ( v30 >= v30 + v1 )
      goto LABEL_197;
    v54 = *(_QWORD **)(v30 + 24);
    v55 = *(_QWORD *)(v30 + 48);
    if ( v54 == (_QWORD *)v30 )
    {
      v54 = *(_QWORD **)(v30 + 40);
      v143 = (_QWORD *)(v30 + 32);
      if ( v54 )
      {
        v143 = (_QWORD *)(v30 + 40);
        goto LABEL_179;
      }
      v54 = *(_QWORD **)(v30 + 32);
      if ( v54 )
      {
        while ( 1 )
        {
LABEL_179:
          v144 = v54 + 5;
          if ( !v54[5] )
          {
            if ( !v54[4] )
            {
              if ( qword_C0000E30 > (unsigned __int64)v143 )
                goto LABEL_197;
              *v143 = 0LL;
              break;
            }
            v144 = v54 + 4;
          }
          v143 = v144;
          v54 = (_QWORD *)*v144;
        }
      }
    }
    else
    {
      v56 = *(_QWORD *)(v30 + 16);
      if ( qword_C0000E30 > v56 )
        goto LABEL_197;
      v54[2] = v56;
      *(_QWORD *)(v56 + 24) = v54;
    }
    if ( v55 )
    {
      v57 = *(_DWORD *)(v30 + 56);
      v58 = ((8LL * v57) & 0x7FFFFFFF8LL) + 592;
      if ( *(__int64 *)((char *)qword_C0000E18 + v58) == v30 )
      {
        *(__int64 *)((char *)qword_C0000E18 + v58) = (__int64)v54;
        if ( !v54 )
        {
          LODWORD(qword_C0000E18[0]) &= __ROL4__(-2, v57);
          goto LABEL_79;
        }
        goto LABEL_72;
      }
      if ( qword_C0000E30 > v55 )
        goto LABEL_197;
      if ( *(_QWORD *)(v55 + 32) == v30 )
        *(_QWORD *)(v55 + 32) = v54;
      else
        *(_QWORD *)(v55 + 40) = v54;
      if ( v54 )
      {
LABEL_72:
        v59 = qword_C0000E30;
        if ( qword_C0000E30 > (unsigned __int64)v54 )
          goto LABEL_197;
        v60 = *(_QWORD *)(v30 + 32);
        v54[6] = v55;
        if ( v60 )
        {
          if ( v59 > v60 )
            goto LABEL_197;
          *(_QWORD *)(v60 + 48) = v54;
          v54[4] = v60;
        }
        v61 = *(_QWORD *)(v30 + 40);
        if ( v61 )
        {
          if ( qword_C0000E30 > v61 )
            goto LABEL_197;
          *(_QWORD *)(v61 + 48) = v54;
          v54[5] = v61;
        }
        goto LABEL_79;
      }
    }
LABEL_79:
    if ( v26 <= 0x1F )
    {
      *(_QWORD *)(v30 + 8) = (v1 + v26) | 3;
      *(_QWORD *)(v30 + v1 + v26 + 8) |= 1uLL;
      goto LABEL_81;
    }
    *(_QWORD *)(v30 + 8) = v1 | 3;
    *(_QWORD *)(v53 + 8) = v26 | 1;
    *(_QWORD *)(v53 + v26) = v26;
    if ( v26 >> 3 > 0x1F )
    {
      v146 = v26 >> 8;
      v147 = 0;
      v148 = 0LL;
      v149 = 1;
      if ( v26 >> 8 )
      {
        v147 = 31;
        v148 = 31LL;
        v149 = 0x80000000;
        if ( v146 <= 0xFFFF )
        {
          v150 = ((unsigned int)(v146 - 256) >> 16) & 8;
          v151 = (_DWORD)v146 << v150;
          v152 = ((unsigned int)(((_DWORD)v146 << v150) - 4096) >> 16) & 4;
          v153 = ((unsigned int)(v151 << v152 << (((unsigned int)((v151 << v152) - 0x4000) >> 16) & 2)) >> 15)
               - (v150
                + v152
                + (((unsigned int)((v151 << v152) - 0x4000) >> 16) & 2));
          LOBYTE(v152) = v153 + 21;
          v154 = 2 * (v153 + 14);
          v155 = (v26 >> v152) & 1;
          v147 = v154 + v155;
          v149 = 1 << (v154 + v155);
          v148 = (unsigned int)(v154 + v155);
        }
      }
      *(_DWORD *)(v53 + 56) = v147;
      v156 = qword_C0000E18[0];
      v157 = 8 * v148 + 592;
      *(_QWORD *)(v53 + 32) = 0LL;
      *(_QWORD *)(v53 + 40) = 0LL;
      if ( (v156 & v149) != 0 )
        goto LABEL_200;
      *(__int64 *)((char *)qword_C0000E18 + v157) = v53;
      LODWORD(qword_C0000E18[0]) = v156 | v149;
      *(_QWORD *)(v53 + 48) = (char *)qword_C0000E18 + v157;
      *(_QWORD *)(v53 + 16) = v53;
      *(_QWORD *)(v53 + 24) = v53;
LABEL_81:
      result = v30 + 16;
      if ( v30 != -16LL )
        return result;
      goto LABEL_13;
    }
    v134 = 1 << (v26 >> 3);
    v135 = (char *)&unk_C0000E58 + ((16 * (v26 >> 3)) & 0x7FFFFFFF0LL);
    if ( (HIDWORD(qword_C0000E18[0]) & v134) == 0 )
    {
      v136 = (char *)&unk_C0000E58 + ((16 * (v26 >> 3)) & 0x7FFFFFFF0LL);
      HIDWORD(qword_C0000E18[0]) |= v134;
LABEL_157:
      *((_QWORD *)v135 + 2) = v53;
      *((_QWORD *)v136 + 3) = v53;
      *(_QWORD *)(v53 + 16) = v136;
      *(_QWORD *)(v53 + 24) = v135;
      goto LABEL_81;
    }
LABEL_213:
    v136 = (char *)*((_QWORD *)v135 + 2);
    if ( qword_C0000E30 > (unsigned __int64)v136 )
    {
      sub_80005988();
      goto LABEL_215;
    }
    goto LABEL_157;
  }
  v1 = 32LL;
  v2 = 4LL;
  LOBYTE(v3) = 4;
  if ( a1 > 0x16 )
  {
    v1 = ((_DWORD)a1 + 15) & 0xFFFFFFF8;
    v2 = v1 >> 3;
    v4 = HIDWORD(qword_C0000E18[0]);
    v3 = v1 >> 3;
    v5 = HIDWORD(qword_C0000E18[0]) >> (v1 >> 3);
    if ( (v5 & 3) == 0 )
    {
LABEL_4:
      v6 = qword_C0000E20;
      if ( v1 <= qword_C0000E20 )
        goto LABEL_39;
      if ( v5 )
      {
        v7 = (unsigned int)(1 << v3);
        LODWORD(v7) = 2 * v7;
        v8 = (unsigned int)(v5 << v3) & (v7 | -v7);
        LODWORD(v8) = (v8 & -(int)v8) - 1;
        v9 = __ROR4__(v8, 12) & 0x10LL;
        LODWORD(v8) = (unsigned int)v8 >> v9;
        v10 = __ROR4__(v8, 5) & 8LL;
        LODWORD(v8) = (unsigned int)v8 >> v10;
        v11 = __ROR4__(v8, 2) & 4LL;
        LODWORD(v8) = (unsigned int)v8 >> v11;
        v12 = v9 + v10 + v11;
        v13 = __ROR4__(v8, 1) & 2LL;
        v14 = v12
            + v13
            + (((unsigned __int64)((unsigned int)v8 >> v13) >> 1) & 1)
            + ((unsigned int)v8 >> v13 >> ((((unsigned int)v8 >> v13) & 2LL) != 0));
        v15 = (char *)&unk_C0000E58 + ((16 * v14) & 0x7FFFFFFF0LL);
        v16 = *((_QWORD *)v15 + 2);
        v17 = *(_QWORD *)(v16 + 16);
        if ( v15 == (char *)v17 )
        {
          HIDWORD(qword_C0000E18[0]) = v4 & ~(1 << v14);
        }
        else
        {
          if ( qword_C0000E30 > v17 )
            goto LABEL_197;
          *(_QWORD *)(v17 + 24) = v15;
          *((_QWORD *)v15 + 2) = v17;
        }
        v18 = 8 * v14;
        v19 = (unsigned int)(8 * v14);
        v20 = v19 - v1;
        if ( v19 - v1 <= 0x1F )
        {
          v21 = v19 + v16;
          *(_QWORD *)(v16 + 8) = v18 | 3u;
          result = v16 + 16;
          *(_QWORD *)(v21 + 8) |= 1uLL;
          return result;
        }
        v99 = v16 + v1;
        *(_QWORD *)(v16 + 8) = v1 | 3;
        *(_QWORD *)(v99 + v20) = v20;
        *(_QWORD *)(v99 + 8) = v20 | 1;
        if ( !qword_C0000E20 )
          goto LABEL_120;
        v100 = qword_C0000E38;
        v101 = 1 << ((unsigned __int64)qword_C0000E20 >> 3);
        v102 = (char *)&unk_C0000E58 + ((16 * ((unsigned __int64)qword_C0000E20 >> 3)) & 0x7FFFFFFF0LL);
        if ( (HIDWORD(qword_C0000E18[0]) & v101) != 0 )
          goto LABEL_198;
        v103 = HIDWORD(qword_C0000E18[0]) | v101;
        v104 = (char *)&unk_C0000E58 + ((16 * ((unsigned __int64)qword_C0000E20 >> 3)) & 0x7FFFFFFF0LL);
        HIDWORD(qword_C0000E18[0]) = v103;
LABEL_119:
        *((_QWORD *)v102 + 2) = v100;
        *((_QWORD *)v104 + 3) = v100;
        *(_QWORD *)(v100 + 16) = v104;
        *(_QWORD *)(v100 + 24) = v102;
LABEL_120:
        result = v16 + 16;
        qword_C0000E38 = v99;
        qword_C0000E20 = v20;
        return result;
      }
      if ( !LODWORD(qword_C0000E18[0]) )
      {
LABEL_14:
        v23 = qword_C0000E28;
        if ( qword_C0000E28 > v1 )
          goto LABEL_15;
        sub_80002598();
        if ( (dword_C0001178 & 4) == 0 )
        {
          v49 = (void *)qword_C0000E40;
          if ( qword_C0000E40 && (v50 = sub_80002510((__int64)qword_C0000E18, qword_C0000E40)) != 0LL )
          {
            v51 = (v1 - qword_C0000E28 + qword_C0000DF8 + 73) & -qword_C0000DF8;
            if ( v51 > 0x7FFFFFFFFFFFFFFELL )
            {
LABEL_47:
              dword_C0001178 |= 4u;
              goto LABEL_48;
            }
            v145 = sub_800048E4(v51, v49, v48, v47, v46, v45);
            v138 = v145;
            if ( *v50 + v50[1] == v145 )
            {
              if ( v145 == -1 )
              {
                dword_C0001178 |= 4u;
                goto LABEL_48;
              }
LABEL_167:
              v112 = v138;
              goto LABEL_125;
            }
          }
          else
          {
            v137 = sub_800048E4(0, v49, v48, v47, v46, v45);
            if ( v137 == -1 )
              goto LABEL_47;
            v112 = v137;
            v51 = (qword_C0000DF8 + 73 + v1) & -qword_C0000DF8;
            if ( ((qword_C0000DF0 - 1) & v137) != 0 )
              v51 += ((qword_C0000DF0 + v137) & -qword_C0000DF0) - v137;
            if ( v51 > 0x7FFFFFFFFFFFFFFELL )
              goto LABEL_47;
            v138 = sub_800048E4(v51, v49, v48, v47, v46, v45);
            if ( v112 == v138 )
              goto LABEL_125;
          }
          dword_C0001178 |= 4u;
          if ( v138 != -1LL )
          {
            v139 = sub_800048E4(0, v49, v48, v47, v46, v45);
            if ( v139 != -1LL && v138 < v139 )
            {
              v51 = v139 - v138;
              if ( v1 + 72 < v139 - v138 )
                goto LABEL_167;
            }
          }
        }
LABEL_48:
        v52 = (qword_C0000DF8 + 73 + v1) & -qword_C0000DF8;
        if ( v52 > 0x7FFFFFFFFFFFFFFELL )
          goto LABEL_49;
        v105 = sub_800048E4(v52, v49, v48, v47, v46, v45);
        v111 = sub_800048E4(0, v110, v109, v108, v107, v106);
        if ( v105 == -1LL )
          goto LABEL_49;
        if ( v111 == -1LL )
          goto LABEL_49;
        v112 = v105;
        if ( v105 >= v111 )
          goto LABEL_49;
        v51 = v111 - v105;
        if ( v1 + 72 >= v111 - v105 )
          goto LABEL_49;
LABEL_125:
        v113 = v51 + qword_C0001168;
        qword_C0001168 = v113;
        if ( qword_C0001170 < v113 )
          qword_C0001170 = v113;
        if ( !qword_C0000E40 )
        {
          v191 = 0LL;
          v192 = 32LL;
          dword_C0001198 = 0;
          qword_C0000E50 = qword_C0000DE8;
          dword_C0001178 = dword_C0000E10;
          qword_C0000E30 = v112;
          qword_C0001180 = v112;
          qword_C0001188 = v51;
          do
          {
            v193 = __ROL8__(v191++, 4);
            v194 = (char *)&unk_C0000E58 + (v193 & 0x7FFFFFFF0LL);
            *((_QWORD *)v194 + 2) = v194;
            *((_QWORD *)v194 + 3) = v194;
            --v192;
          }
          while ( v192 );
          sub_80002540(qword_C0000E18, v112, v51 - 72);
          goto LABEL_147;
        }
        v114 = &qword_C0001180;
        while ( 1 )
        {
          v115 = v114[1];
          if ( *v114 + v115 == v112 )
            break;
          v114 = (__int64 *)v114[2];
          if ( !v114 )
            goto LABEL_131;
        }
        if ( qword_C0000E40 >= (unsigned __int64)*v114 && qword_C0000E40 < v112 )
        {
          v178 = qword_C0000E40;
          v114[1] = v51 + v115;
          sub_80002540(qword_C0000E18, v178, v51 + qword_C0000E28);
          goto LABEL_147;
        }
LABEL_131:
        if ( qword_C0000E30 > v112 )
          qword_C0000E30 = v112;
        v116 = &qword_C0001180;
        while ( 1 )
        {
          v117 = *v116;
          if ( v51 + v112 == *v116 )
            break;
          v116 = (__int64 *)v116[2];
          if ( !v116 )
          {
            v118 = qword_C0000E40;
            v119 = sub_80002510((__int64)qword_C0000E18, qword_C0000E40);
            v120 = 0LL;
            v121 = *v119 + v119[1];
            v122 = v121 - 79;
            if ( (((_BYTE)v121 - 63) & 7) != 0 )
              v120 = (8LL - (((_BYTE)v121 - 63) & 7)) & 7;
            v123 = v122 + v120;
            if ( v118 + 32 > v122 + v120 )
              v123 = v118;
            sub_80002540(qword_C0000E18, v112, v51 - 72);
            v124 = qword_C0001190;
            v125 = (_QWORD *)(v123 + 48);
            *(_QWORD *)(v123 + 8) = 43LL;
            *(_QWORD *)(v123 + 32) = v124;
            *(_QWORD *)(v123 + 16) = v112;
            *(_QWORD *)(v123 + 24) = v51;
            *(_DWORD *)(v123 + 40) = 0;
            qword_C0001190 = v123 + 16;
            do
              *v125++ = 11LL;
            while ( (unsigned __int64)v125 < v121 );
            if ( v123 != v118 )
            {
              v126 = v123 - v118;
              v127 = (unsigned __int64)(v123 - v118) >> 3;
              *(_QWORD *)v123 = v123 - v118;
              *(_QWORD *)(v123 + 8) &= 0xFFFFFFFEuLL;
              *(_QWORD *)(v118 + 8) = (v123 - v118) | 1;
              if ( v127 > 0x1F )
              {
                v179 = v126 >> 8;
                v180 = 0;
                v181 = 0LL;
                v182 = 1;
                if ( v126 >> 8 )
                {
                  v180 = 31;
                  v181 = 31LL;
                  v182 = 0x80000000;
                  if ( v179 <= 0xFFFF )
                  {
                    v183 = ((unsigned int)(v179 - 256) >> 16) & 8;
                    v184 = (_DWORD)v179 << v183;
                    v185 = ((unsigned int)(((_DWORD)v179 << v183) - 4096) >> 16) & 4;
                    v186 = ((unsigned int)(v184 << v185 << (((unsigned int)((v184 << v185) - 0x4000) >> 16) & 2)) >> 15)
                         - (v183
                          + v185
                          + (((unsigned int)((v184 << v185) - 0x4000) >> 16) & 2));
                    LOBYTE(v185) = v186 + 21;
                    v187 = 2 * (v186 + 14);
                    v188 = (v126 >> v185) & 1;
                    v180 = v187 + v188;
                    v182 = 1 << (v187 + v188);
                    v181 = (unsigned int)(v187 + v188);
                  }
                }
                *(_DWORD *)(v118 + 56) = v180;
                v189 = qword_C0000E18[0];
                v190 = 8 * v181 + 592;
                *(_QWORD *)(v118 + 32) = 0LL;
                *(_QWORD *)(v118 + 40) = 0LL;
                if ( (v189 & v182) != 0 )
                {
                  v196 = *(__int64 *)((char *)qword_C0000E18 + v190);
                  v197 = 0;
                  if ( v180 != 31 )
                    v197 = 57 - (v180 >> 1);
                  v198 = v126 << v197;
                  while ( (*(_QWORD *)(v196 + 8) & 0xFFFFFFFCLL) != v126 )
                  {
                    v199 = 8 * (v198 >> 63) + 32;
                    v200 = (__int64 *)(v196 + v199);
                    if ( !*(_QWORD *)(v196 + v199) )
                    {
                      if ( qword_C0000E30 > (unsigned __int64)v200 )
                        goto LABEL_197;
                      *v200 = v118;
                      *(_QWORD *)(v118 + 48) = v196;
                      *(_QWORD *)(v118 + 16) = v118;
                      *(_QWORD *)(v118 + 24) = v118;
                      goto LABEL_147;
                    }
                    v198 *= 2LL;
                    v196 = *(_QWORD *)(v196 + v199);
                  }
                  v214 = *(_QWORD *)(v196 + 16);
                  if ( qword_C0000E30 <= v196 && qword_C0000E30 <= v214 )
                  {
                    *(_QWORD *)(v214 + 24) = v118;
                    *(_QWORD *)(v196 + 16) = v118;
                    *(_QWORD *)(v118 + 48) = 0LL;
                    *(_QWORD *)(v118 + 24) = v196;
                    *(_QWORD *)(v118 + 16) = v214;
                    goto LABEL_147;
                  }
                  goto LABEL_197;
                }
                *(__int64 *)((char *)qword_C0000E18 + v190) = v118;
                LODWORD(qword_C0000E18[0]) = v189 | v182;
                *(_QWORD *)(v118 + 48) = (char *)qword_C0000E18 + v190;
                *(_QWORD *)(v118 + 16) = v118;
                *(_QWORD *)(v118 + 24) = v118;
              }
              else
              {
                v128 = (char *)&unk_C0000E58 + ((16 * v127) & 0x7FFFFFFF0LL);
                if ( (HIDWORD(qword_C0000E18[0]) & (1 << v127)) == 0 )
                {
                  v129 = (char *)&unk_C0000E58 + ((16 * v127) & 0x7FFFFFFF0LL);
                  HIDWORD(qword_C0000E18[0]) |= 1 << v127;
                  goto LABEL_146;
                }
                v129 = (char *)*((_QWORD *)v128 + 2);
                if ( qword_C0000E30 > (unsigned __int64)v129 )
                  goto LABEL_197;
LABEL_146:
                *((_QWORD *)v128 + 2) = v118;
                *((_QWORD *)v129 + 3) = v118;
                *(_QWORD *)(v118 + 16) = v129;
                *(_QWORD *)(v118 + 24) = v128;
              }
            }
LABEL_147:
            v23 = qword_C0000E28;
            if ( qword_C0000E28 > v1 )
            {
LABEL_15:
              v24 = qword_C0000E40;
              qword_C0000E28 = v23 - v1;
              result = qword_C0000E40 + 16;
              qword_C0000E40 += v1;
              *(_QWORD *)(qword_C0000E40 + 8) = (v23 - v1) | 1;
              *(_QWORD *)(v24 + 8) = v1 | 3;
              return result;
            }
LABEL_49:
            result = 0LL;
            dword_C0000DE4 = -9;
            return result;
          }
        }
        v163 = v116[1];
        *v116 = v112;
        v116[1] = v163 + v51;
        v164 = 0LL;
        if ( (v112 & 7) != 0 )
          v164 = (8 - (v112 & 7)) & 7;
        v165 = v164 + v112;
        v166 = 0LL;
        if ( (v117 & 7) != 0 )
          v166 = (8 - (v117 & 7)) & 7;
        v167 = v166 + v117;
        v168 = qword_C0000E40;
        *(_QWORD *)(v165 + 8) = v1 | 3;
        v169 = v167 - v165 - v1;
        v170 = v165 + v1;
        if ( v168 == v167 )
        {
          qword_C0000E40 = v165 + v1;
          qword_C0000E28 += v169;
          *(_QWORD *)(v170 + 8) = qword_C0000E28 | 1;
          return v165 + 16;
        }
        if ( qword_C0000E38 == v167 )
        {
          qword_C0000E38 = v165 + v1;
          v213 = v169 + qword_C0000E20;
          qword_C0000E20 = v213;
          *(_QWORD *)(v170 + 8) = v213 | 1;
          *(_QWORD *)(v170 + v213) = v213;
          return v165 + 16;
        }
        v171 = *(_QWORD *)(v167 + 8);
        if ( (v171 & 2) != 0 )
          goto LABEL_234;
        v1 = *(_QWORD *)(v167 + 8) & 0xFFFFFFFCLL;
        v172 = v1 >> 3;
        if ( v1 >> 3 > 0x1F )
        {
          v215 = *(_QWORD **)(v167 + 24);
          v216 = *(_QWORD *)(v167 + 48);
          if ( (_QWORD *)v167 == v215 )
          {
            v215 = *(_QWORD **)(v167 + 40);
            v229 = (_QWORD *)(v167 + 32);
            if ( v215 )
            {
              v229 = (_QWORD *)(v167 + 40);
            }
            else
            {
              v215 = *(_QWORD **)(v167 + 32);
              if ( !v215 )
                goto LABEL_272;
            }
            while ( 1 )
            {
              v230 = v215 + 5;
              if ( !v215[5] )
              {
                v231 = v215[4];
                if ( !v231 )
                  goto LABEL_307;
                v230 = v215 + 4;
              }
              v229 = v230;
              v215 = (_QWORD *)*v230;
            }
          }
          v217 = *(_QWORD *)(v167 + 16);
          if ( qword_C0000E30 <= v217 )
          {
            v215[2] = v217;
            *(_QWORD *)(v217 + 24) = v215;
            goto LABEL_272;
          }
          goto LABEL_197;
        }
        v173 = *(_QWORD *)(v167 + 16);
        v174 = *(_QWORD *)(v167 + 24);
        if ( v173 == v174 )
        {
          HIDWORD(qword_C0000E18[0]) &= __ROL4__(-2, v172);
          goto LABEL_233;
        }
        if ( (_UNKNOWN *)v173 != (_UNKNOWN *)((char *)&unk_C0000E58 + ((16 * v172) & 0x1FFFFFFF0LL))
          && qword_C0000E30 > v173
          || (_UNKNOWN *)v174 != (_UNKNOWN *)((char *)&unk_C0000E58 + ((16 * v172) & 0x1FFFFFFF0LL))
          && qword_C0000E30 > v174 )
        {
LABEL_197:
          while ( 1 )
          {
            v16 = sub_80005988();
LABEL_198:
            v104 = (char *)*((_QWORD *)v102 + 2);
            if ( qword_C0000E30 <= (unsigned __int64)v104 )
              goto LABEL_119;
            v53 = sub_80005988();
LABEL_200:
            v158 = *(__int64 *)((char *)qword_C0000E18 + v157);
            v159 = 0;
            if ( v147 != 31 )
              v159 = 57 - (v147 >> 1);
            v160 = v26 << v159;
            while ( (*(_QWORD *)(v158 + 8) & 0xFFFFFFFCLL) != v26 )
            {
              v161 = 8 * (v160 >> 63) + 32;
              v162 = (__int64 *)(v158 + v161);
              if ( !*(_QWORD *)(v158 + v161) )
              {
                if ( qword_C0000E30 > (unsigned __int64)v162 )
                  goto LABEL_197;
                *v162 = v53;
                *(_QWORD *)(v53 + 48) = v158;
                *(_QWORD *)(v53 + 16) = v53;
                *(_QWORD *)(v53 + 24) = v53;
                goto LABEL_81;
              }
              v160 *= 2LL;
              v158 = *(_QWORD *)(v158 + v161);
            }
            v195 = *(_QWORD *)(v158 + 16);
            if ( qword_C0000E30 <= v158 && qword_C0000E30 <= v195 )
            {
              *(_QWORD *)(v195 + 24) = v53;
              *(_QWORD *)(v158 + 16) = v53;
              *(_QWORD *)(v53 + 48) = 0LL;
              *(_QWORD *)(v53 + 24) = v158;
              *(_QWORD *)(v53 + 16) = v195;
              goto LABEL_81;
            }
          }
        }
        *(_QWORD *)(v174 + 16) = v173;
        *(_QWORD *)(v173 + 24) = v174;
        while ( 1 )
        {
          do
          {
LABEL_233:
            v167 += v1;
            v169 += v1;
            v171 = *(_QWORD *)(v167 + 8);
LABEL_234:
            *(_QWORD *)(v167 + 8) = (unsigned int)v171 & 0xFFFFFFFE;
            *(_QWORD *)(v170 + v169) = v169;
            *(_QWORD *)(v170 + 8) = v169 | 1;
            if ( v169 >> 3 > 0x1F )
            {
              v201 = v169 >> 8;
              v202 = 0;
              v203 = 0LL;
              v204 = 1;
              if ( v169 >> 8 )
              {
                v202 = 31;
                v203 = 31LL;
                v204 = 0x80000000;
                if ( v201 <= 0xFFFF )
                {
                  v205 = ((unsigned int)(v201 - 256) >> 16) & 8;
                  v206 = (_DWORD)v201 << v205;
                  v207 = ((unsigned int)(((_DWORD)v201 << v205) - 4096) >> 16) & 4;
                  v208 = ((unsigned int)(v206 << v207 << (((unsigned int)((v206 << v207) - 0x4000) >> 16) & 2)) >> 15)
                       - (v205
                        + v207
                        + (((unsigned int)((v206 << v207) - 0x4000) >> 16) & 2));
                  LOBYTE(v207) = v208 + 21;
                  v209 = 2 * (v208 + 14);
                  v210 = (v169 >> v207) & 1;
                  v202 = v209 + v210;
                  v204 = 1 << (v209 + v210);
                  v203 = (unsigned int)(v209 + v210);
                }
              }
              *(_DWORD *)(v170 + 56) = v202;
              v211 = qword_C0000E18[0];
              v212 = 8 * v203 + 592;
              *(_QWORD *)(v170 + 32) = 0LL;
              *(_QWORD *)(v170 + 40) = 0LL;
              if ( (v211 & v204) != 0 )
              {
                v223 = *(__int64 *)((char *)qword_C0000E18 + v212);
                v224 = 0;
                if ( v202 != 31 )
                  v224 = 57 - (v202 >> 1);
                for ( i = v169 << v224; ; i *= 2LL )
                {
                  if ( (*(_QWORD *)(v223 + 8) & 0xFFFFFFFCLL) == v169 )
                  {
                    v228 = *(_QWORD *)(v223 + 16);
                    if ( qword_C0000E30 <= v223 && qword_C0000E30 <= v228 )
                    {
                      *(_QWORD *)(v228 + 24) = v170;
                      *(_QWORD *)(v223 + 16) = v170;
                      *(_QWORD *)(v170 + 48) = 0LL;
                      *(_QWORD *)(v170 + 24) = v223;
                      *(_QWORD *)(v170 + 16) = v228;
                      return v165 + 16;
                    }
                    goto LABEL_197;
                  }
                  v226 = 8 * (i >> 63) + 32;
                  v227 = (__int64 *)(v223 + v226);
                  if ( !*(_QWORD *)(v223 + v226) )
                    break;
                  v223 = *(_QWORD *)(v223 + v226);
                }
                if ( qword_C0000E30 > (unsigned __int64)v227 )
                  goto LABEL_197;
                *v227 = v170;
                *(_QWORD *)(v170 + 48) = v223;
                *(_QWORD *)(v170 + 16) = v170;
                *(_QWORD *)(v170 + 24) = v170;
                result = v165 + 16;
              }
              else
              {
                *(__int64 *)((char *)qword_C0000E18 + v212) = v170;
                *(_QWORD *)(v170 + 48) = (char *)qword_C0000E18 + v212;
                *(_QWORD *)(v170 + 16) = v170;
                *(_QWORD *)(v170 + 24) = v170;
                result = v165 + 16;
                LODWORD(qword_C0000E18[0]) = v211 | v204;
              }
              return result;
            }
            v175 = 1 << (v169 >> 3);
            v176 = (char *)&unk_C0000E58 + ((16 * (v169 >> 3)) & 0x7FFFFFFF0LL);
            if ( (HIDWORD(qword_C0000E18[0]) & v175) == 0 )
            {
              v177 = (char *)&unk_C0000E58 + ((16 * (v169 >> 3)) & 0x7FFFFFFF0LL);
              HIDWORD(qword_C0000E18[0]) |= v175;
LABEL_237:
              *((_QWORD *)v176 + 2) = v170;
              *((_QWORD *)v177 + 3) = v170;
              *(_QWORD *)(v170 + 16) = v177;
              *(_QWORD *)(v170 + 24) = v176;
              return v165 + 16;
            }
            v177 = (char *)*((_QWORD *)v176 + 2);
            if ( qword_C0000E30 <= (unsigned __int64)v177 )
              goto LABEL_237;
            v170 = sub_80005988();
LABEL_307:
            if ( qword_C0000E30 > (unsigned __int64)v229 )
              goto LABEL_197;
            *v229 = v231;
LABEL_272:
            ;
          }
          while ( !v216 );
          v218 = *(_DWORD *)(v167 + 56);
          v219 = ((8LL * v218) & 0x7FFFFFFF8LL) + 592;
          if ( *(__int64 *)((char *)qword_C0000E18 + v219) == v167 )
          {
            *(__int64 *)((char *)qword_C0000E18 + v219) = (__int64)v215;
            if ( v215 )
            {
LABEL_278:
              v220 = qword_C0000E30;
              if ( qword_C0000E30 > (unsigned __int64)v215 )
                goto LABEL_197;
              v221 = *(_QWORD *)(v167 + 32);
              v215[6] = v216;
              if ( v221 )
              {
                if ( v220 > v221 )
                  goto LABEL_197;
                *(_QWORD *)(v221 + 48) = v215;
                v215[4] = v221;
              }
              v222 = *(_QWORD *)(v167 + 40);
              if ( v222 )
              {
                if ( qword_C0000E30 > v222 )
                  goto LABEL_197;
                *(_QWORD *)(v222 + 48) = v215;
                v215[5] = v222;
              }
            }
            else
            {
              LODWORD(qword_C0000E18[0]) &= __ROL4__(-2, v218);
            }
          }
          else
          {
            if ( qword_C0000E30 > v216 )
              goto LABEL_197;
            if ( *(_QWORD *)(v216 + 32) == v167 )
              *(_QWORD *)(v216 + 32) = v215;
            else
              *(_QWORD *)(v216 + 40) = v215;
            if ( v215 )
              goto LABEL_278;
          }
        }
      }
      v62 = (qword_C0000E18[0] & -LODWORD(qword_C0000E18[0])) - 1;
      v63 = __ROR4__(v62, 12) & 0x10LL;
      v64 = v62 >> v63;
      v65 = __ROR4__(v64, 5) & 8LL;
      v66 = v64 >> v65;
      v67 = __ROR4__(v66, 2) & 4LL;
      v68 = v66 >> v67;
      v69 = v63 + v65 + v67;
      v70 = __ROR4__(v68, 1) & 2LL;
      v71 = *(__int64 *)((char *)&qword_C0000E18[74]
                       + ((8
                         * (v69
                          + v70
                          + (((unsigned __int64)(v68 >> v70) >> 1) & 1)
                          + (v68 >> v70 >> (((v68 >> v70) & 2LL) != 0)))) & 0x7FFFFFFF8LL));
      v72 = v71;
      v73 = *(_QWORD *)(v71 + 32);
      v74 = (*(_QWORD *)(v71 + 8) & 0xFFFFFFFCLL) - v1;
      if ( !v73 )
        goto LABEL_88;
      do
      {
        do
        {
          if ( v74 > (*(_QWORD *)(v73 + 8) & 0xFFFFFFFCLL) - v1 )
          {
            v74 = (*(_QWORD *)(v73 + 8) & 0xFFFFFFFCLL) - v1;
            v71 = v73;
          }
          v72 = v73;
          v73 = *(_QWORD *)(v73 + 32);
        }
        while ( v73 );
LABEL_88:
        v73 = *(_QWORD *)(v72 + 40);
      }
      while ( v73 );
      v75 = qword_C0000E30;
      if ( qword_C0000E30 > v71 )
        goto LABEL_197;
      v76 = v71 + v1;
      if ( v71 >= v71 + v1 )
        goto LABEL_197;
      v77 = *(_QWORD **)(v71 + 24);
      v78 = *(_QWORD *)(v71 + 48);
      if ( (_QWORD *)v71 == v77 )
      {
        v77 = *(_QWORD **)(v71 + 40);
        v140 = (_QWORD *)(v71 + 32);
        v141 = (_QWORD *)(v71 + 40);
        if ( v77 )
          goto LABEL_172;
LABEL_215:
        v77 = *(_QWORD **)(v71 + 32);
        v141 = v140;
        if ( !v77 )
          goto LABEL_94;
        while ( 1 )
        {
LABEL_172:
          v142 = v77 + 4;
          if ( v77[5] )
          {
            v142 = v77 + 5;
          }
          else if ( !v77[4] )
          {
            if ( v75 > (unsigned __int64)v141 )
              goto LABEL_197;
            *v141 = 0LL;
            goto LABEL_94;
          }
          v141 = v142;
          v77 = (_QWORD *)*v142;
        }
      }
      v79 = *(_QWORD *)(v71 + 16);
      if ( qword_C0000E30 > v79 )
        goto LABEL_197;
      v77[2] = v79;
      *(_QWORD *)(v79 + 24) = v77;
LABEL_94:
      if ( !v78 )
        goto LABEL_107;
      v80 = *(_DWORD *)(v71 + 56);
      v81 = ((8LL * v80) & 0x7FFFFFFF8LL) + 592;
      if ( *(__int64 *)((char *)qword_C0000E18 + v81) == v71 )
      {
        *(__int64 *)((char *)qword_C0000E18 + v81) = (__int64)v77;
        if ( !v77 )
        {
          LODWORD(qword_C0000E18[0]) &= __ROL4__(-2, v80);
LABEL_107:
          if ( v74 <= 0x1F )
          {
            *(_QWORD *)(v71 + 8) = (v1 + v74) | 3;
            *(_QWORD *)(v71 + v1 + v74 + 8) |= 1uLL;
            goto LABEL_109;
          }
          *(_QWORD *)(v71 + 8) = v1 | 3;
          *(_QWORD *)(v76 + 8) = v74 | 1;
          *(_QWORD *)(v76 + v74) = v74;
          if ( !qword_C0000E20 )
          {
LABEL_153:
            qword_C0000E20 = v74;
            qword_C0000E38 = v76;
LABEL_109:
            result = v71 + 16;
            if ( v71 != -16LL )
              return result;
            goto LABEL_13;
          }
          v130 = 1 << ((unsigned __int64)qword_C0000E20 >> 3);
          v131 = qword_C0000E38;
          v132 = (char *)&unk_C0000E58 + ((16 * ((unsigned __int64)qword_C0000E20 >> 3)) & 0x7FFFFFFF0LL);
          if ( (HIDWORD(qword_C0000E18[0]) & v130) == 0 )
          {
            v133 = (char *)&unk_C0000E58 + ((16 * ((unsigned __int64)qword_C0000E20 >> 3)) & 0x7FFFFFFF0LL);
            HIDWORD(qword_C0000E18[0]) |= v130;
LABEL_152:
            *((_QWORD *)v132 + 2) = qword_C0000E38;
            *((_QWORD *)v133 + 3) = v131;
            *(_QWORD *)(v131 + 16) = v133;
            *(_QWORD *)(v131 + 24) = v132;
            goto LABEL_153;
          }
          v133 = (char *)*((_QWORD *)v132 + 2);
          if ( qword_C0000E30 <= (unsigned __int64)v133 )
            goto LABEL_152;
          v53 = sub_80005988();
          goto LABEL_213;
        }
      }
      else
      {
        if ( qword_C0000E30 > v78 )
          goto LABEL_197;
        if ( *(_QWORD *)(v78 + 32) == v71 )
          *(_QWORD *)(v78 + 32) = v77;
        else
          *(_QWORD *)(v78 + 40) = v77;
        if ( !v77 )
          goto LABEL_107;
      }
      v82 = qword_C0000E30;
      if ( qword_C0000E30 > (unsigned __int64)v77 )
        goto LABEL_197;
      v83 = *(_QWORD *)(v71 + 32);
      v77[6] = v78;
      if ( v83 )
      {
        if ( v82 > v83 )
          goto LABEL_197;
        *(_QWORD *)(v83 + 48) = v77;
        v77[4] = v83;
      }
      v84 = *(_QWORD *)(v71 + 40);
      if ( v84 )
      {
        if ( qword_C0000E30 > v84 )
          goto LABEL_197;
        *(_QWORD *)(v84 + 48) = v77;
        v77[5] = v84;
      }
      goto LABEL_107;
    }
  }
  else
  {
    v4 = HIDWORD(qword_C0000E18[0]);
    v5 = HIDWORD(qword_C0000E18[0]) >> 4;
    if ( ((HIDWORD(qword_C0000E18[0]) >> 4) & 3) == 0 )
      goto LABEL_4;
  }
  v36 = ((v5 & 1) == 0) + (_DWORD)v2;
  v37 = (char *)&unk_C0000E58 + ((16 * (((v5 & 1) == 0) + v2)) & 0x7FFFFFFF0LL);
  v38 = *((_QWORD *)v37 + 2);
  v39 = *(_QWORD *)(v38 + 16);
  if ( v37 == (char *)v39 )
  {
    HIDWORD(qword_C0000E18[0]) = v4 & __ROL4__(-2, v36);
  }
  else
  {
    if ( qword_C0000E30 > v39 )
      goto LABEL_197;
    *(_QWORD *)(v39 + 24) = v37;
    *((_QWORD *)v37 + 2) = v39;
  }
  result = v38 + 16;
  *(_QWORD *)(v38 + 8) = (8 * v36) | 3u;
  *(_QWORD *)((unsigned int)(8 * v36) + v38 + 8) |= 1uLL;
  return result;
}
// 800034E8: variable 'v30' is possibly undefined
// 800035E8: variable 'v78' is possibly undefined
// 800035EC: variable 'v71' is possibly undefined
// 80003678: variable 'v74' is possibly undefined
// 800037F0: variable 'v100' is possibly undefined
// 800037F0: variable 'v102' is possibly undefined
// 80003804: variable 'v99' is possibly undefined
// 80003808: variable 'v20' is possibly undefined
// 80003814: variable 'v49' is possibly undefined
// 80003814: variable 'v48' is possibly undefined
// 80003814: variable 'v47' is possibly undefined
// 80003814: variable 'v46' is possibly undefined
// 80003814: variable 'v45' is possibly undefined
// 80003820: variable 'v110' is possibly undefined
// 80003820: variable 'v109' is possibly undefined
// 80003820: variable 'v108' is possibly undefined
// 80003820: variable 'v107' is possibly undefined
// 80003820: variable 'v106' is possibly undefined
// 800039FC: variable 'v76' is possibly undefined
// 80003AB8: variable 'v135' is possibly undefined
// 80003BDC: variable 'v75' is possibly undefined
// 80003DC0: variable 'v157' is possibly undefined
// 80003DC8: variable 'v147' is possibly undefined
// 80003DD4: variable 'v26' is possibly undefined
// 80003E74: variable 'v140' is possibly undefined
// 80003F88: variable 'v167' is possibly undefined
// 80003F8C: variable 'v169' is possibly undefined
// 80003FF8: variable 'v165' is possibly undefined
// 8000438C: variable 'v216' is possibly undefined
// 800043C0: variable 'v215' is possibly undefined
// 80004590: variable 'v229' is possibly undefined
// 80004594: variable 'v231' is possibly undefined
// C0000DE4: using guessed type int dword_C0000DE4;
// C0000DE8: using guessed type __int64 qword_C0000DE8;
// C0000DF0: using guessed type __int64 qword_C0000DF0;
// C0000DF8: using guessed type __int64 qword_C0000DF8;
// C0000E10: using guessed type int dword_C0000E10;
// C0000E18: using guessed type __int64 qword_C0000E18[];
// C0000E20: using guessed type __int64 qword_C0000E20;
// C0000E28: using guessed type __int64 qword_C0000E28;
// C0000E30: using guessed type __int64 qword_C0000E30;
// C0000E38: using guessed type __int64 qword_C0000E38;
// C0000E40: using guessed type __int64 qword_C0000E40;
// C0000E50: using guessed type __int64 qword_C0000E50;
// C0001168: using guessed type __int64 qword_C0001168;
// C0001170: using guessed type __int64 qword_C0001170;
// C0001178: using guessed type int dword_C0001178;
// C0001180: using guessed type __int64 qword_C0001180;
// C0001188: using guessed type __int64 qword_C0001188;
// C0001190: using guessed type __int64 qword_C0001190;
// C0001198: using guessed type int dword_C0001198;

//----- (00000000800045CC) ----------------------------------------------------
_BYTE *__fastcall memset(_BYTE *a1, __int16 a2, unsigned __int64 a3)
{
  _BYTE *v3; // r30
  unsigned __int64 *v4; // r11
  char v5; // r31
  char v6; // r12
  unsigned __int64 v7; // r3
  _WORD *v8; // r7
  unsigned __int16 v9; // r8
  _DWORD *v10; // r11
  unsigned __int64 *v11; // r6
  unsigned __int64 v12; // r4
  unsigned __int64 v13; // r0
  __int64 v14; // r9
  unsigned __int64 v15; // ctr

  v3 = a1;
  v4 = (unsigned __int64 *)a1;
  v5 = a2;
  v6 = a2;
  v7 = (unsigned __int64)&a1[a3];
  if ( a3 > 7 )
  {
    v8 = (_WORD *)((unsigned __int64)(v3 + 1) & 0xFFFFFFFFFFFFFFFELL);
    v9 = (a2 << 8) | (unsigned __int8)a2;
    v10 = (_DWORD *)((unsigned __int64)(v8 + 1) & 0xFFFFFFFFFFFFFFFCLL);
    v11 = (unsigned __int64 *)((unsigned __int64)(v10 + 1) & 0xFFFFFFFFFFFFFFF8LL);
    v12 = (v7 & 0xFFFFFFFFFFFFFFF8LL) - 64;
    *v3 = v5;
    v13 = v9 | (v9 << 16) | ((unsigned __int64)(v9 | (v9 << 16)) << 32);
    *v8 = v9;
    for ( *v10 = v9 | (v9 << 16); v12 >= (unsigned __int64)v11; v11 += 8 )
    {
      v11[7] = v13;
      v11[6] = v13;
      v11[5] = v13;
      v11[4] = v13;
      v11[3] = v13;
      v11[2] = v13;
      v11[1] = v13;
      *v11 = v13;
      v11 += 8;
      if ( v12 < (unsigned __int64)v11 )
        break;
      v11[7] = v13;
      v11[6] = v13;
      v11[5] = v13;
      v11[4] = v13;
      v11[3] = v13;
      v11[2] = v13;
      v11[1] = v13;
      *v11 = v13;
    }
    while ( (v7 & 0xFFFFFFFFFFFFFFF8LL) > (unsigned __int64)v11 )
      *v11++ = v13;
    v4 = v11;
  }
  if ( v7 > (unsigned __int64)v4 )
  {
    v14 = 0LL;
    v15 = v7 - (_QWORD)v4;
    do
    {
      *((_BYTE *)v4 + v14++) = v6;
      --v15;
    }
    while ( v15 );
  }
  return v3;
}

//----- (00000000800046E8) ----------------------------------------------------
void do_ctors()
{
  ;
}

//----- (0000000080004744) ----------------------------------------------------
void do_dtors()
{
  ;
}

//----- (00000000800047A0) ----------------------------------------------------
int *memset_bss()
{
  int *result; // r3

  result = &dword_C0000DD8;
  if ( (unsigned __int64)&dword_C0000DD8 < 0xC00013D0 )
    result = (int *)memset(&dword_C0000DD8, 0, 0x5F8uLL);
  return result;
}
// C0000DD8: using guessed type int dword_C0000DD8;

//----- (00000000800047C0) ----------------------------------------------------
void sub_800047C0()
{
  int v0; // r29
  void *v1; // r9
  void *v2; // r8
  void *v3; // r7
  void *v4; // r6
  void *v5; // r5
  void *v6; // r4

  memset_bss();
  do_ctors();
  v0 = main_80000270();
  do_dtors();
  exit((void *)v0, v6, v5, v4, v3, v2, v1);
}
// 80004808: variable 'v6' is possibly undefined
// 80004808: variable 'v5' is possibly undefined
// 80004808: variable 'v4' is possibly undefined
// 80004808: variable 'v3' is possibly undefined
// 80004808: variable 'v2' is possibly undefined
// 80004808: variable 'v1' is possibly undefined

//----- (0000000080004830) ----------------------------------------------------
__int64 __fastcall getpid(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 result; // r3

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  return (int)result;
}
// 8000483C: variable 'v7' is possibly undefined
// 80004844: variable 'result' is possibly undefined

//----- (0000000080004850) ----------------------------------------------------
__int64 __fastcall fork(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 v8; // r3
  int v9; // r0

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  v9 = -1;
  if ( v8 >= 0 )
    return (int)v8;
  dword_C0000DE4 = v8;
  return v9;
}
// 8000485C: variable 'v7' is possibly undefined
// 80004868: variable 'v8' is possibly undefined
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (000000008000488C) ----------------------------------------------------
__int64 __fastcall execv(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 v8; // r3
  int v9; // r0

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  v9 = -1;
  if ( v8 >= 0 )
    return (int)v8;
  dword_C0000DE4 = v8;
  return v9;
}
// 80004898: variable 'v7' is possibly undefined
// 800048A4: variable 'v8' is possibly undefined
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (00000000800048C8) ----------------------------------------------------
void __fastcall __noreturn exit(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
}
// 800048D4: variable 'v7' is possibly undefined

//----- (00000000800048E4) ----------------------------------------------------
__int64 __fastcall sub_800048E4(int a1, void *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r9
  unsigned __int64 v7; // r31
  unsigned __int64 v8; // r30
  void *v9; // r3
  __int64 result; // r3

  if ( qword_C00011A0 )
  {
    v6 = (void *)a1;
    v7 = a1 + qword_C00011A8;
    v8 = (v7 + 4095) & 0xFFFFFFFFFFFFF000LL;
    v9 = (void *)v8;
    if ( v7 < qword_C00011A0 )
      goto LABEL_3;
  }
  else
  {
    v6 = (void *)a1;
    qword_C00011A8 = 3221233664LL;
    qword_C00011A0 = 3221233664LL;
    v7 = a1 + 3221233664LL;
    v8 = (a1 + 3221237759LL) & 0xFFFFFFFFFFFFF000LL;
    v9 = (void *)v8;
    if ( v7 < 0xC0002000 )
    {
LABEL_3:
      result = qword_C00011A8;
      qword_C00011A8 = v7;
      return result;
    }
  }
  result = (int)brk(v9, a2, a3, a4, a5, a6, v6);
  if ( !(_DWORD)result )
  {
    qword_C00011A0 = v8;
    goto LABEL_3;
  }
  dword_C0000DE4 = -9;
  return result;
}
// C0000DE4: using guessed type int dword_C0000DE4;
// C00011A0: using guessed type __int64 qword_C00011A0;
// C00011A8: using guessed type __int64 qword_C00011A8;

//----- (00000000800049DC) ----------------------------------------------------
__int64 __fastcall open(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 v8; // r3
  int v9; // r0

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  v9 = -1;
  if ( v8 >= 0 )
    return (int)v8;
  dword_C0000DE4 = v8;
  return v9;
}
// 800049E8: variable 'v7' is possibly undefined
// 800049F4: variable 'v8' is possibly undefined
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (0000000080004A18) ----------------------------------------------------
__int64 __fastcall close(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 v8; // r3
  int v9; // r0

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  v9 = -1;
  if ( v8 >= 0 )
    return (int)v8;
  dword_C0000DE4 = v8;
  return v9;
}
// 80004A24: variable 'v7' is possibly undefined
// 80004A30: variable 'v8' is possibly undefined
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (0000000080004A54) ----------------------------------------------------
__int64 __fastcall read(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 v8; // r3
  __int64 v9; // r0

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  v9 = -1LL;
  if ( v8 >= 0 )
    return v8;
  dword_C0000DE4 = v8;
  return v9;
}
// 80004A60: variable 'v7' is possibly undefined
// 80004A6C: variable 'v8' is possibly undefined
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (0000000080004A90) ----------------------------------------------------
__int64 __fastcall socket(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 v8; // r3
  __int64 v9; // r0

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  v9 = -1LL;
  if ( v8 >= 0 )
    return v8;
  dword_C0000DE4 = v8;
  return v9;
}
// 80004A9C: variable 'v7' is possibly undefined
// 80004AA8: variable 'v8' is possibly undefined
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (0000000080004ACC) ----------------------------------------------------
__int64 __fastcall sc_0B_lseek(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 v8; // r3
  int v9; // r0

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  v9 = -1;
  if ( v8 >= 0 )
    return (int)v8;
  dword_C0000DE4 = v8;
  return v9;
}
// 80004AD8: variable 'v7' is possibly undefined
// 80004AE4: variable 'v8' is possibly undefined
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (0000000080004B08) ----------------------------------------------------
__int64 __fastcall map_pages(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 result; // r3

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  return (int)result;
}
// 80004B14: variable 'v7' is possibly undefined
// 80004B1C: variable 'result' is possibly undefined

//----- (0000000080004B28) ----------------------------------------------------
__int64 __fastcall unmap_pages(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 result; // r3

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  return (int)result;
}
// 80004B34: variable 'v7' is possibly undefined
// 80004B3C: variable 'result' is possibly undefined

//----- (0000000080004B48) ----------------------------------------------------
__int64 __fastcall alarm(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 v8; // r3
  int v9; // r0

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  v9 = -1;
  if ( v8 >= 0 )
    return (int)v8;
  dword_C0000DE4 = v8;
  return v9;
}
// 80004B54: variable 'v7' is possibly undefined
// 80004B60: variable 'v8' is possibly undefined
// C0000DE4: using guessed type int dword_C0000DE4;

//----- (0000000080004B84) ----------------------------------------------------
__int64 dbg_msg(_BYTE *a1, ...)
{
  va_list va; // [sp+B8h] [+38h] BYREF

  va_start(va, a1);
  return (int)sub_80004BD0(a1, (__int64)va);
}

//----- (0000000080004BD0) ----------------------------------------------------
__int64 __fastcall sub_80004BD0(_BYTE *a1, __int64 a2)
{
  return sub_80004DF4(&stru_C00008C0, 0LL, a1, a2);
}
// C00008C0: using guessed type OPD64_s stru_C00008C0;

//----- (0000000080004BE4) ----------------------------------------------------
__int64 __fastcall sub_80004BE4(__int64 a1, char *a2, __int64 a3, __int64 a4, void *a5)
{
  sub_800059BC(a2, 1uLL, a3, &qword_C00000C0, a5);
  return a1;
}
// C00000C0: using guessed type __int64 qword_C00000C0;

//----- (0000000080004C20) ----------------------------------------------------
unsigned __int64 __fastcall sub_80004C20(unsigned __int64 a1)
{
  return a1 % 0xA;
}

//----- (0000000080004C54) ----------------------------------------------------
__int64 __fastcall sub_80004C54(__int64 result)
{
  __int64 v1; // r31
  int v2; // r30
  __int64 v3; // r29
  int v4; // r0

  v1 = result;
  if ( *(int *)(result + 32) > 0 )
  {
    v2 = 0;
    v3 = result + 40;
    do
    {
      ++v2;
      result = (**(__int64 (__fastcall ***)(_QWORD, __int64, __int64))(v1 + 8))(*(_QWORD *)(v1 + 16), v3, 1LL);
      v4 = *(_DWORD *)(v1 + 32);
      *(_QWORD *)(v1 + 16) = result;
    }
    while ( v4 > v2 );
  }
  return result;
}

//----- (0000000080004CD4) ----------------------------------------------------
__int64 __fastcall sub_80004CD4(__int64 result)
{
  __int64 v1; // r31
  int v2; // r30
  __int64 v3; // r29
  int v4; // r0

  v1 = result;
  if ( *(int *)(result + 36) > 0 )
  {
    v2 = 0;
    v3 = result + 41;
    do
    {
      ++v2;
      result = (**(__int64 (__fastcall ***)(_QWORD, __int64, __int64))(v1 + 8))(*(_QWORD *)(v1 + 16), v3, 1LL);
      v4 = *(_DWORD *)(v1 + 36);
      *(_QWORD *)(v1 + 16) = result;
    }
    while ( v4 > v2 );
  }
  return result;
}

//----- (0000000080004D54) ----------------------------------------------------
__int64 __fastcall sub_80004D54(__int64 a1)
{
  __int64 result; // r3

  result = (**(__int64 (__fastcall ***)(_QWORD, __int64, _QWORD))(a1 + 8))(
             *(_QWORD *)(a1 + 16),
             a1 + 42,
             *(int *)(a1 + 52));
  *(_QWORD *)(a1 + 16) = result;
  return result;
}

//----- (0000000080004DA4) ----------------------------------------------------
__int64 __fastcall sub_80004DA4(__int64 a1)
{
  __int64 result; // r3

  result = (**(__int64 (__fastcall ***)(_QWORD, _QWORD, _QWORD))(a1 + 8))(
             *(_QWORD *)(a1 + 16),
             *(_QWORD *)(a1 + 120),
             *(int *)(a1 + 128));
  *(_QWORD *)(a1 + 16) = result;
  return result;
}

//----- (0000000080004DF4) ----------------------------------------------------
__int64 __fastcall sub_80004DF4(__int64 (__fastcall **a1)(__int64, _BYTE *, __int64), __int64 a2, _BYTE *a3, __int64 a4)
{
  _BYTE *v5; // r4
  unsigned __int8 *v7; // r31
  unsigned __int8 v8; // r8
  int v9; // r9
  int v10; // r0
  unsigned int v11; // r0
  int v12; // r10
  int v13; // r8
  int v14; // r9
  signed int v15; // r10
  int v16; // r11
  int v17; // r8
  __int64 v18; // r9
  __int64 v19; // r9
  __int64 v20; // r9
  unsigned __int64 v21; // r10
  __int64 v22; // r9
  __int64 *v23; // r9
  _BYTE *v24; // r9
  int v25; // r0
  _BYTE *v26; // r9
  __int64 v27; // ctr
  int v28; // r3
  __int64 v29; // r9
  unsigned __int64 v30; // r29
  __int64 v31; // r9
  __int64 v32; // r9
  unsigned __int64 v33; // r0
  __int64 *v34; // r9
  __int64 v35; // r11
  unsigned __int64 v36; // r30
  char *v37; // r29
  char *v38; // r3
  char *v39; // r9
  __int64 *v40; // r9
  const char *v41; // r8
  char *v42; // r11
  __int64 v43; // r0
  unsigned __int64 *v44; // r9
  __int64 *v45; // r9
  __int64 *v46; // r9
  char *v47; // r11
  char *v48; // r9
  char *v49; // r3
  char v50; // r9
  __int64 *v51; // r9
  char *v52; // r30
  char v53; // r3
  unsigned __int64 v54; // kr00_8
  __int64 v55; // r9
  unsigned int v56; // r3
  __int64 *v57; // [sp+70h] [-C0h] BYREF
  __int64 (__fastcall **v58)(__int64, _BYTE *, __int64); // [sp+78h] [-B8h]
  __int64 v59; // [sp+80h] [-B0h]
  char v60; // [sp+88h] [-A8h]
  int v61; // [sp+8Ch] [-A4h]
  int v62; // [sp+90h] [-A0h]
  unsigned int v63; // [sp+94h] [-9Ch]
  char v64; // [sp+98h] [-98h]
  char v65; // [sp+99h] [-97h]
  char v66; // [sp+9Ah] [-96h]
  char v67; // [sp+9Bh] [-95h]
  int v68; // [sp+A4h] [-8Ch]
  unsigned __int8 v69; // [sp+E7h] [-49h] BYREF
  const char *v70; // [sp+E8h] [-48h] BYREF
  int i; // [sp+F0h] [-40h]
  int v72; // [sp+F4h] [-3Ch]

  v57 = (__int64 *)a4;
  v58 = a1;
  v59 = a2;
  v60 = 0;
  v72 = 0;
  while ( *a3 )
  {
    while ( 1 )
    {
      v64 = 32;
      v65 = 48;
      v68 = 0;
      i = 0;
      v61 = 0;
      v62 = 0;
      v63 = 0;
      v70 = 0LL;
      if ( *a3 == 37 )
        break;
      v5 = a3++;
      v59 = (*v58)(v59, v5, 1LL);
      ++v72;
      if ( !*a3 )
        return v72;
    }
    v7 = a3 + 1;
    if ( !a3[1] )
      break;
    while ( 2 )
    {
      v8 = *v7;
      switch ( *v7 )
      {
        case ' ':
          v64 = 32;
          v61 |= 8u;
          goto LABEL_39;
        case '#':
          ++v7;
          v61 |= 0x10u;
          continue;
        case '+':
          ++v7;
          v61 |= 2u;
          continue;
        case '-':
          ++v7;
          v64 = 32;
          v61 |= 1u;
          continue;
        case '0':
          if ( (v61 & 1) != 0 )
          {
LABEL_39:
            ++v7;
          }
          else
          {
            ++v7;
            v61 |= 4u;
            v64 = 48;
          }
          continue;
        default:
          v9 = 0;
          if ( (unsigned __int8)(v8 - 48) <= 9u )
          {
            do
            {
              v12 = v8;
              v8 = *++v7;
              v9 = 10 * v9 + v12 - 48;
            }
            while ( (unsigned __int8)(*v7 - 48) <= 9u );
            v62 = v9;
            v8 = *v7;
            if ( *v7 != 46 )
              goto LABEL_12;
          }
          else
          {
            if ( *v7 == 42 )
            {
              v18 = (__int64)v57++;
              v62 = *(_DWORD *)(v18 + 4);
              v8 = *++v7;
            }
            if ( v8 != 46 )
              goto LABEL_12;
          }
          v64 = 32;
          v61 = __ROL4__(__ROR4__(v61 | 0x20, 3) & 0x7FFFFFFF, 3);
          v13 = *++v7;
          if ( v13 == 42 )
          {
            v19 = (__int64)v57++;
            v63 = *(_DWORD *)(v19 + 4);
            v8 = *++v7;
LABEL_12:
            v10 = v8;
            if ( v8 != 108 )
              goto LABEL_13;
            goto LABEL_27;
          }
          v14 = 0;
          if ( (unsigned __int8)(*v7 - 48) <= 9u )
          {
            v14 = 0;
            while ( 1 )
            {
              ++v7;
              v14 = 10 * v14 + v13 - 48;
              if ( (unsigned __int8)(*v7 - 48) > 9u )
                break;
              v13 = *v7;
            }
            if ( v14 < 0 )
              v14 = -1;
          }
          v63 = v14;
          v8 = *v7;
          v10 = *v7;
          if ( v10 != 108 )
          {
LABEL_13:
            if ( v10 == 104 )
            {
              v61 |= 0x400u;
              v8 = *++v7;
            }
            goto LABEL_15;
          }
LABEL_27:
          if ( *++v7 == 108 )
          {
            v61 |= 0x200u;
            v8 = *++v7;
LABEL_15:
            v11 = (unsigned __int8)(v8 - 88);
            goto LABEL_16;
          }
          v61 |= 0x100u;
          v8 = *v7;
          v11 = (unsigned __int8)(*v7 - 88);
          if ( v11 > 0x20 )
          {
LABEL_29:
            v69 = v8;
LABEL_30:
            v15 = 1;
            v16 = 1;
            v17 = __ROL4__(__ROR4__(v61 | 0x800, 3) & 0x7FFFFFFF, 3);
            v63 = 1;
            v64 = 32;
            v70 = (const char *)&v69;
            v61 = v17;
            i = 1;
            goto LABEL_31;
          }
LABEL_16:
          switch ( v11 )
          {
            case 0u:
              if ( (v61 & 0x200) != 0 || (v61 & 0x100) != 0 )
              {
                v45 = v57++;
                v21 = *v45;
              }
              else
              {
                v20 = (__int64)v57++;
                if ( (v61 & 0x400) != 0 )
                  v21 = *(unsigned __int16 *)(v20 + 6);
                else
                  v21 = *(unsigned int *)(v20 + 4);
              }
              v41 = "0123456789ABCDEF";
              if ( (v61 & 0x10) != 0 )
              {
                v66 = 48;
                v67 = 88;
                v68 = 2;
              }
              goto LABEL_89;
            case 0xBu:
              v22 = (__int64)v57++;
              v69 = *(_DWORD *)(v22 + 4);
              goto LABEL_30;
            case 0xCu:
            case 0x11u:
              LOBYTE(v17) = v61;
              if ( (v61 & 0x200) != 0 || (v61 & 0x100) != 0 )
              {
                v34 = v57++;
                v35 = *v34;
              }
              else
              {
                v55 = (__int64)v57++;
                if ( (v61 & 0x400) != 0 )
                  v35 = (__int16)*(_DWORD *)(v55 + 4);
                else
                  v35 = *(int *)(v55 + 4);
              }
              if ( v35 < 0 )
              {
                v68 = 1;
                v66 = 45;
                v36 = 0x7FFFFFFFFFFFFFFFLL;
                if ( v35 != 0x8000000000000000LL )
                  v36 = -v35;
                goto LABEL_85;
              }
              if ( (v61 & 2) != 0 )
              {
                v66 = 43;
                v68 = 1;
              }
              else if ( (v61 & 8) != 0 )
              {
                v66 = 32;
                v68 = 1;
              }
              if ( v35 )
              {
                v36 = v35;
LABEL_85:
                v37 = (char *)&v69;
                do
                {
                  *v37-- = sub_80004C20(v36) + 48;
                  v36 /= 0xAuLL;
                }
                while ( v36 );
                v38 = (char *)(&v69 - (unsigned __int8 *)v37);
                LOBYTE(v17) = v61;
                v39 = v37 + 1;
                v15 = v63;
                goto LABEL_95;
              }
LABEL_98:
              if ( (v17 & 0x20) != 0 )
                goto LABEL_91;
LABEL_99:
              v15 = v63;
LABEL_92:
              LODWORD(v38) = 1;
              v39 = (char *)&v69;
              v69 = 48;
LABEL_95:
              v16 = (int)v38;
              v70 = v39;
              i = (int)v38;
              break;
            case 0x17u:
              LOBYTE(v17) = v61;
              if ( (v61 & 0x200) != 0 || (v61 & 0x100) != 0 )
              {
                v46 = v57++;
                v33 = *v46;
              }
              else
              {
                v32 = (__int64)v57++;
                if ( (v61 & 0x400) != 0 )
                  v33 = *(unsigned __int16 *)(v32 + 6);
                else
                  v33 = *(unsigned int *)(v32 + 4);
              }
              v47 = (char *)&v69;
              if ( v33 )
              {
                do
                {
                  v50 = v33 & 7;
                  v33 >>= 3;
                  *v47-- = v50 + 48;
                }
                while ( v33 );
                LOBYTE(v17) = v61;
                v48 = v47 + 1;
                v49 = (char *)(&v69 - (unsigned __int8 *)v47);
                if ( (v61 & 0x10) != 0 )
                {
                  *v47 = 48;
                  v49 = (char *)(&v69 - (unsigned __int8 *)(v47 - 1));
                  LOBYTE(v17) = v61;
                  v48 = v47;
                }
              }
              else if ( (v61 & 0x20) == 0 || (v48 = (char *)&v70, LODWORD(v49) = 0, (v61 & 0x10) != 0) )
              {
                LODWORD(v49) = 1;
                v48 = (char *)&v69;
                v69 = 48;
              }
              v16 = (int)v49;
              v15 = v63;
              v70 = v48;
              i = (int)v49;
              break;
            case 0x18u:
              v40 = v57;
              v41 = "0123456789abcdef";
              ++v57;
              v21 = *v40;
              goto LABEL_89;
            case 0x1Bu:
              v23 = v57++;
              v24 = (_BYTE *)*v23;
              if ( v24 )
              {
                LOBYTE(v17) = v61;
                v70 = v24;
                if ( (v61 & 0x20) != 0 )
                {
                  if ( (int)v63 > 0 && (v25 = (unsigned __int8)*v24, v26 = v24 + 1, v27 = v63, v28 = 0, v25) )
                  {
                    while ( 1 )
                    {
                      ++v28;
                      if ( !--v27 || !*v26 )
                        break;
                      ++v26;
                    }
                  }
                  else
                  {
                    v28 = 0;
                  }
                  v15 = 0;
                  v16 = v28;
                  i = v28;
                  v63 = 0;
                }
                else
                {
                  v16 = 0;
                  for ( i = 0; *v24; ++v24 )
                    i = ++v16;
                  v15 = v63;
                }
              }
              else
              {
                v70 = "(null)";
                v56 = (unsigned int)sub_80005CE0((__int64)"(null)");
                LOBYTE(v17) = v61;
                v15 = v63;
                v16 = v56;
                i = v56;
              }
              break;
            case 0x1Du:
              LOBYTE(v17) = v61;
              if ( (v61 & 0x200) != 0 || (v61 & 0x100) != 0 )
              {
                v44 = (unsigned __int64 *)v57++;
                v30 = *v44;
              }
              else
              {
                v29 = (__int64)v57++;
                if ( (v61 & 0x400) != 0 )
                  v30 = *(unsigned __int16 *)(v29 + 6);
                else
                  v30 = *(unsigned int *)(v29 + 4);
              }
              if ( !v30 )
                goto LABEL_98;
              v52 = (char *)&v69;
              do
              {
                v53 = sub_80004C20(v30);
                v54 = v30;
                v30 /= 0xAuLL;
                *v52-- = v53 + 48;
              }
              while ( v54 / 0xA );
              v38 = (char *)(&v69 - (unsigned __int8 *)v52);
              LOBYTE(v17) = v61;
              v39 = v52 + 1;
              v15 = v63;
              goto LABEL_95;
            case 0x20u:
              if ( (v61 & 0x200) != 0 || (v61 & 0x100) != 0 )
              {
                v51 = v57++;
                v21 = *v51;
              }
              else
              {
                v31 = (__int64)v57++;
                if ( (v61 & 0x400) != 0 )
                  v21 = *(unsigned __int16 *)(v31 + 6);
                else
                  v21 = *(unsigned int *)(v31 + 4);
              }
              v41 = "0123456789abcdef";
              if ( (v61 & 0x10) != 0 )
              {
                v66 = 48;
                v67 = 120;
                v68 = 2;
              }
LABEL_89:
              v42 = (char *)&v69;
              if ( v21 )
              {
                do
                {
                  v43 = v21 & 0xF;
                  v21 >>= 4;
                  *v42-- = v41[v43];
                }
                while ( v21 );
                v38 = (char *)(&v69 - (unsigned __int8 *)v42);
                LOBYTE(v17) = v61;
                v39 = v42 + 1;
                v15 = v63;
                goto LABEL_95;
              }
              LOBYTE(v17) = v61;
              v68 = 0;
              if ( (v61 & 0x20) == 0 )
                goto LABEL_99;
LABEL_91:
              v15 = v63;
              v39 = (char *)&v70;
              LODWORD(v38) = 0;
              if ( v63 )
                goto LABEL_92;
              goto LABEL_95;
            default:
              goto LABEL_29;
          }
LABEL_31:
          if ( v15 <= v16 )
          {
            v63 = 0;
            v62 = v62 - v16 - v68;
            if ( v62 >= 0 )
            {
LABEL_33:
              if ( (v17 & 1) != 0 )
                goto LABEL_47;
              goto LABEL_34;
            }
          }
          else
          {
            v63 = v15 - v16;
            v62 = v62 - v68 - v15;
            if ( v62 >= 0 )
              goto LABEL_33;
          }
          v62 = 0;
          if ( (v17 & 1) != 0 )
          {
LABEL_47:
            sub_80004D54((__int64)&v57);
            sub_80004CD4((__int64)&v57);
            sub_80004DA4((__int64)&v57);
            sub_80004C54((__int64)&v57);
            goto LABEL_37;
          }
LABEL_34:
          if ( (v17 & 4) != 0 )
          {
            sub_80004D54((__int64)&v57);
            sub_80004C54((__int64)&v57);
          }
          else
          {
            sub_80004C54((__int64)&v57);
            sub_80004D54((__int64)&v57);
          }
          sub_80004CD4((__int64)&v57);
          sub_80004DA4((__int64)&v57);
LABEL_37:
          a3 = v7 + 1;
          v72 += i + v62 + v68 + v63;
          break;
      }
      break;
    }
  }
  return v72;
}
// 800058E0: conditional instruction was optimized away because of 'r11.8>=8000000000000001u'

//----- (0000000080005988) ----------------------------------------------------
__int64 sub_80005988()
{
  __int64 v0; // r3

  v0 = sub_8000599C(1LL);
  return sub_8000599C(v0);
}
// 8000599C: using guessed type __int64 __fastcall sub_8000599C(_QWORD);

//----- (000000008000599C) ----------------------------------------------------
void __fastcall __noreturn sub_8000599C(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int v4; // r29
  void *v5; // r9
  void *v6; // r8
  void *v7; // r7
  void *v8; // r6
  void *v9; // r5
  void *v10; // r4

  v4 = a1;
  sub_80005F30(a1, a2, a3, a4);
  sub_80005D84((void *)v4, v10, v9, v8, v7, v6, v5);
}
// 800059B8: variable 'v10' is possibly undefined
// 800059B8: variable 'v9' is possibly undefined
// 800059B8: variable 'v8' is possibly undefined
// 800059B8: variable 'v7' is possibly undefined
// 800059B8: variable 'v6' is possibly undefined
// 800059B8: variable 'v5' is possibly undefined

//----- (00000000800059BC) ----------------------------------------------------
__int64 __fastcall sub_800059BC(char *a1, unsigned __int64 a2, __int64 a3, _QWORD *a4, void *a5)
{
  unsigned __int64 v7; // r24
  unsigned __int64 v9; // r29
  char *v10; // r4
  void *v11; // r8
  unsigned __int64 v12; // r30
  __int64 v13; // r26
  _BYTE *v14; // r3
  __int64 v15; // r0
  __int64 v16; // r31
  __int64 v18; // r3

  v7 = a2 * a3;
  if ( !(a2 * a3) )
    return 0LL;
  if ( !a2 )
    return a3;
  v9 = a2 * a3;
  do
  {
    while ( 1 )
    {
      if ( a4[3] < a4[5] )
      {
        v12 = v9;
        v13 = 0LL;
        if ( (*(_WORD *)a4 & 0x400) == 0 )
          goto LABEL_9;
LABEL_17:
        v18 = sub_80005B94((__int64)a1, 0xAu, v9);
        v13 = v18;
        if ( v18 )
          v12 = v18 - (_QWORD)a1 + 1;
        goto LABEL_9;
      }
      if ( (int)sub_80005D94((__int64)a4, a2, a3, a4, a5) < 0 )
        goto LABEL_11;
      v12 = v9;
      v13 = 0LL;
      if ( (*(_WORD *)a4 & 0x400) != 0 )
        goto LABEL_17;
LABEL_9:
      v14 = (_BYTE *)a4[3];
      v15 = a4[5];
      v16 = v15 - (_QWORD)v14;
      if ( v12 <= v15 - (__int64)v14 )
        break;
      v9 -= v16;
      sub_80001EE0(v14, a1, v15 - (_QWORD)v14);
      a1 += v16;
      a4[3] += v16;
      if ( !v9 )
        goto LABEL_11;
    }
    v10 = a1;
    a1 += v12;
    sub_80001EE0(v14, v10, v12);
    v9 -= v12;
    a4[3] += v12;
  }
  while ( (!v13 || !(unsigned int)sub_80006064((unsigned __int16 *)a4, a2, a3, a4, a5, v11)) && v9 );
LABEL_11:
  if ( (*(_WORD *)a4 & 0x800) != 0 )
    sub_80006064((unsigned __int16 *)a4, a2, a3, a4, a5, v11);
  return (v7 - v9) / a2;
}
// 80005A3C: variable 'a2' is possibly undefined
// 80005A3C: variable 'a3' is possibly undefined
// 80005A3C: variable 'a4' is possibly undefined
// 80005A3C: variable 'a5' is possibly undefined
// 80005A3C: variable 'v11' is possibly undefined

//----- (0000000080005B94) ----------------------------------------------------
__int64 __fastcall sub_80005B94(__int64 result, unsigned __int8 a2, unsigned __int64 a3)
{
  unsigned __int64 v3; // ctr
  __int64 v4; // r0
  __int64 v5; // ctr
  signed __int64 v6; // r12
  unsigned __int64 v7; // r8
  unsigned __int64 v8; // r8
  unsigned __int64 v9; // r0
  __int64 v10; // r0
  __int64 v12; // ctr
  unsigned __int64 v13; // r0
  unsigned __int64 v14; // ctr

  if ( !(_DWORD)a3 )
    return 0LL;
  if ( (unsigned int)a3 < 8 )
  {
    v3 = a3;
    while ( a2 != (unsigned __int64)*(unsigned __int8 *)result )
    {
      ++result;
      if ( !--v3 )
        return 0LL;
    }
    return result;
  }
  __asm { dcbt      0, r3 }
  v4 = -result & 7;
  if ( !(_DWORD)v4 )
  {
LABEL_12:
    v6 = (result + a3) & 0xFFFFFFFFFFFFFFF8LL;
    v7 = (((unsigned __int16)(a2 << 8) | (unsigned int)a2) << 16) | (unsigned __int64)(unsigned __int16)((a2 << 8) | a2);
    v8 = (v7 << 32) | (unsigned int)v7;
    v9 = -result & 0x7F;
    if ( (_DWORD)v9 )
    {
      if ( (unsigned int)v9 < (unsigned int)a3 )
      {
        a3 -= v9;
        v10 = v9 >> 3;
      }
      else
      {
        v10 = a3 >> 3;
        a3 &= 7u;
      }
    }
    else
    {
LABEL_16:
      _R0 = result + 128;
      __asm { dcbt      0, r0 }
      v10 = a3 >> 3;
      if ( (unsigned int)(a3 >> 3) >= 0x10 )
        v10 = 16LL;
      a3 -= 8 * v10;
    }
    v12 = v10;
    do
    {
      v13 = _cntlzd(~(*(_QWORD *)result ^ v8 | 0x7F7F7F7F7F7F7F7FLL | (((*(_QWORD *)result ^ v8) & 0x7F7F7F7F7F7F7F7FLL)
                                                                     + 0x7F7F7F7F7F7F7F7FLL))) >> 3;
      if ( (unsigned int)v13 < 8 )
      {
        result += v13;
        return result;
      }
      result += 8LL;
      --v12;
    }
    while ( v12 );
    if ( result < v6 )
      goto LABEL_16;
    if ( (_DWORD)a3 )
    {
LABEL_24:
      v14 = a3;
      while ( a2 != (unsigned __int64)*(unsigned __int8 *)result )
      {
        ++result;
        if ( !--v14 )
          return 0LL;
      }
      return result;
    }
    return 0LL;
  }
  v5 = -result & 7;
  a3 -= v4;
  while ( *(unsigned __int8 *)result != (unsigned __int64)a2 )
  {
    ++result;
    if ( !--v5 )
    {
      if ( (unsigned int)a3 < 8 )
        goto LABEL_24;
      goto LABEL_12;
    }
  }
  return result;
}

//----- (0000000080005CE0) ----------------------------------------------------
char *__fastcall sub_80005CE0(__int64 a1)
{
  __int64 v2; // ctr
  __int64 v3; // r0
  __int64 v6; // ctr
  unsigned __int64 v7; // r0
  char *result; // r3

  _R4 = (_QWORD *)a1;
  if ( (-(int)a1 & 7) != 0 )
  {
    v2 = -a1 & 7;
    while ( 1 )
    {
      v3 = *(unsigned __int8 *)_R4;
      _R4 = (_QWORD *)((char *)_R4 + 1);
      if ( !v3 )
        break;
      if ( !--v2 )
        goto LABEL_5;
    }
    result = (char *)_R4 - a1 - 1;
  }
  else
  {
LABEL_5:
    _R6 = 128;
    __asm
    {
      dcbt      0, r4
      dcbt      r6, r4
    }
LABEL_6:
    _R0 = (_DWORD)_R4 + 256;
    __asm { dcbt      0, r0 }
    v6 = 16LL;
    while ( 1 )
    {
      v7 = _cntlzd(~(*_R4 | 0x7F7F7F7F7F7F7F7FLL | ((*_R4 & 0x7F7F7F7F7F7F7F7FLL) + 0x7F7F7F7F7F7F7F7FLL))) >> 3;
      ++_R4;
      if ( (unsigned int)v7 < 8 )
        break;
      if ( !--v6 )
        goto LABEL_6;
    }
    result = (char *)_R4 + v7 - a1 - 8;
  }
  return result;
}

//----- (0000000080005D84) ----------------------------------------------------
void __fastcall sub_80005D84(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  exit(a1, a2, a3, a4, a5, a6, a7);
}

//----- (0000000080005D94) ----------------------------------------------------
__int64 __fastcall sub_80005D94(__int64 a1, __int64 a2, __int64 a3, void *a4, void *a5)
{
  unsigned __int64 v5; // r11
  int v7; // r8
  __int16 v8; // r10
  __int64 v9; // r3
  __int64 v10; // r11
  __int16 v11; // r9
  int v13; // r3

  v5 = *(_QWORD *)(a1 + 24);
  v7 = 0;
  if ( *(_QWORD *)(a1 + 40) <= v5 )
  {
    v8 = *(_WORD *)a1;
    if ( (*(_WORD *)a1 & 0x9002) != 2 )
    {
      v7 = -1;
      *(_WORD *)a1 = (((v8 >> 15) & 0xC000) + 16896) | v8;
      return v7;
    }
    if ( (*(_WORD *)a1 & 0x6000) == 24576 && *(_QWORD *)(a1 + 16) <= v5 )
    {
      v13 = sub_80006064((unsigned __int16 *)a1, a2, a3, a4, a5, (void *)0x9002);
      v7 = -1;
      if ( v13 )
        return v7;
      v8 = *(_WORD *)a1;
    }
    if ( (v8 & 0x800) != 0 )
    {
      v9 = *(_QWORD *)(a1 + 8);
    }
    else
    {
      v9 = *(_QWORD *)(a1 + 8);
      if ( a1 + 123 == v9 )
      {
        v9 = malloc(0x1000uLL);
        *(_QWORD *)(a1 + 8) = v9;
        v8 = *(_WORD *)a1;
        if ( v9 )
        {
          *(_QWORD *)(a1 + 80) = v9;
          *(_QWORD *)(a1 + 16) = v9 + 4096;
          v8 |= 0x40u;
          *(_WORD *)a1 = v8;
          *(_QWORD *)(a1 + 88) = v9;
          *(_QWORD *)(a1 + 128) = v9;
        }
        else
        {
          v9 = a1 + 123;
          *(_QWORD *)(a1 + 8) = a1 + 123;
          *(_QWORD *)(a1 + 16) = a1 + 124;
        }
      }
    }
    v10 = *(_QWORD *)(a1 + 16);
    v11 = *(_WORD *)(a1 + 160) & 0xFFFE;
    v7 = 0;
    *(_QWORD *)(a1 + 136) = 0LL;
    *(_QWORD *)(a1 + 40) = v10;
    *(_WORD *)a1 = v8 | 0x6000;
    *(_QWORD *)(a1 + 152) = v9;
    *(_WORD *)(a1 + 160) = v11;
    *(_QWORD *)(a1 + 24) = v9;
    *(_QWORD *)(a1 + 32) = v9;
  }
  return v7;
}

//----- (0000000080005F10) ----------------------------------------------------
__int64 __fastcall brk(void *a1, void *a2, void *a3, void *a4, void *a5, void *a6, void *a7)
{
  int v7; // lr
  __int64 result; // r3

  linux_syscall(v7, a1, a2, a3, a4, a5, a6, a7);
  return (int)result;
}
// 80005F1C: variable 'v7' is possibly undefined
// 80005F24: variable 'result' is possibly undefined

//----- (0000000080005F30) ----------------------------------------------------
void __fastcall sub_80005F30(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r9
  __int64 v5; // r11
  __int64 v6; // r7
  void (__fastcall **v7)(_QWORD, __int64, __int64, __int64, __int64); // r9
  _QWORD *v8; // r9
  char *v9; // r11
  void (__fastcall **v10)(_QWORD, __int64, __int64, __int64, char *); // r9

  if ( qword_C00011B8 )
  {
    while ( 1 )
    {
      v4 = qword_C00011C0;
      v5 = qword_C00011C0 - 8;
      v6 = qword_C00011C0 - 16;
      if ( qword_C00011C0 <= (unsigned __int64)qword_C00011B8 )
        break;
      while ( 1 )
      {
        v7 = *(void (__fastcall ***)(_QWORD, __int64, __int64, __int64, __int64))(v4 - 8);
        qword_C00011C0 = v5;
        if ( ((unsigned __int8)v7 & 1) != 0 )
          break;
        (*v7)(0LL, a2, a3, a4, v6);
        v4 = qword_C00011C0;
        v5 = qword_C00011C0 - 8;
        v6 = qword_C00011C0 - 16;
        if ( qword_C00011C0 <= (unsigned __int64)qword_C00011B8 )
          goto LABEL_5;
      }
      qword_C00011C0 = v6;
      (*(void (__fastcall **)(_QWORD))((unsigned int)v7 & 0xFFFFFFFE))(*(_QWORD *)(v5 - 8));
    }
  }
LABEL_5:
  while ( 1 )
  {
    v8 = off_C0000210;
    v9 = (char *)off_C0000210 - 8;
    if ( off_C0000210 <= &unk_C00011C8 )
      break;
    while ( 1 )
    {
      v10 = (void (__fastcall **)(_QWORD, __int64, __int64, __int64, char *))*(v8 - 1);
      off_C0000210 = v9;
      if ( ((unsigned __int8)v10 & 1) != 0 )
        break;
      (*v10)(0LL, a2, a3, a4, v9 - 8);
      v8 = off_C0000210;
      v9 = (char *)off_C0000210 - 8;
      if ( off_C0000210 <= &unk_C00011C8 )
        return;
    }
    off_C0000210 = v9 - 8;
    (*(void (__fastcall **)(_QWORD))((unsigned int)v10 & 0xFFFFFFFE))(*((_QWORD *)v9 - 1));
  }
}
// 80005F90: variable 'a2' is possibly undefined
// 80005F90: variable 'a3' is possibly undefined
// 80005F90: variable 'a4' is possibly undefined
// C0000210: using guessed type void *off_C0000210;
// C00011B8: using guessed type __int64 qword_C00011B8;
// C00011C0: using guessed type __int64 qword_C00011C0;

//----- (0000000080006064) ----------------------------------------------------
__int64 __fastcall sub_80006064(unsigned __int16 *a1, __int64 a2, __int64 a3, void *a4, void *a5, void *a6)
{
  int v7; // r11
  int v8; // r29
  unsigned __int64 v9; // r9
  unsigned __int64 v10; // r5
  char *v11; // r31
  int v12; // r3
  __int64 v13; // r9
  unsigned __int16 v14; // r0
  __int64 result; // r3
  __int64 i; // r31

  if ( !a1 )
  {
    v8 = (int)sub_80006064(&qword_C0000018) >> 31;
    if ( (int)sub_80006064(&qword_C00000C0) < 0 )
      v8 = -1;
    if ( (int)sub_80006064(&qword_C0000168) < 0 )
      v8 = -1;
    for ( i = qword_C00011B0; i; i = *(_QWORD *)(i + 112) )
    {
      if ( (int)sub_80006064(i) < 0 )
        v8 = -1;
    }
    return v8;
  }
  v7 = *a1;
  v8 = 0;
  if ( (v7 & 0x2000) == 0 )
    return v8;
  v9 = *((_QWORD *)a1 + 1);
  v10 = *((_QWORD *)a1 + 3);
  v11 = (char *)v9;
  if ( v9 < v10 )
  {
    do
    {
      v12 = socket((void *)(__int16)a1[2], v11, (void *)((int)v10 - (int)v11), a4, a5, a6, (void *)v9);
      v9 = v12;
      v11 += v12;
      if ( v12 <= 0 )
      {
        v8 = -1;
        v13 = *((_QWORD *)a1 + 1);
        v14 = *a1 | 0x200;
        *((_QWORD *)a1 + 11) = v13;
        *a1 = v14;
        *((_QWORD *)a1 + 3) = v13;
        *((_QWORD *)a1 + 5) = v13;
        return v8;
      }
      v10 = *((_QWORD *)a1 + 3);
      *((_QWORD *)a1 + 16) += v12;
    }
    while ( v10 > (unsigned __int64)v11 );
    v7 = *a1;
    v9 = *((_QWORD *)a1 + 1);
  }
  result = 0LL;
  *a1 = __ROL4__(__ROR4__(v7, 14) & 0x7FFFFFFF, 14);
  *((_QWORD *)a1 + 11) = v9;
  *((_QWORD *)a1 + 3) = v9;
  *((_QWORD *)a1 + 5) = v9;
  return result;
}
// 800060E0: variable 'a4' is possibly undefined
// 800060E0: variable 'a5' is possibly undefined
// 800060E0: variable 'a6' is possibly undefined
// C0000018: using guessed type __int64 qword_C0000018;
// C00000C0: using guessed type __int64 qword_C00000C0;
// C0000168: using guessed type __int64 qword_C0000168;
// C00011B0: using guessed type __int64 qword_C00011B0;

// nfuncs=88 queued=87 decompiled=87 lumina nreq=0 worse=0 better=0
// ALL OK, 87 function(s) have been successfully decompiled
